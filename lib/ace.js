import { getInnerText } from "./lib/dom";
import { addListener, removeListener } from "./lib/event";
import { wrap } from './triton';
import Editor from "./Editor";
import { VirtualRenderer } from "./virtual_renderer";
import { workspace } from "./workspace/workspace";
export function edit(source, workspace) {
    var element;
    if (typeof source === 'string') {
        var id = source;
        element = document.getElementById(id);
        if (!element) {
            throw new Error("edit can't find div #" + id);
        }
    }
    else {
        element = source;
    }
    if (element && element['env'] && element['env'].editor instanceof Editor) {
        return element['env'].editor;
    }
    var value = "";
    if (element && /input|textarea/i.test(element.tagName)) {
        var oldNode = element;
        value = oldNode.value;
        element = document.createElement("pre");
        oldNode.parentNode.replaceChild(element, oldNode);
    }
    else {
        value = getInnerText(element);
        element.innerHTML = '';
    }
    var editSession = createEditSession(value);
    var editor = new Editor(new VirtualRenderer(element));
    editor.setSession(editSession);
    var env = {
        document: editSession,
        editor: editor,
        onResize: editor.resize.bind(editor, null)
    };
    if (oldNode)
        env['textarea'] = oldNode;
    addListener(window, "resize", env.onResize);
    editor.on("destroy", function () {
        removeListener(window, "resize", env.onResize);
        env.editor.container['env'] = null;
    });
    editor.container['env'] = editor['env'] = env;
    return wrap(editor, element, workspace, document);
}
;
export function workspace() {
    return workspace();
}
;
export function createEditSession(text, mode) {
    var doc = new EditSession(text, mode);
    doc.setUndoManager(new UndoManager());
    return doc;
}
;
export var EditSession = EditSession;
export var UndoManager = UndoManager;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYWNlLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vc3JjL2FjZS50cyJdLCJuYW1lcyI6WyJlZGl0Iiwid29ya3NwYWNlIiwiY3JlYXRlRWRpdFNlc3Npb24iXSwibWFwcGluZ3MiOiJPQXNDTyxFQUFDLFlBQVksRUFBQyxNQUFNLFdBQVc7T0FDL0IsRUFBQyxXQUFXLEVBQUUsY0FBYyxFQUFDLE1BQU0sYUFBYTtPQUVoRCxFQUFDLElBQUksRUFBQyxNQUFNLFVBQVU7T0FDdEIsTUFBTSxNQUFNLFVBQVU7T0FHdEIsRUFBQyxlQUFlLEVBQUMsTUFBTSxvQkFBb0I7T0FDM0MsRUFBQyxTQUFTLEVBQVksTUFBTSx1QkFBdUI7QUEwQjFELHFCQUFxQixNQUFXLEVBQUUsU0FBb0I7SUFDbERBLElBQUlBLE9BQW9CQSxDQUFDQTtJQUN6QkEsRUFBRUEsQ0FBQ0EsQ0FBQ0EsT0FBT0EsTUFBTUEsS0FBS0EsUUFBUUEsQ0FBQ0EsQ0FBQ0EsQ0FBQ0E7UUFDN0JBLElBQUlBLEVBQUVBLEdBQVdBLE1BQU1BLENBQUNBO1FBQ3hCQSxPQUFPQSxHQUFHQSxRQUFRQSxDQUFDQSxjQUFjQSxDQUFDQSxFQUFFQSxDQUFDQSxDQUFDQTtRQUN0Q0EsRUFBRUEsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsT0FBT0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0E7WUFDWEEsTUFBTUEsSUFBSUEsS0FBS0EsQ0FBQ0EsdUJBQXVCQSxHQUFHQSxFQUFFQSxDQUFDQSxDQUFDQTtRQUNsREEsQ0FBQ0E7SUFDTEEsQ0FBQ0E7SUFDREEsSUFBSUEsQ0FBQ0EsQ0FBQ0E7UUFDRkEsT0FBT0EsR0FBR0EsTUFBTUEsQ0FBQ0E7SUFDckJBLENBQUNBO0lBRURBLEVBQUVBLENBQUNBLENBQUNBLE9BQU9BLElBQUlBLE9BQU9BLENBQUNBLEtBQUtBLENBQUNBLElBQUlBLE9BQU9BLENBQUNBLEtBQUtBLENBQUNBLENBQUNBLE1BQU1BLFlBQVlBLE1BQU1BLENBQUNBLENBQUNBLENBQUNBO1FBQ3ZFQSxNQUFNQSxDQUFDQSxPQUFPQSxDQUFDQSxLQUFLQSxDQUFDQSxDQUFDQSxNQUFNQSxDQUFDQTtJQUNqQ0EsQ0FBQ0E7SUFFREEsSUFBSUEsS0FBS0EsR0FBR0EsRUFBRUEsQ0FBQ0E7SUFDZkEsRUFBRUEsQ0FBQ0EsQ0FBQ0EsT0FBT0EsSUFBSUEsaUJBQWlCQSxDQUFDQSxJQUFJQSxDQUFDQSxPQUFPQSxDQUFDQSxPQUFPQSxDQUFDQSxDQUFDQSxDQUFDQSxDQUFDQTtRQUNyREEsSUFBSUEsT0FBT0EsR0FBUUEsT0FBT0EsQ0FBQ0E7UUFDM0JBLEtBQUtBLEdBQUdBLE9BQU9BLENBQUNBLEtBQUtBLENBQUNBO1FBQ3RCQSxPQUFPQSxHQUFHQSxRQUFRQSxDQUFDQSxhQUFhQSxDQUFDQSxLQUFLQSxDQUFDQSxDQUFDQTtRQUN4Q0EsT0FBT0EsQ0FBQ0EsVUFBVUEsQ0FBQ0EsWUFBWUEsQ0FBQ0EsT0FBT0EsRUFBRUEsT0FBT0EsQ0FBQ0EsQ0FBQ0E7SUFDdERBLENBQUNBO0lBQ0RBLElBQUlBLENBQUNBLENBQUNBO1FBQ0ZBLEtBQUtBLEdBQUdBLFlBQVlBLENBQUNBLE9BQU9BLENBQUNBLENBQUNBO1FBQzlCQSxPQUFPQSxDQUFDQSxTQUFTQSxHQUFHQSxFQUFFQSxDQUFDQTtJQUMzQkEsQ0FBQ0E7SUFFREEsSUFBSUEsV0FBV0EsR0FBR0EsaUJBQWlCQSxDQUFDQSxLQUFLQSxDQUFDQSxDQUFDQTtJQUUzQ0EsSUFBSUEsTUFBTUEsR0FBR0EsSUFBSUEsTUFBTUEsQ0FBQ0EsSUFBSUEsZUFBZUEsQ0FBQ0EsT0FBT0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0E7SUFDdERBLE1BQU1BLENBQUNBLFVBQVVBLENBQUNBLFdBQVdBLENBQUNBLENBQUNBO0lBRy9CQSxJQUFJQSxHQUFHQSxHQUFHQTtRQUNOQSxRQUFRQSxFQUFFQSxXQUFXQTtRQUNyQkEsTUFBTUEsRUFBRUEsTUFBTUE7UUFDZEEsUUFBUUEsRUFBRUEsTUFBTUEsQ0FBQ0EsTUFBTUEsQ0FBQ0EsSUFBSUEsQ0FBQ0EsTUFBTUEsRUFBRUEsSUFBSUEsQ0FBQ0E7S0FDN0NBLENBQUNBO0lBRUZBLEVBQUVBLENBQUNBLENBQUNBLE9BQU9BLENBQUNBO1FBQUNBLEdBQUdBLENBQUNBLFVBQVVBLENBQUNBLEdBQUdBLE9BQU9BLENBQUNBO0lBQ3ZDQSxXQUFXQSxDQUFDQSxNQUFNQSxFQUFFQSxRQUFRQSxFQUFFQSxHQUFHQSxDQUFDQSxRQUFRQSxDQUFDQSxDQUFDQTtJQUM1Q0EsTUFBTUEsQ0FBQ0EsRUFBRUEsQ0FBQ0EsU0FBU0EsRUFBRUE7UUFDakIsY0FBYyxDQUFDLE1BQU0sRUFBRSxRQUFRLEVBQUUsR0FBRyxDQUFDLFFBQVEsQ0FBQyxDQUFDO1FBQy9DLEdBQUcsQ0FBQyxNQUFNLENBQUMsU0FBUyxDQUFDLEtBQUssQ0FBQyxHQUFHLElBQUksQ0FBQztJQUN2QyxDQUFDLENBQUNBLENBQUNBO0lBQ0hBLE1BQU1BLENBQUNBLFNBQVNBLENBQUNBLEtBQUtBLENBQUNBLEdBQUdBLE1BQU1BLENBQUNBLEtBQUtBLENBQUNBLEdBQUdBLEdBQUdBLENBQUNBO0lBQzlDQSxNQUFNQSxDQUFDQSxJQUFJQSxDQUFDQSxNQUFNQSxFQUFFQSxPQUFPQSxFQUFFQSxTQUFTQSxFQUFFQSxRQUFRQSxDQUFDQSxDQUFDQTtBQUN0REEsQ0FBQ0E7QUFBQSxDQUFDO0FBS0Y7SUFDSUMsTUFBTUEsQ0FBQ0EsU0FBU0EsRUFBRUEsQ0FBQ0E7QUFDdkJBLENBQUNBO0FBQUEsQ0FBQztBQVFGLGtDQUFrQyxJQUFJLEVBQUUsSUFBSztJQUN6Q0MsSUFBSUEsR0FBR0EsR0FBR0EsSUFBSUEsV0FBV0EsQ0FBQ0EsSUFBSUEsRUFBRUEsSUFBSUEsQ0FBQ0EsQ0FBQ0E7SUFDdENBLEdBQUdBLENBQUNBLGNBQWNBLENBQUNBLElBQUlBLFdBQVdBLEVBQUVBLENBQUNBLENBQUNBO0lBQ3RDQSxNQUFNQSxDQUFDQSxHQUFHQSxDQUFDQTtBQUNmQSxDQUFDQTtBQUFBLENBQUM7QUFFRixXQUFXLFdBQVcsR0FBRyxXQUFXLENBQUM7QUFFckMsV0FBVyxXQUFXLEdBQUcsV0FBVyxDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiLyogKioqKiogQkVHSU4gTElDRU5TRSBCTE9DSyAqKioqKlxuICogRGlzdHJpYnV0ZWQgdW5kZXIgdGhlIEJTRCBsaWNlbnNlOlxuICpcbiAqIENvcHlyaWdodCAoYykgMjAxMCwgQWpheC5vcmcgQi5WLlxuICogQWxsIHJpZ2h0cyByZXNlcnZlZC5cbiAqIFxuICogUmVkaXN0cmlidXRpb24gYW5kIHVzZSBpbiBzb3VyY2UgYW5kIGJpbmFyeSBmb3Jtcywgd2l0aCBvciB3aXRob3V0XG4gKiBtb2RpZmljYXRpb24sIGFyZSBwZXJtaXR0ZWQgcHJvdmlkZWQgdGhhdCB0aGUgZm9sbG93aW5nIGNvbmRpdGlvbnMgYXJlIG1ldDpcbiAqICAgICAqIFJlZGlzdHJpYnV0aW9ucyBvZiBzb3VyY2UgY29kZSBtdXN0IHJldGFpbiB0aGUgYWJvdmUgY29weXJpZ2h0XG4gKiAgICAgICBub3RpY2UsIHRoaXMgbGlzdCBvZiBjb25kaXRpb25zIGFuZCB0aGUgZm9sbG93aW5nIGRpc2NsYWltZXIuXG4gKiAgICAgKiBSZWRpc3RyaWJ1dGlvbnMgaW4gYmluYXJ5IGZvcm0gbXVzdCByZXByb2R1Y2UgdGhlIGFib3ZlIGNvcHlyaWdodFxuICogICAgICAgbm90aWNlLCB0aGlzIGxpc3Qgb2YgY29uZGl0aW9ucyBhbmQgdGhlIGZvbGxvd2luZyBkaXNjbGFpbWVyIGluIHRoZVxuICogICAgICAgZG9jdW1lbnRhdGlvbiBhbmQvb3Igb3RoZXIgbWF0ZXJpYWxzIHByb3ZpZGVkIHdpdGggdGhlIGRpc3RyaWJ1dGlvbi5cbiAqICAgICAqIE5laXRoZXIgdGhlIG5hbWUgb2YgQWpheC5vcmcgQi5WLiBub3IgdGhlXG4gKiAgICAgICBuYW1lcyBvZiBpdHMgY29udHJpYnV0b3JzIG1heSBiZSB1c2VkIHRvIGVuZG9yc2Ugb3IgcHJvbW90ZSBwcm9kdWN0c1xuICogICAgICAgZGVyaXZlZCBmcm9tIHRoaXMgc29mdHdhcmUgd2l0aG91dCBzcGVjaWZpYyBwcmlvciB3cml0dGVuIHBlcm1pc3Npb24uXG4gKiBcbiAqIFRISVMgU09GVFdBUkUgSVMgUFJPVklERUQgQlkgVEhFIENPUFlSSUdIVCBIT0xERVJTIEFORCBDT05UUklCVVRPUlMgXCJBUyBJU1wiIEFORFxuICogQU5ZIEVYUFJFU1MgT1IgSU1QTElFRCBXQVJSQU5USUVTLCBJTkNMVURJTkcsIEJVVCBOT1QgTElNSVRFRCBUTywgVEhFIElNUExJRURcbiAqIFdBUlJBTlRJRVMgT0YgTUVSQ0hBTlRBQklMSVRZIEFORCBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRSBBUkVcbiAqIERJU0NMQUlNRUQuIElOIE5PIEVWRU5UIFNIQUxMIEFKQVguT1JHIEIuVi4gQkUgTElBQkxFIEZPUiBBTllcbiAqIERJUkVDVCwgSU5ESVJFQ1QsIElOQ0lERU5UQUwsIFNQRUNJQUwsIEVYRU1QTEFSWSwgT1IgQ09OU0VRVUVOVElBTCBEQU1BR0VTXG4gKiAoSU5DTFVESU5HLCBCVVQgTk9UIExJTUlURUQgVE8sIFBST0NVUkVNRU5UIE9GIFNVQlNUSVRVVEUgR09PRFMgT1IgU0VSVklDRVM7XG4gKiBMT1NTIE9GIFVTRSwgREFUQSwgT1IgUFJPRklUUzsgT1IgQlVTSU5FU1MgSU5URVJSVVBUSU9OKSBIT1dFVkVSIENBVVNFRCBBTkRcbiAqIE9OIEFOWSBUSEVPUlkgT0YgTElBQklMSVRZLCBXSEVUSEVSIElOIENPTlRSQUNULCBTVFJJQ1QgTElBQklMSVRZLCBPUiBUT1JUXG4gKiAoSU5DTFVESU5HIE5FR0xJR0VOQ0UgT1IgT1RIRVJXSVNFKSBBUklTSU5HIElOIEFOWSBXQVkgT1VUIE9GIFRIRSBVU0UgT0YgVEhJU1xuICogU09GVFdBUkUsIEVWRU4gSUYgQURWSVNFRCBPRiBUSEUgUE9TU0lCSUxJVFkgT0YgU1VDSCBEQU1BR0UuXG4gKlxuICogKioqKiogRU5EIExJQ0VOU0UgQkxPQ0sgKioqKiogKi9cblxuLyoqXG4gKiBUaGUgbWFpbiBjbGFzcyByZXF1aXJlZCB0byBzZXQgdXAgYW4gQWNlIGluc3RhbmNlIGluIHRoZSBicm93c2VyLlxuICpcbiAqIEBjbGFzcyBBY2VcbiAqKi9cblxuLy9yZXF1aXJlKFwiLi9saWIvZml4b2xkYnJvd3NlcnNcIik7XG5cbmltcG9ydCB7Z2V0SW5uZXJUZXh0fSBmcm9tIFwiLi9saWIvZG9tXCI7XG5pbXBvcnQge2FkZExpc3RlbmVyLCByZW1vdmVMaXN0ZW5lcn0gZnJvbSBcIi4vbGliL2V2ZW50XCI7XG5cbmltcG9ydCB7d3JhcH0gZnJvbSAnLi90cml0b24nO1xuaW1wb3J0IEVkaXRvciBmcm9tIFwiLi9FZGl0b3JcIjtcbmltcG9ydCB7fSBmcm9tIFwiLi9lZGl0X3Nlc3Npb25cIjtcbmltcG9ydCB7fSBmcm9tIFwiLi91bmRvbWFuYWdlclwiO1xuaW1wb3J0IHtWaXJ0dWFsUmVuZGVyZXJ9IGZyb20gXCIuL3ZpcnR1YWxfcmVuZGVyZXJcIjtcbmltcG9ydCB7d29ya3NwYWNlLCBXb3Jrc3BhY2V9IGZyb20gXCIuL3dvcmtzcGFjZS93b3Jrc3BhY2VcIjtcbmltcG9ydCB7fSBmcm9tICcuL2NvbmZpZyc7XG5cbi8vIFRoZSBmb2xsb3dpbmcgcmVxdWlyZSgpcyBhcmUgZm9yIGluY2x1c2lvbiBpbiB0aGUgYnVpbHQgYWNlIGZpbGVcbi8vcmVxdWlyZShcIi4vd29ya2VyL3dvcmtlcl9jbGllbnRcIik7XG4vL3JlcXVpcmUoXCIuL2tleWJvYXJkL2hhc2hfaGFuZGxlclwiKTtcbi8vcmVxdWlyZShcIi4vcGxhY2Vob2xkZXJcIik7XG4vL3JlcXVpcmUoXCIuL211bHRpX3NlbGVjdFwiKTtcbi8vcmVxdWlyZShcIi4vbW9kZS9mb2xkaW5nL2ZvbGRfbW9kZVwiKTtcbi8vcmVxdWlyZShcIi4vdGhlbWUvdGV4dG1hdGVcIik7XG4vL3JlcXVpcmUoXCIuL2V4dC9lcnJvcl9tYXJrZXJcIik7XG5cbi8vIGV4cG9ydCB2YXIgY29uZmlnID0gY2ZnO1xuXG4vKipcbiAqIFByb3ZpZGVzIGFjY2VzcyB0byByZXF1aXJlIGluIHBhY2tlZCBub2NvbmZsaWN0IG1vZGVcbiAqIEBwYXJhbSB7U3RyaW5nfSBtb2R1bGVOYW1lXG4gKiBAcmV0dXJucyB7T2JqZWN0fVxuICoqL1xuLy8gRklYTUU6IFRyeWluZyB0byBleHBvcnQgdGhpcyBpbiB0aGUgQUNFIG5hbWVzcGFjZSBpcyBwcm9ibGVtYXRpYyBpbiBUeXBlU2NyaXB0LlxuLy8gZXhwb3J0IHZhciByZXF1aXJlID0gcmVxdWlyZTtcblxuLyoqXG4gKiBFbWJlZHMgdGhlIEFjZSBlZGl0b3IgaW50byB0aGUgRE9NLCBhdCB0aGUgZWxlbWVudCBwcm92aWRlZCBieSBgZWxgLlxuICogQHBhcmFtIHtTdHJpbmcgfCBET01FbGVtZW50fSBlbCBFaXRoZXIgdGhlIGlkIG9mIGFuIGVsZW1lbnQsIG9yIHRoZSBlbGVtZW50IGl0c2VsZlxuICovXG5leHBvcnQgZnVuY3Rpb24gZWRpdChzb3VyY2U6IGFueSwgd29ya3NwYWNlOiBXb3Jrc3BhY2UpIHtcbiAgICB2YXIgZWxlbWVudDogSFRNTEVsZW1lbnQ7XG4gICAgaWYgKHR5cGVvZiBzb3VyY2UgPT09ICdzdHJpbmcnKSB7XG4gICAgICAgIHZhciBpZDogc3RyaW5nID0gc291cmNlO1xuICAgICAgICBlbGVtZW50ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoaWQpO1xuICAgICAgICBpZiAoIWVsZW1lbnQpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcImVkaXQgY2FuJ3QgZmluZCBkaXYgI1wiICsgaWQpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICBlbGVtZW50ID0gc291cmNlO1xuICAgIH1cblxuICAgIGlmIChlbGVtZW50ICYmIGVsZW1lbnRbJ2VudiddICYmIGVsZW1lbnRbJ2VudiddLmVkaXRvciBpbnN0YW5jZW9mIEVkaXRvcikge1xuICAgICAgICByZXR1cm4gZWxlbWVudFsnZW52J10uZWRpdG9yO1xuICAgIH1cblxuICAgIHZhciB2YWx1ZSA9IFwiXCI7XG4gICAgaWYgKGVsZW1lbnQgJiYgL2lucHV0fHRleHRhcmVhL2kudGVzdChlbGVtZW50LnRhZ05hbWUpKSB7XG4gICAgICAgIHZhciBvbGROb2RlOiBhbnkgPSBlbGVtZW50O1xuICAgICAgICB2YWx1ZSA9IG9sZE5vZGUudmFsdWU7XG4gICAgICAgIGVsZW1lbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwicHJlXCIpO1xuICAgICAgICBvbGROb2RlLnBhcmVudE5vZGUucmVwbGFjZUNoaWxkKGVsZW1lbnQsIG9sZE5vZGUpO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgdmFsdWUgPSBnZXRJbm5lclRleHQoZWxlbWVudCk7XG4gICAgICAgIGVsZW1lbnQuaW5uZXJIVE1MID0gJyc7XG4gICAgfVxuXG4gICAgdmFyIGVkaXRTZXNzaW9uID0gY3JlYXRlRWRpdFNlc3Npb24odmFsdWUpO1xuXG4gICAgdmFyIGVkaXRvciA9IG5ldyBFZGl0b3IobmV3IFZpcnR1YWxSZW5kZXJlcihlbGVtZW50KSk7XG4gICAgZWRpdG9yLnNldFNlc3Npb24oZWRpdFNlc3Npb24pO1xuXG4gICAgLy8gRklYTUU6IFRoZSBmaXJzdCBwcm9wZXJ0eSBpcyBpbmNvcnJlY3RseSBuYW1lZC5cbiAgICB2YXIgZW52ID0ge1xuICAgICAgICBkb2N1bWVudDogZWRpdFNlc3Npb24sXG4gICAgICAgIGVkaXRvcjogZWRpdG9yLFxuICAgICAgICBvblJlc2l6ZTogZWRpdG9yLnJlc2l6ZS5iaW5kKGVkaXRvciwgbnVsbClcbiAgICB9O1xuXG4gICAgaWYgKG9sZE5vZGUpIGVudlsndGV4dGFyZWEnXSA9IG9sZE5vZGU7XG4gICAgYWRkTGlzdGVuZXIod2luZG93LCBcInJlc2l6ZVwiLCBlbnYub25SZXNpemUpO1xuICAgIGVkaXRvci5vbihcImRlc3Ryb3lcIiwgZnVuY3Rpb24oKSB7XG4gICAgICAgIHJlbW92ZUxpc3RlbmVyKHdpbmRvdywgXCJyZXNpemVcIiwgZW52Lm9uUmVzaXplKTtcbiAgICAgICAgZW52LmVkaXRvci5jb250YWluZXJbJ2VudiddID0gbnVsbDsgLy8gcHJldmVudCBtZW1vcnkgbGVhayBvbiBvbGQgaWVcbiAgICB9KTtcbiAgICBlZGl0b3IuY29udGFpbmVyWydlbnYnXSA9IGVkaXRvclsnZW52J10gPSBlbnY7XG4gICAgcmV0dXJuIHdyYXAoZWRpdG9yLCBlbGVtZW50LCB3b3Jrc3BhY2UsIGRvY3VtZW50KTtcbn07XG5cbi8qKlxuICogRnVuY3Rpb25hbCBjb25zdHJ1Y3RvciBmb3IgY3JlYXRpbmcgYSBuZXcgV29ya3NwYWNlLlxuICovXG5leHBvcnQgZnVuY3Rpb24gd29ya3NwYWNlKCkge1xuICAgIHJldHVybiB3b3Jrc3BhY2UoKTtcbn07XG5cbi8qKlxuICogQ3JlYXRlcyBhIG5ldyBbW0VkaXRTZXNzaW9uXV0sIGFuZCByZXR1cm5zIHRoZSBhc3NvY2lhdGVkIFtbRG9jdW1lbnRdXS5cbiAqIEBwYXJhbSB7RG9jdW1lbnQgfCBTdHJpbmd9IHRleHQgezp0ZXh0UGFyYW19XG4gKiBAcGFyYW0ge1RleHRNb2RlfSBtb2RlIHs6bW9kZVBhcmFtfVxuICogXG4gKiovXG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlRWRpdFNlc3Npb24odGV4dCwgbW9kZT8pIHtcbiAgICB2YXIgZG9jID0gbmV3IEVkaXRTZXNzaW9uKHRleHQsIG1vZGUpO1xuICAgIGRvYy5zZXRVbmRvTWFuYWdlcihuZXcgVW5kb01hbmFnZXIoKSk7XG4gICAgcmV0dXJuIGRvYztcbn07XG5cbmV4cG9ydCB2YXIgRWRpdFNlc3Npb24gPSBFZGl0U2Vzc2lvbjtcblxuZXhwb3J0IHZhciBVbmRvTWFuYWdlciA9IFVuZG9NYW5hZ2VyO1xuIl19