import { ContinuousRecognizer } from './attribute';
import { DIRECTION_ALL, DIRECTION_DOWN, DIRECTION_HORIZONTAL, DIRECTION_LEFT, DIRECTION_RIGHT, DIRECTION_UNDEFINED, DIRECTION_UP, DIRECTION_VERTICAL, STATE_BEGAN, TOUCH_ACTION_PAN_X, TOUCH_ACTION_PAN_Y } from '../hammer';
export class PanRecognizer extends ContinuousRecognizer {
    constructor(eventName, enabled) {
        super(eventName, enabled, 1);
        this.direction = DIRECTION_ALL;
        this.threshold = 10;
    }
    setDirection(direction) {
        this.direction = direction;
        return this;
    }
    setThreshold(threshold) {
        this.threshold = threshold;
        return this;
    }
    getTouchAction() {
        var actions = [];
        if (this.direction & DIRECTION_HORIZONTAL) {
            actions.push(TOUCH_ACTION_PAN_Y);
        }
        if (this.direction & DIRECTION_VERTICAL) {
            actions.push(TOUCH_ACTION_PAN_X);
        }
        return actions;
    }
    directionTest(input) {
        var hasMoved = true;
        var distance = input.distance;
        var direction = input.direction;
        var x = input.movement.x;
        var y = input.movement.y;
        if (!(direction & this.direction)) {
            if (this.direction & DIRECTION_HORIZONTAL) {
                direction = (x === 0) ? DIRECTION_UNDEFINED : (x < 0) ? DIRECTION_LEFT : DIRECTION_RIGHT;
                hasMoved = x != this.pX;
                distance = Math.abs(input.movement.x);
            }
            else {
                direction = (y === 0) ? DIRECTION_UNDEFINED : (y < 0) ? DIRECTION_UP : DIRECTION_DOWN;
                hasMoved = y != this.pY;
                distance = Math.abs(input.movement.y);
            }
        }
        var directionAllowed = (direction & this.direction) > 0;
        return hasMoved && distance > this.threshold && directionAllowed;
    }
    attributeTest(input) {
        this.movement = input.movement;
        if (input.movement) {
            var directionOK = this.directionTest(input);
            var began = (this.state & STATE_BEGAN) > 0;
            return super.attributeTest(input) && (began || (!began && directionOK));
        }
        else {
            return true;
        }
    }
    emit() {
        if (this.movement) {
            this.manager.emit(this.eventName, this.movement);
        }
    }
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicGFuLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vc3JjL2hhbW1lci9yZWNvZ25pemVycy9wYW4udHMiXSwibmFtZXMiOlsiUGFuUmVjb2duaXplciIsIlBhblJlY29nbml6ZXIuY29uc3RydWN0b3IiLCJQYW5SZWNvZ25pemVyLnNldERpcmVjdGlvbiIsIlBhblJlY29nbml6ZXIuc2V0VGhyZXNob2xkIiwiUGFuUmVjb2duaXplci5nZXRUb3VjaEFjdGlvbiIsIlBhblJlY29nbml6ZXIuZGlyZWN0aW9uVGVzdCIsIlBhblJlY29nbml6ZXIuYXR0cmlidXRlVGVzdCIsIlBhblJlY29nbml6ZXIuZW1pdCJdLCJtYXBwaW5ncyI6Ik9BQU8sRUFBRSxvQkFBb0IsRUFBRSxNQUFNLGFBQWE7T0FDM0MsRUFDUCxhQUFhLEVBQ2IsY0FBYyxFQUNkLG9CQUFvQixFQUNwQixjQUFjLEVBQ2QsZUFBZSxFQUNmLG1CQUFtQixFQUNuQixZQUFZLEVBQ1osa0JBQWtCLEVBRWxCLFdBQVcsRUFDWCxrQkFBa0IsRUFDbEIsa0JBQWtCLEVBRWpCLE1BQU0sV0FBVztBQUtsQixtQ0FBbUMsb0JBQW9CO0lBTW5EQSxZQUFZQSxTQUFpQkEsRUFBRUEsT0FBZ0JBO1FBQzNDQyxNQUFNQSxTQUFTQSxFQUFFQSxPQUFPQSxFQUFFQSxDQUFDQSxDQUFDQSxDQUFDQTtRQUp6QkEsY0FBU0EsR0FBV0EsYUFBYUEsQ0FBQ0E7UUFDbENBLGNBQVNBLEdBQUdBLEVBQUVBLENBQUNBO0lBSXZCQSxDQUFDQTtJQUNERCxZQUFZQSxDQUFDQSxTQUFpQkE7UUFDMUJFLElBQUlBLENBQUNBLFNBQVNBLEdBQUdBLFNBQVNBLENBQUNBO1FBQzNCQSxNQUFNQSxDQUFDQSxJQUFJQSxDQUFDQTtJQUNoQkEsQ0FBQ0E7SUFDREYsWUFBWUEsQ0FBQ0EsU0FBaUJBO1FBQzFCRyxJQUFJQSxDQUFDQSxTQUFTQSxHQUFHQSxTQUFTQSxDQUFDQTtRQUMzQkEsTUFBTUEsQ0FBQ0EsSUFBSUEs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QWFBLENBQUNBLEtBQUtBLENBQUNBLENBQUNBO1lBQ3JEQSxJQUFJQSxLQUFLQSxHQUFZQSxDQUFDQSxJQUFJQSxDQUFDQSxLQUFLQSxHQUFHQSxXQUFXQSxDQUFDQSxHQUFHQSxDQUFDQSxDQUFDQTtZQUNwREEsTUFBTUEsQ0FBQ0EsS0FBS0EsQ0FBQ0EsYUFBYUEsQ0FBQ0EsS0FBS0EsQ0FBQ0EsSUFBSUEsQ0FBQ0EsS0FBS0EsSUFBSUEsQ0FBQ0EsQ0FBQ0EsS0FBS0EsSUFBSUEsV0FBV0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0E7UUFDNUVBLENBQUNBO1FBQ0RBLElBQUlBLENBQUNBLENBQUNBO1lBQ0ZBLE1BQU1BLENBQUNBLElBQUlBLENBQUNBO1FBQ2hCQSxDQUFDQTtJQUNMQSxDQUFDQTtJQUVETixJQUFJQTtRQUNBTyxFQUFFQSxDQUFDQSxDQUFDQSxJQUFJQSxDQUFDQSxRQUFRQSxDQUFDQSxDQUFDQSxDQUFDQTtZQUNoQkEsSUFBSUEsQ0FBQ0EsT0FBT0EsQ0FBQ0EsSUFBSUEsQ0FBQ0EsSUFBSUEsQ0FBQ0EsU0FBU0EsRUFBRUEsSUFBSUEsQ0FBQ0EsUUFBUUEsQ0FBQ0EsQ0FBQ0E7UUFDckRBLENBQUNBO0lBQ0xBLENBQUNBO0FBQ0xQLENBQUNBO0FBQUEiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBDb250aW51b3VzUmVjb2duaXplciB9IGZyb20gJy4vYXR0cmlidXRlJztcbmltcG9ydCB7XG5ESVJFQ1RJT05fQUxMLFxuRElSRUNUSU9OX0RPV04sXG5ESVJFQ1RJT05fSE9SSVpPTlRBTCxcbkRJUkVDVElPTl9MRUZULFxuRElSRUNUSU9OX1JJR0hULFxuRElSRUNUSU9OX1VOREVGSU5FRCxcbkRJUkVDVElPTl9VUCxcbkRJUkVDVElPTl9WRVJUSUNBTCxcbklDb21wdXRlZEV2ZW50LFxuU1RBVEVfQkVHQU4sXG5UT1VDSF9BQ1RJT05fUEFOX1gsXG5UT1VDSF9BQ1RJT05fUEFOX1ksXG5WZWN0b3JFMlxufSBmcm9tICcuLi9oYW1tZXInO1xuXG4vKipcbiAqXG4gKi9cbmV4cG9ydCBjbGFzcyBQYW5SZWNvZ25pemVyIGV4dGVuZHMgQ29udGludW91c1JlY29nbml6ZXIge1xuICAgIHByaXZhdGUgcFg6IG51bWJlcjtcbiAgICBwcml2YXRlIHBZOiBudW1iZXI7XG4gICAgcHJpdmF0ZSBkaXJlY3Rpb246IG51bWJlciA9IERJUkVDVElPTl9BTEw7XG4gICAgcHJpdmF0ZSB0aHJlc2hvbGQgPSAxMDtcbiAgICBwcml2YXRlIG1vdmVtZW50OiBWZWN0b3JFMjtcbiAgICBjb25zdHJ1Y3RvcihldmVudE5hbWU6IHN0cmluZywgZW5hYmxlZDogYm9vbGVhbikge1xuICAgICAgICBzdXBlcihldmVudE5hbWUsIGVuYWJsZWQsIDEpO1xuICAgIH1cbiAgICBzZXREaXJlY3Rpb24oZGlyZWN0aW9uOiBudW1iZXIpOiBQYW5SZWNvZ25pemVyIHtcbiAgICAgICAgdGhpcy5kaXJlY3Rpb24gPSBkaXJlY3Rpb247XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cbiAgICBzZXRUaHJlc2hvbGQodGhyZXNob2xkOiBudW1iZXIpOiBQYW5SZWNvZ25pemVyIHtcbiAgICAgICAgdGhpcy50aHJlc2hvbGQgPSB0aHJlc2hvbGQ7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cbiAgICBnZXRUb3VjaEFjdGlvbigpOiBzdHJpbmdbXSB7XG4gICAgICAgIHZhciBhY3Rpb25zOiBzdHJpbmdbXSA9IFtdO1xuICAgICAgICBpZiAodGhpcy5kaXJlY3Rpb24gJiBESVJFQ1RJT05fSE9SSVpPTlRBTCkge1xuICAgICAgICAgICAgYWN0aW9ucy5wdXNoKFRPVUNIX0FDVElPTl9QQU5fWSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMuZGlyZWN0aW9uICYgRElSRUNUSU9OX1ZFUlRJQ0FMKSB7XG4gICAgICAgICAgICBhY3Rpb25zLnB1c2goVE9VQ0hfQUNUSU9OX1BBTl9YKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gYWN0aW9ucztcbiAgICB9XG5cbiAgICBkaXJlY3Rpb25UZXN0KGlucHV0OiBJQ29tcHV0ZWRFdmVudCk6IGJvb2xlYW4ge1xuICAgICAgICB2YXIgaGFzTW92ZWQgPSB0cnVlO1xuICAgICAgICB2YXIgZGlzdGFuY2UgPSBpbnB1dC5kaXN0YW5jZTtcbiAgICAgICAgdmFyIGRpcmVjdGlvbiA9IGlucHV0LmRpcmVjdGlvbjtcbiAgICAgICAgdmFyIHggPSBpbnB1dC5tb3ZlbWVudC54O1xuICAgICAgICB2YXIgeSA9IGlucHV0Lm1vdmVtZW50Lnk7XG5cbiAgICAgICAgLy8gbG9jayB0byBheGlzP1xuICAgICAgICBpZiAoIShkaXJlY3Rpb24gJiB0aGlzLmRpcmVjdGlvbikpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLmRpcmVjdGlvbiAmIERJUkVDVElPTl9IT1JJWk9OVEFMKSB7XG4gICAgICAgICAgICAgICAgZGlyZWN0aW9uID0gKHggPT09IDApID8gRElSRUNUSU9OX1VOREVGSU5FRCA6ICh4IDwgMCkgPyBESVJFQ1RJT05fTEVGVCA6IERJUkVDVElPTl9SSUdIVDtcbiAgICAgICAgICAgICAgICBoYXNNb3ZlZCA9IHggIT0gdGhpcy5wWDtcbiAgICAgICAgICAgICAgICBkaXN0YW5jZSA9IE1hdGguYWJzKGlucHV0Lm1vdmVtZW50LngpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgZGlyZWN0aW9uID0gKHkgPT09IDApID8gRElSRUNUSU9OX1VOREVGSU5FRCA6ICh5IDwgMCkgPyBESVJFQ1RJT05fVVAgOiBESVJFQ1RJT05fRE9XTjtcbiAgICAgICAgICAgICAgICBoYXNNb3ZlZCA9IHkgIT0gdGhpcy5wWTtcbiAgICAgICAgICAgICAgICBkaXN0YW5jZSA9IE1hdGguYWJzKGlucHV0Lm1vdmVtZW50LnkpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHZhciBkaXJlY3Rpb25BbGxvd2VkOiBib29sZWFuID0gKGRpcmVjdGlvbiAmIHRoaXMuZGlyZWN0aW9uKSA+IDA7XG4gICAgICAgIHJldHVybiBoYXNNb3ZlZCAmJiBkaXN0YW5jZSA+IHRoaXMudGhyZXNob2xkICYmIGRpcmVjdGlvbkFsbG93ZWQ7XG4gICAgfVxuXG4gICAgYXR0cmlidXRlVGVzdChpbnB1dDogSUNvbXB1dGVkRXZlbnQpOiBib29sZWFuIHtcbiAgICAgICAgdGhpcy5tb3ZlbWVudCA9IGlucHV0Lm1vdmVtZW50O1xuICAgICAgICAvLyBUaGUgZmlyc3QgYW5kIGxhc3QgZXZlbnRzIHdpbGwgbm90IGhhdmUgbW92ZW1lbnQgZGVmaW5lZC5cbiAgICAgICAgLy8gVGhlIGRpcmVjdGlvbiB0ZXN0IHJlcXVpcmVzIG1vdmVtZW50IVxuICAgICAgICBpZiAoaW5wdXQubW92ZW1lbnQpIHtcbiAgICAgICAgICAgIHZhciBkaXJlY3Rpb25PSzogYm9vbGVhbiA9IHRoaXMuZGlyZWN0aW9uVGVzdChpbnB1dCk7XG4gICAgICAgICAgICB2YXIgYmVnYW46IGJvb2xlYW4gPSAodGhpcy5zdGF0ZSAmIFNUQVRFX0JFR0FOKSA+IDA7XG4gICAgICAgICAgICByZXR1cm4gc3VwZXIuYXR0cmlidXRlVGVzdChpbnB1dCkgJiYgKGJlZ2FuIHx8ICghYmVnYW4gJiYgZGlyZWN0aW9uT0spKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgZW1pdCgpOiB2b2lkIHtcbiAgICAgICAgaWYgKHRoaXMubW92ZW1lbnQpIHtcbiAgICAgICAgICAgIHRoaXMubWFuYWdlci5lbWl0KHRoaXMuZXZlbnROYW1lLCB0aGlzLm1vdmVtZW50KTtcbiAgICAgICAgfVxuICAgIH1cbn1cbiJdfQ==