"use strict";
import { arrayToMap } from "../lib/lang";
import TextMode from "./Mode";
import JavaScriptMode from "./JavaScriptMode";
import CssMode from "./CssMode";
import HtmlHighlightRules from "./HtmlHighlightRules";
import HtmlBehaviour from "./behaviour/HtmlBehaviour";
import HtmlFoldMode from "./folding/HtmlFoldMode";
import HtmlCompletions from "./HtmlCompletions";
import WorkerClient from "../worker/WorkerClient";
var voidElements = ["area", "base", "br", "col", "embed", "hr", "img", "input", "keygen", "link", "meta", "param", "source", "track", "wbr"];
var optionalEndTags = ["li", "dt", "dd", "p", "rt", "rp", "optgroup", "option", "colgroup", "td", "th"];
export default class HtmlMode extends TextMode {
    constructor(options) {
        super();
        this.blockComment = { start: "<!--", end: "-->" };
        this.voidElements = arrayToMap(voidElements);
        this.$id = "ace/mode/html";
        this.fragmentContext = options && options.fragmentContext;
        this.HighlightRules = HtmlHighlightRules;
        this.$behaviour = new HtmlBehaviour();
        this.$completer = new HtmlCompletions();
        this.createModeDelegates({
            "js-": JavaScriptMode,
            "css-": CssMode
        });
        this.foldingRules = new HtmlFoldMode(this.voidElements, arrayToMap(optionalEndTags));
    }
    getNextLineIndent(state, line, tab) {
        return this.$getIndent(line);
    }
    checkOutdent(state, line, text) {
        return false;
    }
    getCompletions(state, session, pos, prefix) {
        return this.$completer.getCompletions(state, session, pos, prefix);
    }
    createWorker(session) {
        var worker = new WorkerClient("lib/worker/worker-systemjs.js");
        var mode = this;
        worker.on("initAfter", function () {
            worker.attachToDocument(session.getDocument());
            if (mode.fragmentContext) {
                worker.call("setOptions", [{ context: mode.fragmentContext }]);
            }
        });
        worker.on("error", function (message) {
            session.setAnnotations(message.data);
        });
        worker.on("terminate", function () {
            session.clearAnnotations();
        });
        worker.init("lib/mode/HtmlWorker", "default");
        return worker;
    }
    ;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiSHRtbE1vZGUuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi9zcmMvbW9kZS9IdG1sTW9kZS50cyJdLCJuYW1lcyI6WyJIdG1sTW9kZSIsIkh0bWxNb2RlLmNvbnN0cnVjdG9yIiwiSHRtbE1vZGUuZ2V0TmV4dExpbmVJbmRlbnQiLCJIdG1sTW9kZS5jaGVja091dGRlbnQiLCJIdG1sTW9kZS5nZXRDb21wbGV0aW9ucyIsIkh0bWxNb2RlLmNyZWF0ZVdvcmtlciJdLCJtYXBwaW5ncyI6IkFBNkJBLFlBQVksQ0FBQztPQUdOLEVBQUMsVUFBVSxFQUFDLE1BQU0sYUFBYTtPQUUvQixRQUFRLE1BQU0sUUFBUTtPQUN0QixjQUFjLE1BQU0sa0JBQWtCO09BQ3RDLE9BQU8sTUFBTSxXQUFXO09BQ3hCLGtCQUFrQixNQUFNLHNCQUFzQjtPQUM5QyxhQUFhLE1BQU0sMkJBQTJCO09BQzlDLFlBQVksTUFBTSx3QkFBd0I7T0FDMUMsZUFBZSxNQUFNLG1CQUFtQjtPQUN4QyxZQUFZLE1BQU0sd0JBQXdCO0FBSWpELElBQUksWUFBWSxHQUFHLENBQUMsTUFBTSxFQUFFLE1BQU0sRUFBRSxJQUFJLEVBQUUsS0FBSyxFQUFFLE9BQU8sRUFBRSxJQUFJLEVBQUUsS0FBSyxFQUFFLE9BQU8sRUFBRSxRQUFRLEVBQUUsTUFBTSxFQUFFLE1BQU0sRUFBRSxPQUFPLEVBQUUsUUFBUSxFQUFFLE9BQU8sRUFBRSxLQUFLLENBQUMsQ0FBQztBQUM3SSxJQUFJLGVBQWUsR0FBRyxDQUFDLElBQUksRUFBRSxJQUFJLEVBQUUsSUFBSSxFQUFFLEdBQUcsRUFBRSxJQUFJLEVBQUUsSUFBSSxFQUFFLFVBQVUsRUFBRSxRQUFRLEVBQUUsVUFBVSxFQUFFLElBQUksRUFBRSxJQUFJLENBQUMsQ0FBQztBQUt4RyxzQ0FBc0MsUUFBUTtJQWdCMUNBLFlBQVlBLE9BQXFDQTtRQUM3Q0MsT0FBT0EsQ0FBQ0E7UUFoQkZBLGlCQUFZQSxHQUFHQSxFQUFFQSxLQUFLQSxFQUFFQSxNQUFNQSxFQUFFQSxHQUFHQSxFQUFFQSxLQUFLQSxFQUFFQSxDQUFDQTtRQUMvQ0EsaUJBQVlBLEdBQUdBLFVBQVVBLENBQUNBLFlBQVlBLENBQUNBLENBQUNBO1FBQ3pDQSxRQUFHQSxHQUFHQSxlQUFlQSxDQUFDQTtRQWV6QkEsSUFBSUEsQ0FBQ0EsZUFBZUEsR0FBR0EsT0FBT0EsSUFBSUEsT0FBT0EsQ0FBQ0EsZUFBZUEsQ0FBQ0E7UUFDMURBLElBQUlBLENBQUNBLGNBQWNBLEdBQUdBLGtCQUFrQkEsQ0FBQ0E7UUFDekNBLElBQUlBLENBQUNBLFVBQVVBLEdBQUdBLElBQUlBLGFBQWFBLEVBQUVBLENBQUNBO1FBQ3RDQSxJQUFJQSxDQUFDQSxVQUFVQSxHQUFHQSxJQUFJQSxlQUFlQSxFQUFFQSxDQUFDQTtRQUV4Q0EsSUFBSUEsQ0FBQ0EsbUJBQW1CQSxDQUFDQTtZQUNyQkEsS0FBS0EsRUFBRUEsY0FBY0E7WUFDckJBLE1BQU1BLEVBQUVBLE9BQU9BO1NBQ2xCQSxDQUFDQSxDQUFDQTtRQUVIQSxJQUFJQSxDQUFDQSxZQUFZQSxHQUFHQSxJQUFJQSxZQUFZQSxDQUFDQSxJQUFJQSxDQUFDQSxZQUFZQSxFQUFFQSxVQUFVQSxDQUFDQSxlQUFlQSxDQUFDQSxDQUFDQSxDQUFDQTtJQUN6RkEsQ0FBQ0E7SUFFREQsaUJBQWlCQSxDQUFDQSxLQUFhQSxFQUFFQSxJQUFZQSxFQUFFQSxHQUFXQTtRQUN0REUsTUFBTUEsQ0FBQ0EsSUFBSUEsQ0FBQ0EsVUFBVUEsQ0FBQ0EsSUFBSUEsQ0FBQ0EsQ0FBQ0E7SUFDakNBLENBQUNBO0lBRURGLFlBQVlBLENBQUNBLEtBQWFBLEVBQUVBLElBQVlBLEVBQUVBLElBQVlBO1FBQ2xERyxNQUFNQSxDQUFDQSxLQUFLQSxDQUFDQTtJQUNqQkEsQ0FBQ0E7SUFFREgsY0FBY0EsQ0FBQ0EsS0FBYUEsRUFBRUEsT0FBb0JBLEVBQUVBLEdBQW9DQSxFQUFFQSxNQUFjQTtRQUNwR0ksTUFBTUEsQ0FBQ0EsSUFBSUEsQ0FBQ0EsVUFBVUEsQ0FBQ0EsY0FBY0EsQ0FBQ0EsS0FBS0EsRUFBRUEsT0FBT0EsRUFBRUEsR0FBR0EsRUFBRUEsTUFBTUEsQ0FBQ0EsQ0FBQ0E7SUFDdkVBLENBQUNBO0lBRURKLFlBQVlBLENBQUNBLE9BQW9CQTtRQUU3QkssSUFBSUEsTUFBTUEsR0FBR0EsSUFBSUEsWUFBWUEsQ0FBQ0EsK0JBQStCQSxDQUFDQSxDQUFDQTtRQUMvREEsSUFBSUEsSUFBSUEsR0FBR0EsSUFBSUEsQ0FBQ0E7UUFFaEJBLE1BQU1BLENBQUNBLEVBQUVBLENBQUNBLFdBQVdBLEVBQUVBO1lBQ25CLE1BQU0sQ0FBQyxnQkFBZ0IsQ0FBQyxPQUFPLENBQUMsV0FBVyxFQUFFLENBQUMsQ0FBQztZQUMvQyxFQUFFLENBQUMsQ0FBQyxJQUFJLENBQUMsZUFBZSxDQUFDLENBQUMsQ0FBQztnQkFDdkIsTUFBTSxDQUFDLElBQUksQ0FBQyxZQUFZLEVBQUUsQ0FBQyxFQUFFLE9BQU8sRUFBRSxJQUFJLENBQUMsZUFBZSxFQUFFLENBQUMsQ0FBQyxDQUFDO1lBQ25FLENBQUM7UUFDTCxDQUFDLENBQUNBLENBQUNBO1FBR0hBLE1BQU1BLENBQUNBLEVBQUVBLENBQUNBLE9BQU9BLEVBQUVBLFVBQVNBLE9BQTZCQTtZQUNyRCxPQUFPLENBQUMsY0FBYyxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsQ0FBQztRQUN6QyxDQUFDLENBQUNBLENBQUNBO1FBRUhBLE1BQU1BLENBQUNBLEVBQUVBLENBQUNBLFdBQVdBLEVBQUVBO1lBQ25CLE9BQU8sQ0FBQyxnQkFBZ0IsRUFBRSxDQUFDO1FBQy9CLENBQUMsQ0FBQ0EsQ0FBQ0E7UUFFSEEsTUFBTUEsQ0FBQ0EsSUFBSUEsQ0FBQ0EscUJBQXFCQSxFQUFFQSxTQUFTQSxDQUFDQSxDQUFDQTtRQUU5Q0EsTUFBTUEsQ0FBQ0EsTUFBTUEsQ0FBQ0E7SUFDbEJBLENBQUNBOztBQUNMTCxDQUFDQTtBQUFBIiwic291cmNlc0NvbnRlbnQiOlsiLyogKioqKiogQkVHSU4gTElDRU5TRSBCTE9DSyAqKioqKlxuICogRGlzdHJpYnV0ZWQgdW5kZXIgdGhlIEJTRCBsaWNlbnNlOlxuICpcbiAqIENvcHlyaWdodCAoYykgMjAxMCwgQWpheC5vcmcgQi5WLlxuICogQWxsIHJpZ2h0cyByZXNlcnZlZC5cbiAqIFxuICogUmVkaXN0cmlidXRpb24gYW5kIHVzZSBpbiBzb3VyY2UgYW5kIGJpbmFyeSBmb3Jtcywgd2l0aCBvciB3aXRob3V0XG4gKiBtb2RpZmljYXRpb24sIGFyZSBwZXJtaXR0ZWQgcHJvdmlkZWQgdGhhdCB0aGUgZm9sbG93aW5nIGNvbmRpdGlvbnMgYXJlIG1ldDpcbiAqICAgICAqIFJlZGlzdHJpYnV0aW9ucyBvZiBzb3VyY2UgY29kZSBtdXN0IHJldGFpbiB0aGUgYWJvdmUgY29weXJpZ2h0XG4gKiAgICAgICBub3RpY2UsIHRoaXMgbGlzdCBvZiBjb25kaXRpb25zIGFuZCB0aGUgZm9sbG93aW5nIGRpc2NsYWltZXIuXG4gKiAgICAgKiBSZWRpc3RyaWJ1dGlvbnMgaW4gYmluYXJ5IGZvcm0gbXVzdCByZXByb2R1Y2UgdGhlIGFib3ZlIGNvcHlyaWdodFxuICogICAgICAgbm90aWNlLCB0aGlzIGxpc3Qgb2YgY29uZGl0aW9ucyBhbmQgdGhlIGZvbGxvd2luZyBkaXNjbGFpbWVyIGluIHRoZVxuICogICAgICAgZG9jdW1lbnRhdGlvbiBhbmQvb3Igb3RoZXIgbWF0ZXJpYWxzIHByb3ZpZGVkIHdpdGggdGhlIGRpc3RyaWJ1dGlvbi5cbiAqICAgICAqIE5laXRoZXIgdGhlIG5hbWUgb2YgQWpheC5vcmcgQi5WLiBub3IgdGhlXG4gKiAgICAgICBuYW1lcyBvZiBpdHMgY29udHJpYnV0b3JzIG1heSBiZSB1c2VkIHRvIGVuZG9yc2Ugb3IgcHJvbW90ZSBwcm9kdWN0c1xuICogICAgICAgZGVyaXZlZCBmcm9tIHRoaXMgc29mdHdhcmUgd2l0aG91dCBzcGVjaWZpYyBwcmlvciB3cml0dGVuIHBlcm1pc3Npb24uXG4gKiBcbiAqIFRISVMgU09GVFdBUkUgSVMgUFJPVklERUQgQlkgVEhFIENPUFlSSUdIVCBIT0xERVJTIEFORCBDT05UUklCVVRPUlMgXCJBUyBJU1wiIEFORFxuICogQU5ZIEVYUFJFU1MgT1IgSU1QTElFRCBXQVJSQU5USUVTLCBJTkNMVURJTkcsIEJVVCBOT1QgTElNSVRFRCBUTywgVEhFIElNUExJRURcbiAqIFdBUlJBTlRJRVMgT0YgTUVSQ0hBTlRBQklMSVRZIEFORCBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRSBBUkVcbiAqIERJU0NMQUlNRUQuIElOIE5PIEVWRU5UIFNIQUxMIEFKQVguT1JHIEIuVi4gQkUgTElBQkxFIEZPUiBBTllcbiAqIERJUkVDVCwgSU5ESVJFQ1QsIElOQ0lERU5UQUwsIFNQRUNJQUwsIEVYRU1QTEFSWSwgT1IgQ09OU0VRVUVOVElBTCBEQU1BR0VTXG4gKiAoSU5DTFVESU5HLCBCVVQgTk9UIExJTUlURUQgVE8sIFBST0NVUkVNRU5UIE9GIFNVQlNUSVRVVEUgR09PRFMgT1IgU0VSVklDRVM7XG4gKiBMT1NTIE9GIFVTRSwgREFUQSwgT1IgUFJPRklUUzsgT1IgQlVTSU5FU1MgSU5URVJSVVBUSU9OKSBIT1dFVkVSIENBVVNFRCBBTkRcbiAqIE9OIEFOWSBUSEVPUlkgT0YgTElBQklMSVRZLCBXSEVUSEVSIElOIENPTlRSQUNULCBTVFJJQ1QgTElBQklMSVRZLCBPUiBUT1JUXG4gKiAoSU5DTFVESU5HIE5FR0xJR0VOQ0UgT1IgT1RIRVJXSVNFKSBBUklTSU5HIElOIEFOWSBXQVkgT1VUIE9GIFRIRSBVU0UgT0YgVEhJU1xuICogU09GVFdBUkUsIEVWRU4gSUYgQURWSVNFRCBPRiBUSEUgUE9TU0lCSUxJVFkgT0YgU1VDSCBEQU1BR0UuXG4gKlxuICogKioqKiogRU5EIExJQ0VOU0UgQkxPQ0sgKioqKiogKi9cblwidXNlIHN0cmljdFwiO1xuXG5pbXBvcnQge2luaGVyaXRzfSBmcm9tIFwiLi4vbGliL29vcFwiO1xuaW1wb3J0IHthcnJheVRvTWFwfSBmcm9tIFwiLi4vbGliL2xhbmdcIjtcbmltcG9ydCBBbm5vdGF0aW9uIGZyb20gXCIuLi9Bbm5vdGF0aW9uXCI7XG5pbXBvcnQgVGV4dE1vZGUgZnJvbSBcIi4vTW9kZVwiO1xuaW1wb3J0IEphdmFTY3JpcHRNb2RlIGZyb20gXCIuL0phdmFTY3JpcHRNb2RlXCI7XG5pbXBvcnQgQ3NzTW9kZSBmcm9tIFwiLi9Dc3NNb2RlXCI7XG5pbXBvcnQgSHRtbEhpZ2hsaWdodFJ1bGVzIGZyb20gXCIuL0h0bWxIaWdobGlnaHRSdWxlc1wiO1xuaW1wb3J0IEh0bWxCZWhhdmlvdXIgZnJvbSBcIi4vYmVoYXZpb3VyL0h0bWxCZWhhdmlvdXJcIjtcbmltcG9ydCBIdG1sRm9sZE1vZGUgZnJvbSBcIi4vZm9sZGluZy9IdG1sRm9sZE1vZGVcIjtcbmltcG9ydCBIdG1sQ29tcGxldGlvbnMgZnJvbSBcIi4vSHRtbENvbXBsZXRpb25zXCI7XG5pbXBvcnQgV29ya2VyQ2xpZW50IGZyb20gXCIuLi93b3JrZXIvV29ya2VyQ2xpZW50XCI7XG5pbXBvcnQgRWRpdFNlc3Npb24gZnJvbSBcIi4uL0VkaXRTZXNzaW9uXCI7XG5cbi8vIGh0dHA6Ly93d3cudzMub3JnL1RSL2h0bWw1L3N5bnRheC5odG1sI3ZvaWQtZWxlbWVudHNcbnZhciB2b2lkRWxlbWVudHMgPSBbXCJhcmVhXCIsIFwiYmFzZVwiLCBcImJyXCIsIFwiY29sXCIsIFwiZW1iZWRcIiwgXCJoclwiLCBcImltZ1wiLCBcImlucHV0XCIsIFwia2V5Z2VuXCIsIFwibGlua1wiLCBcIm1ldGFcIiwgXCJwYXJhbVwiLCBcInNvdXJjZVwiLCBcInRyYWNrXCIsIFwid2JyXCJdO1xudmFyIG9wdGlvbmFsRW5kVGFncyA9IFtcImxpXCIsIFwiZHRcIiwgXCJkZFwiLCBcInBcIiwgXCJydFwiLCBcInJwXCIsIFwib3B0Z3JvdXBcIiwgXCJvcHRpb25cIiwgXCJjb2xncm91cFwiLCBcInRkXCIsIFwidGhcIl07XG5cbi8qKlxuICogQGNsYXNzIEh0bWxNb2RlXG4gKi9cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIEh0bWxNb2RlIGV4dGVuZHMgVGV4dE1vZGUge1xuICAgIHByb3RlY3RlZCBibG9ja0NvbW1lbnQgPSB7IHN0YXJ0OiBcIjwhLS1cIiwgZW5kOiBcIi0tPlwiIH07XG4gICAgcHJpdmF0ZSB2b2lkRWxlbWVudHMgPSBhcnJheVRvTWFwKHZvaWRFbGVtZW50cyk7XG4gICAgcHVibGljICRpZCA9IFwiYWNlL21vZGUvaHRtbFwiO1xuXG4gICAgLyoqXG4gICAgICogVGhlIG5hbWUgb2YgdGhlIGVsZW1lbnQgZm9yIGZyYWdtZW50IHBhcnNpbmcuXG4gICAgICovXG4gICAgcHJpdmF0ZSBmcmFnbWVudENvbnRleHQ6IHN0cmluZztcblxuICAgICRjb21wbGV0ZXI6IEh0bWxDb21wbGV0aW9ucztcblxuICAgIC8qKlxuICAgICAqIEBjbGFzcyBIdG1sTW9kZVxuICAgICAqIEBjb25zdHJ1Y3RvclxuICAgICAqL1xuICAgIGNvbnN0cnVjdG9yKG9wdGlvbnM/OiB7IGZyYWdtZW50Q29udGV4dDogc3RyaW5nIH0pIHtcbiAgICAgICAgc3VwZXIoKTtcbiAgICAgICAgdGhpcy5mcmFnbWVudENvbnRleHQgPSBvcHRpb25zICYmIG9wdGlvbnMuZnJhZ21lbnRDb250ZXh0O1xuICAgICAgICB0aGlzLkhpZ2hsaWdodFJ1bGVzID0gSHRtbEhpZ2hsaWdodFJ1bGVzO1xuICAgICAgICB0aGlzLiRiZWhhdmlvdXIgPSBuZXcgSHRtbEJlaGF2aW91cigpO1xuICAgICAgICB0aGlzLiRjb21wbGV0ZXIgPSBuZXcgSHRtbENvbXBsZXRpb25zKCk7XG5cbiAgICAgICAgdGhpcy5jcmVhdGVNb2RlRGVsZWdhdGVzKHtcbiAgICAgICAgICAgIFwianMtXCI6IEphdmFTY3JpcHRNb2RlLFxuICAgICAgICAgICAgXCJjc3MtXCI6IENzc01vZGVcbiAgICAgICAgfSk7XG5cbiAgICAgICAgdGhpcy5mb2xkaW5nUnVsZXMgPSBuZXcgSHRtbEZvbGRNb2RlKHRoaXMudm9pZEVsZW1lbnRzLCBhcnJheVRvTWFwKG9wdGlvbmFsRW5kVGFncykpO1xuICAgIH1cblxuICAgIGdldE5leHRMaW5lSW5kZW50KHN0YXRlOiBzdHJpbmcsIGxpbmU6IHN0cmluZywgdGFiOiBzdHJpbmcpOiBzdHJpbmcge1xuICAgICAgICByZXR1cm4gdGhpcy4kZ2V0SW5kZW50KGxpbmUpO1xuICAgIH1cblxuICAgIGNoZWNrT3V0ZGVudChzdGF0ZTogc3RyaW5nLCBsaW5lOiBzdHJpbmcsIHRleHQ6IHN0cmluZyk6IGJvb2xlYW4ge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuXG4gICAgZ2V0Q29tcGxldGlvbnMoc3RhdGU6IHN0cmluZywgc2Vzc2lvbjogRWRpdFNlc3Npb24sIHBvczogeyByb3c6IG51bWJlcjsgY29sdW1uOiBudW1iZXIgfSwgcHJlZml4OiBzdHJpbmcpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuJGNvbXBsZXRlci5nZXRDb21wbGV0aW9ucyhzdGF0ZSwgc2Vzc2lvbiwgcG9zLCBwcmVmaXgpO1xuICAgIH1cblxuICAgIGNyZWF0ZVdvcmtlcihzZXNzaW9uOiBFZGl0U2Vzc2lvbik6IFdvcmtlckNsaWVudCB7XG5cbiAgICAgICAgdmFyIHdvcmtlciA9IG5ldyBXb3JrZXJDbGllbnQoXCJsaWIvd29ya2VyL3dvcmtlci1zeXN0ZW1qcy5qc1wiKTtcbiAgICAgICAgdmFyIG1vZGUgPSB0aGlzO1xuXG4gICAgICAgIHdvcmtlci5vbihcImluaXRBZnRlclwiLCBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHdvcmtlci5hdHRhY2hUb0RvY3VtZW50KHNlc3Npb24uZ2V0RG9jdW1lbnQoKSk7XG4gICAgICAgICAgICBpZiAobW9kZS5mcmFnbWVudENvbnRleHQpIHtcbiAgICAgICAgICAgICAgICB3b3JrZXIuY2FsbChcInNldE9wdGlvbnNcIiwgW3sgY29udGV4dDogbW9kZS5mcmFnbWVudENvbnRleHQgfV0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcblxuICAgICAgICAvLyBGSVhNRTogU3RhbmRhcmRpemVcbiAgICAgICAgd29ya2VyLm9uKFwiZXJyb3JcIiwgZnVuY3Rpb24obWVzc2FnZToge2RhdGE6IEFubm90YXRpb25bXX0pIHtcbiAgICAgICAgICAgIHNlc3Npb24uc2V0QW5ub3RhdGlvbnMobWVzc2FnZS5kYXRhKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgd29ya2VyLm9uKFwidGVybWluYXRlXCIsIGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgc2Vzc2lvbi5jbGVhckFubm90YXRpb25zKCk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHdvcmtlci5pbml0KFwibGliL21vZGUvSHRtbFdvcmtlclwiLCBcImRlZmF1bHRcIik7XG5cbiAgICAgICAgcmV0dXJuIHdvcmtlcjtcbiAgICB9O1xufVxuIl19