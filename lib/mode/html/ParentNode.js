import Node from './Node';
export default class ParentNode extends Node {
    constructor(locator) {
        super(locator);
        this.lastChild = null;
        this._endLocator = null;
    }
    insertBefore(child, sibling) {
        if (!sibling) {
            return this.appendChild(child);
        }
        child.detach();
        child.parentNode = this;
        if (this.firstChild == sibling) {
            child.nextSibling = sibling;
            this.firstChild = child;
        }
        else {
            var prev = this.firstChild;
            var next = this.firstChild.nextSibling;
            while (next != sibling) {
                prev = next;
                next = next.nextSibling;
            }
            prev.nextSibling = child;
            child.nextSibling = next;
        }
        return child;
    }
    insertBetween(child, prev, next) {
        if (!next) {
            return this.appendChild(child);
        }
        child.detach();
        child.parentNode = this;
        child.nextSibling = next;
        if (!prev) {
            this.firstChild = child;
        }
        else {
            prev.nextSibling = child;
        }
        return child;
    }
    appendChild(child) {
        child.detach();
        child.parentNode = this;
        if (!this.firstChild) {
            this.firstChild = child;
        }
        else {
            this.lastChild.nextSibling = child;
        }
        this.lastChild = child;
        return child;
    }
    appendChildren(parent) {
        var child = parent.firstChild;
        if (!child) {
            return;
        }
        var another = parent;
        if (!this.firstChild) {
            this.firstChild = child;
        }
        else {
            this.lastChild.nextSibling = child;
        }
        this.lastChild = another.lastChild;
        do {
            child.parentNode = this;
        } while ((child = child.nextSibling));
        another.firstChild = null;
        another.lastChild = null;
    }
    removeChild(node) {
        if (this.firstChild == node) {
            this.firstChild = node.nextSibling;
            if (this.lastChild == node) {
                this.lastChild = null;
            }
        }
        else {
            var prev = this.firstChild;
            var next = this.firstChild.nextSibling;
            while (next != node) {
                prev = next;
                next = next.nextSibling;
            }
            prev.nextSibling = node.nextSibling;
            if (this.lastChild == node) {
                this.lastChild = prev;
            }
        }
        node.parentNode = null;
        return node;
    }
    get endLocator() {
        return this._endLocator;
    }
    set endLocator(endLocator) {
        this._endLocator = {
            lineNumber: endLocator.lineNumber,
            columnNumber: endLocator.columnNumber
        };
    }
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiUGFyZW50Tm9kZS5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy9tb2RlL2h0bWwvUGFyZW50Tm9kZS50cyJdLCJuYW1lcyI6WyJQYXJlbnROb2RlIiwiUGFyZW50Tm9kZS5jb25zdHJ1Y3RvciIsIlBhcmVudE5vZGUuaW5zZXJ0QmVmb3JlIiwiUGFyZW50Tm9kZS5pbnNlcnRCZXR3ZWVuIiwiUGFyZW50Tm9kZS5hcHBlbmRDaGlsZCIsIlBhcmVudE5vZGUuYXBwZW5kQ2hpbGRyZW4iLCJQYXJlbnROb2RlLnJlbW92ZUNoaWxkIiwiUGFyZW50Tm9kZS5lbmRMb2NhdG9yIl0sIm1hcHBpbmdzIjoiT0FBTyxJQUFJLE1BQU0sUUFBUTtBQUV6Qix3Q0FBd0MsSUFBSTtJQUd4Q0EsWUFBWUEsT0FBT0E7UUFDZkMsTUFBTUEsT0FBT0EsQ0FBQ0EsQ0FBQ0E7UUFDZkEsSUFBSUEsQ0FBQ0EsU0FBU0EsR0FBR0EsSUFBSUEsQ0FBQ0E7UUFDdEJBLElBQUlBLENBQUNBLFdBQVdBLEdBQUdBLElBQUlBLENBQUNBO0lBQzVCQSxDQUFDQTtJQU9ERCxZQUFZQSxDQUFDQSxLQUFLQSxFQUFFQSxPQUFPQTtRQUV2QkUsRUFBRUEsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsT0FBT0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0E7WUFDWEEsTUFBTUEsQ0FBQ0EsSUFBSUEsQ0FBQ0EsV0FBV0EsQ0FBQ0EsS0FBS0EsQ0FBQ0EsQ0FBQ0E7UUFDbkNBLENBQUNBO1FBQ0RBLEtBQUtBLENBQUNBLE1BQU1BLEVBQUVBLENBQUNBO1FBQ2ZBLEtBQUtBLENBQUNBLFVBQVVBLEdBQUdBLElBQUlBLENBQUNBO1FBQ3hCQSxFQUFFQSxDQUFDQSxDQUFDQSxJQUFJQSxDQUFDQSxVQUFVQSxJQUFJQSxPQUFPQSxDQUFDQSxDQUFDQSxDQUFDQTtZQUM3QkEsS0FBS0EsQ0FBQ0EsV0FBV0EsR0FBR0EsT0FBT0EsQ0FBQ0E7WUFDNUJBLElBQUlBLENBQUNBLFVBQVVBLEdBQUdBLEtBQUtBLENB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Q0EsU0FBU0EsQ0FBQ0E7UUFDbkNBLEdBQUdBLENBQUNBO1lBQ0FBLEtBQUtBLENBQUNBLFVBQVVBLEdBQUdBLElBQUlBLENBQUNBO1FBQzVCQSxDQUFDQSxRQUFRQSxDQUFDQSxLQUFLQSxHQUFHQSxLQUFLQSxDQUFDQSxXQUFXQSxDQUFDQSxFQUFFQTtRQUN0Q0EsT0FBT0EsQ0FBQ0EsVUFBVUEsR0FBR0EsSUFBSUEsQ0FBQ0E7UUFDMUJBLE9BQU9BLENBQUNBLFNBQVNBLEdBQUdBLElBQUlBLENBQUNBO0lBQzdCQSxDQUFDQTtJQU1ETCxXQUFXQSxDQUFDQSxJQUFJQTtRQUVaTSxFQUFFQSxDQUFDQSxDQUFDQSxJQUFJQSxDQUFDQSxVQUFVQSxJQUFJQSxJQUFJQSxDQUFDQSxDQUFDQSxDQUFDQTtZQUMxQkEsSUFBSUEsQ0FBQ0EsVUFBVUEsR0FBR0EsSUFBSUEsQ0FBQ0EsV0FBV0EsQ0FBQ0E7WUFDbkNBLEVBQUVBLENBQUNBLENBQUNBLElBQUlBLENBQUNBLFNBQVNBLElBQUlBLElBQUlBLENBQUNBLENBQUNBLENBQUNBO2dCQUN6QkEsSUFBSUEsQ0FBQ0EsU0FBU0EsR0FBR0EsSUFBSUEsQ0FBQ0E7WUFDMUJBLENBQUNBO1FBQ0xBLENBQUNBO1FBQUNBLElBQUlBLENBQUNBLENBQUNBO1lBQ0pBLElBQUlBLElBQUlBLEdBQUdBLElBQUlBLENBQUNBLFVBQVVBLENBQUNBO1lBQzNCQSxJQUFJQSxJQUFJQSxHQUFHQSxJQUFJQSxDQUFDQSxVQUFVQSxDQUFDQSxXQUFXQSxDQUFDQTtZQUN2Q0EsT0FBT0EsSUFBSUEsSUFBSUEsSUFBSUEsRUFBRUEsQ0FBQ0E7Z0JBQ2xCQSxJQUFJQSxHQUFHQSxJQUFJQSxDQUFDQTtnQkFDWkEsSUFBSUEsR0FBR0EsSUFBSUEsQ0FBQ0EsV0FBV0EsQ0FBQ0E7WUFDNUJBLENBQUNBO1lBQ0RBLElBQUlBLENBQUNBLFdBQVdBLEdBQUdBLElBQUlBLENBQUNBLFdBQVdBLENBQUNBO1lBQ3BDQSxFQUFFQSxDQUFDQSxDQUFDQSxJQUFJQSxDQUFDQSxTQUFTQSxJQUFJQSxJQUFJQSxDQUFDQSxDQUFDQSxDQUFDQTtnQkFDekJBLElBQUlBLENBQUNBLFNBQVNBLEdBQUdBLElBQUlBLENBQUNBO1lBQzFCQSxDQUFDQTtRQUNMQSxDQUFDQTtRQUNEQSxJQUFJQSxDQUFDQSxVQUFVQSxHQUFHQSxJQUFJQSxDQUFDQTtRQUN2QkEsTUFBTUEsQ0FBQ0EsSUFBSUEsQ0FBQ0E7SUFDaEJBLENBQUNBO0lBQ0ROLElBQUlBLFVBQVVBO1FBQ1ZPLE1BQU1BLENBQUNBLElBQUlBLENBQUNBLFdBQVdBLENBQUNBO0lBQzVCQSxDQUFDQTtJQUNEUCxJQUFJQSxVQUFVQSxDQUFDQSxVQUFVQTtRQUNyQk8sSUFBSUEsQ0FBQ0EsV0FBV0EsR0FBR0E7WUFDZkEsVUFBVUEsRUFBRUEsVUFBVUEsQ0FBQ0EsVUFBVUE7WUFDakNBLFlBQVlBLEVBQUVBLFVBQVVBLENBQUNBLFlBQVlBO1NBQ3hDQSxDQUFDQTtJQUNOQSxDQUFDQTtBQUNMUCxDQUFDQTtBQUFBIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IE5vZGUgZnJvbSAnLi9Ob2RlJztcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUGFyZW50Tm9kZSBleHRlbmRzIE5vZGUge1xuICAgIGxhc3RDaGlsZDtcbiAgICBfZW5kTG9jYXRvcjtcbiAgICBjb25zdHJ1Y3Rvcihsb2NhdG9yKSB7XG4gICAgICAgIHN1cGVyKGxvY2F0b3IpO1xuICAgICAgICB0aGlzLmxhc3RDaGlsZCA9IG51bGw7XG4gICAgICAgIHRoaXMuX2VuZExvY2F0b3IgPSBudWxsO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBJbnNlcnQgYSBuZXcgY2hpbGQgYmVmb3JlIGEgcHJlLWV4aXN0aW5nIGNoaWxkIGFuZCByZXR1cm4gdGhlIG5ld2x5IGluc2VydGVkIGNoaWxkLlxuICAgICAqIEBwYXJhbSBjaGlsZCB0aGUgbmV3IGNoaWxkXG4gICAgICogQHBhcmFtIHNpYmxpbmcgdGhlIGV4aXN0aW5nIGNoaWxkIGJlZm9yZSB3aGljaCB0byBpbnNlcnQgKG11c3QgYmUgYSBjaGlsZCBvZiB0aGlzIG5vZGUpIG9yIDxjb2RlPm51bGw8L2NvZGU+IHRvIGFwcGVuZFxuICAgICAqIEByZXR1cm4gPGNvZGU+Y2hpbGQ8L2NvZGU+XG4gICAgICovXG4gICAgaW5zZXJ0QmVmb3JlKGNoaWxkLCBzaWJsaW5nKSB7XG4gICAgICAgIC8vYXNzZXJ0IHNpYmxpbmcgPT0gbnVsbCB8fCB0aGlzID09IHNpYmxpbmcuZ2V0UGFyZW50Tm9kZSgpO1xuICAgICAgICBpZiAoIXNpYmxpbmcpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmFwcGVuZENoaWxkKGNoaWxkKTtcbiAgICAgICAgfVxuICAgICAgICBjaGlsZC5kZXRhY2goKTtcbiAgICAgICAgY2hpbGQucGFyZW50Tm9kZSA9IHRoaXM7XG4gICAgICAgIGlmICh0aGlzLmZpcnN0Q2hpbGQgPT0gc2libGluZykge1xuICAgICAgICAgICAgY2hpbGQubmV4dFNpYmxpbmcgPSBzaWJsaW5nO1xuICAgICAgICAgICAgdGhpcy5maXJzdENoaWxkID0gY2hpbGQ7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB2YXIgcHJldiA9IHRoaXMuZmlyc3RDaGlsZDtcbiAgICAgICAgICAgIHZhciBuZXh0ID0gdGhpcy5maXJzdENoaWxkLm5leHRTaWJsaW5nO1xuICAgICAgICAgICAgd2hpbGUgKG5leHQgIT0gc2libGluZykge1xuICAgICAgICAgICAgICAgIHByZXYgPSBuZXh0O1xuICAgICAgICAgICAgICAgIG5leHQgPSBuZXh0Lm5leHRTaWJsaW5nO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcHJldi5uZXh0U2libGluZyA9IGNoaWxkO1xuICAgICAgICAgICAgY2hpbGQubmV4dFNpYmxpbmcgPSBuZXh0O1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBjaGlsZDtcbiAgICB9XG5cbiAgICBpbnNlcnRCZXR3ZWVuKGNoaWxkLCBwcmV2LCBuZXh0KSB7XG4gICAgICAgIC8vIGFzc2VydCBwcmV2ID09IG51bGwgfHwgdGhpcyA9PSBwcmV2LmdldFBhcmVudE5vZGUoKTtcbiAgICAgICAgLy8gYXNzZXJ0IG5leHQgPT0gbnVsbCB8fCB0aGlzID09IG5leHQuZ2V0UGFyZW50Tm9kZSgpO1xuICAgICAgICAvLyBhc3NlcnQgcHJldiAhPSBudWxsIHx8IG5leHQgPT0gZmlyc3RDaGlsZDtcbiAgICAgICAgLy8gYXNzZXJ0IG5leHQgIT0gbnVsbCB8fCBwcmV2ID09IGxhc3RDaGlsZDtcbiAgICAgICAgLy8gYXNzZXJ0IHByZXYgPT0gbnVsbCB8fCBuZXh0ID09IG51bGwgfHwgcHJldi5nZXROZXh0U2libGluZygpID09IG5leHQ7XG4gICAgICAgIGlmICghbmV4dCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuYXBwZW5kQ2hpbGQoY2hpbGQpO1xuICAgICAgICB9XG4gICAgICAgIGNoaWxkLmRldGFjaCgpO1xuICAgICAgICBjaGlsZC5wYXJlbnROb2RlID0gdGhpcztcbiAgICAgICAgY2hpbGQubmV4dFNpYmxpbmcgPSBuZXh0O1xuICAgICAgICBpZiAoIXByZXYpIHtcbiAgICAgICAgICAgIHRoaXMuZmlyc3RDaGlsZCA9IGNoaWxkO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcHJldi5uZXh0U2libGluZyA9IGNoaWxkO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBjaGlsZDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBBcHBlbmQgYSBjaGlsZCB0byB0aGlzIG5vZGUgYW5kIHJldHVybiB0aGUgY2hpbGQuXG4gICAgICogXG4gICAgICogQHBhcmFtIGNoaWxkIHRoZSBjaGlsZCB0byBhcHBlbmQuXG4gICAgICogQHJldHVybiA8Y29kZT5jaGlsZDwvY29kZT5cbiAgICAgKi9cbiAgICBhcHBlbmRDaGlsZChjaGlsZCkge1xuICAgICAgICBjaGlsZC5kZXRhY2goKTtcbiAgICAgICAgY2hpbGQucGFyZW50Tm9kZSA9IHRoaXM7XG4gICAgICAgIGlmICghdGhpcy5maXJzdENoaWxkKSB7XG4gICAgICAgICAgICB0aGlzLmZpcnN0Q2hpbGQgPSBjaGlsZDtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMubGFzdENoaWxkLm5leHRTaWJsaW5nID0gY2hpbGQ7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5sYXN0Q2hpbGQgPSBjaGlsZDtcbiAgICAgICAgcmV0dXJuIGNoaWxkO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEFwcGVuZCB0aGUgY2hpbGRyZW4gb2YgYW5vdGhlciBub2RlIHRvIHRoaXMgbm9kZSByZW1vdmluZyB0aGVtIGZyb20gdGhlIG90aGVyIG5vZGUgLlxuICAgICAqIEBwYXJhbSBwYXJlbnQgdGhlIG90aGVyIG5vZGUgd2hvc2UgY2hpbGRyZW4gdG8gYXBwZW5kIHRvIHRoaXMgb25lXG4gICAgICovXG4gICAgYXBwZW5kQ2hpbGRyZW4ocGFyZW50KSB7XG4gICAgICAgIHZhciBjaGlsZCA9IHBhcmVudC5maXJzdENoaWxkO1xuICAgICAgICBpZiAoIWNoaWxkKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGFub3RoZXIgPSBwYXJlbnQ7XG4gICAgICAgIGlmICghdGhpcy5maXJzdENoaWxkKSB7XG4gICAgICAgICAgICB0aGlzLmZpcnN0Q2hpbGQgPSBjaGlsZDtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMubGFzdENoaWxkLm5leHRTaWJsaW5nID0gY2hpbGQ7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5sYXN0Q2hpbGQgPSBhbm90aGVyLmxhc3RDaGlsZDtcbiAgICAgICAgZG8ge1xuICAgICAgICAgICAgY2hpbGQucGFyZW50Tm9kZSA9IHRoaXM7XG4gICAgICAgIH0gd2hpbGUgKChjaGlsZCA9IGNoaWxkLm5leHRTaWJsaW5nKSk7XG4gICAgICAgIGFub3RoZXIuZmlyc3RDaGlsZCA9IG51bGw7XG4gICAgICAgIGFub3RoZXIubGFzdENoaWxkID0gbnVsbDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBSZW1vdmUgYSBjaGlsZCBmcm9tIHRoaXMgbm9kZS5cbiAgICAgKiBAcGFyYW0gbm9kZSB0aGUgY2hpbGQgdG8gcmVtb3ZlXG4gICAgICovXG4gICAgcmVtb3ZlQ2hpbGQobm9kZSkge1xuICAgICAgICAvL2Fzc2VydCB0aGlzID09IG5vZGUuZ2V0UGFyZW50Tm9kZSgpO1xuICAgICAgICBpZiAodGhpcy5maXJzdENoaWxkID09IG5vZGUpIHtcbiAgICAgICAgICAgIHRoaXMuZmlyc3RDaGlsZCA9IG5vZGUubmV4dFNpYmxpbmc7XG4gICAgICAgICAgICBpZiAodGhpcy5sYXN0Q2hpbGQgPT0gbm9kZSkge1xuICAgICAgICAgICAgICAgIHRoaXMubGFzdENoaWxkID0gbnVsbDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHZhciBwcmV2ID0gdGhpcy5maXJzdENoaWxkO1xuICAgICAgICAgICAgdmFyIG5leHQgPSB0aGlzLmZpcnN0Q2hpbGQubmV4dFNpYmxpbmc7XG4gICAgICAgICAgICB3aGlsZSAobmV4dCAhPSBub2RlKSB7XG4gICAgICAgICAgICAgICAgcHJldiA9IG5leHQ7XG4gICAgICAgICAgICAgICAgbmV4dCA9IG5leHQubmV4dFNpYmxpbmc7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBwcmV2Lm5leHRTaWJsaW5nID0gbm9kZS5uZXh0U2libGluZztcbiAgICAgICAgICAgIGlmICh0aGlzLmxhc3RDaGlsZCA9PSBub2RlKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5sYXN0Q2hpbGQgPSBwcmV2O1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIG5vZGUucGFyZW50Tm9kZSA9IG51bGw7XG4gICAgICAgIHJldHVybiBub2RlO1xuICAgIH1cbiAgICBnZXQgZW5kTG9jYXRvcigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2VuZExvY2F0b3I7XG4gICAgfVxuICAgIHNldCBlbmRMb2NhdG9yKGVuZExvY2F0b3IpIHtcbiAgICAgICAgdGhpcy5fZW5kTG9jYXRvciA9IHtcbiAgICAgICAgICAgIGxpbmVOdW1iZXI6IGVuZExvY2F0b3IubGluZU51bWJlcixcbiAgICAgICAgICAgIGNvbHVtbk51bWJlcjogZW5kTG9jYXRvci5jb2x1bW5OdW1iZXJcbiAgICAgICAgfTtcbiAgICB9XG59XG4iXX0=