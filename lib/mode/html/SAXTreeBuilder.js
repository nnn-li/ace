import TreeBuilder from './TreeBuilder';
import Characters from './Characters';
import Comment from './Comment';
import Document from './Document';
import DTD from './DTD';
import Element from './Element';
import getAttribute from './getAttribute';
export default class SAXTreeBuilder extends TreeBuilder {
    constructor() {
        super();
    }
    start(tokenizer) {
        this.document = new Document(this.tokenizer);
    }
    end() {
        this.document.endLocator = this.tokenizer;
    }
    insertDoctype(name, publicId, systemId) {
        var doctype = new DTD(this.tokenizer, name, publicId, systemId);
        doctype.endLocator = this.tokenizer;
        this.document.appendChild(doctype);
    }
    createElement(namespaceURI, localName, attributes) {
        var element = new Element(this.tokenizer, namespaceURI, localName, localName, attributes || []);
        return element;
    }
    insertComment(data, parent) {
        if (!parent)
            parent = this.currentStackItem();
        var comment = new Comment(this.tokenizer, data);
        parent.appendChild(comment);
    }
    appendCharacters(parent, data) {
        var text = new Characters(this.tokenizer, data);
        parent.appendChild(text);
    }
    insertText(data) {
        if (this.redirectAttachToFosterParent && this.openElements.top.isFosterParenting()) {
            var tableIndex = this.openElements.findIndex('table');
            var tableItem = this.openElements.item(tableIndex);
            var table = tableItem.node;
            if (tableIndex === 0) {
                return this.appendCharacters(table, data);
            }
            var text = new Characters(this.tokenizer, data);
            var parent = table.parentNode;
            if (parent) {
                parent.insertBetween(text, table.previousSibling, table);
                return;
            }
            var stackParent = this.openElements.item(tableIndex - 1).node;
            stackParent.appendChild(text);
            return;
        }
        this.appendCharacters(this.currentStackItem().node, data);
    }
    attachNode(node, parent) {
        parent.appendChild(node);
    }
    attachNodeToFosterParent(child, table, stackParent) {
        var parent = table.parentNode;
        if (parent)
            parent.insertBetween(child, table.previousSibling, table);
        else
            stackParent.appendChild(child);
    }
    detachFromParent(element) {
        element.detach();
    }
    reparentChildren(oldParent, newParent) {
        newParent.appendChildren(oldParent.firstChild);
    }
    getFragment() {
        var fragment = new DocumentFragment();
        this.reparentChildren(this.openElements.rootNode, fragment);
        return fragment;
    }
    addAttributesToElement(element, attributes) {
        for (var i = 0; i < attributes.length; i++) {
            var attribute = attributes[i];
            if (!getAttribute(element, attribute.nodeName))
                element.attributes.push(attribute);
        }
    }
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiU0FYVHJlZUJ1aWxkZXIuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi9zcmMvbW9kZS9odG1sL1NBWFRyZWVCdWlsZGVyLnRzIl0sIm5hbWVzIjpbIlNBWFRyZWVCdWlsZGVyIiwiU0FYVHJlZUJ1aWxkZXIuY29uc3RydWN0b3IiLCJTQVhUcmVlQnVpbGRlci5zdGFydCIsIlNBWFRyZWVCdWlsZGVyLmVuZCIsIlNBWFRyZWVCdWlsZGVyLmluc2VydERvY3R5cGUiLCJTQVhUcmVlQnVpbGRlci5jcmVhdGVFbGVtZW50IiwiU0FYVHJlZUJ1aWxkZXIuaW5zZXJ0Q29tbWVudCIsIlNBWFRyZWVCdWlsZGVyLmFwcGVuZENoYXJhY3RlcnMiLCJTQVhUcmVlQnVpbGRlci5pbnNlcnRUZXh0IiwiU0FYVHJlZUJ1aWxkZXIuYXR0YWNoTm9kZSIsIlNBWFRyZWVCdWlsZGVyLmF0dGFjaE5vZGVUb0Zvc3RlclBhcmVudCIsIlNBWFRyZWVCdWlsZGVyLmRldGFjaEZyb21QYXJlbnQiLCJTQVhUcmVlQnVpbGRlci5yZXBhcmVudENoaWxkcmVuIiwiU0FYVHJlZUJ1aWxkZXIuZ2V0RnJhZ21lbnQiLCJTQVhUcmVlQnVpbGRlci5hZGRBdHRyaWJ1dGVzVG9FbGVtZW50Il0sIm1hcHBpbmdzIjoiT0FBTyxXQUFXLE1BQU0sZUFBZTtPQUNoQyxVQUFVLE1BQU0sY0FBYztPQUM5QixPQUFPLE1BQU0sV0FBVztPQUN4QixRQUFRLE1BQU0sWUFBWTtPQUMxQixHQUFHLE1BQU0sT0FBTztPQUNoQixPQUFPLE1BQU0sV0FBVztPQUN4QixZQUFZLE1BQU0sZ0JBQWdCO0FBRXpDLDRDQUE0QyxXQUFXO0lBQ25EQTtRQUNJQyxPQUFPQSxDQUFDQTtJQUNaQSxDQUFDQTtJQUVERCxLQUFLQSxDQUFDQSxTQUFTQTtRQUNYRSxJQUFJQSxDQUFDQSxRQUFRQSxHQUFHQSxJQUFJQSxRQUFRQSxDQUFDQSxJQUFJQSxDQUFDQSxTQUFTQSxDQUFDQSxDQUFDQTtJQUNqREEsQ0FBQ0E7SUFFREYsR0FBR0E7UUFDQ0csSUFBSUEsQ0FBQ0EsUUFBUUEsQ0FBQ0EsVUFBVUEsR0FBR0EsSUFBSUEsQ0FBQ0EsU0FBU0EsQ0FBQ0E7SUFDOUNBLENBQUNBO0lBRURILGFBQWFBLENBQUNBLElBQUlBLEVBQUVBLFFBQVFBLEVBQUVBLFFBQVFBO1FBQ2xDSSxJQUFJQSxPQUFPQSxHQUFHQSxJQUFJQSxHQUFHQSxDQUFDQSxJQUFJQSxDQUFDQSxTQUFTQSxFQUFFQSxJQUFJQSxFQUFFQSxRQUFRQSxFQUFFQSxRQUFRQSxDQUFDQSxDQUFDQTtRQUNoRUEsT0FBT0EsQ0FBQ0EsVUFBVUEsR0FBR0EsSUFBSUEsQ0FBQ0EsU0FBU0EsQ0FBQ0E7UUFDcENBLElBQUlBLENBQUNBLFFBQVFBLENBQUNBLFdBQVdBLENBQUNBLE9BQU9BLENBQUNBLENBQUNBO0lBQ3ZDQSxDQUFDQTtJQUVESixhQUFhQSxDQUFDQSxZQUFZQSxFQUFFQSxTQUFTQSxFQUFFQSxVQUFVQTtRQUM3Q0ssSUFBSUEsT0FBT0EsR0FBR0EsSUFBSUEsT0FBT0EsQ0FBQ0EsSUFBSUEsQ0FBQ0EsU0FBU0EsRUFBRUEsWUFBWUEsRUFBRUEsU0FBU0EsRUFBRUEsU0FBU0EsRUFBRUEsVUFBVUEsSUFBSUEsRUFBRUEsQ0FBQ0EsQ0FBQ0E7UUFDaEdBLE1BQU1BLENBQUNBLE9BQU9BLENBQUNBO0lBQ25CQSxDQUFDQTtJQUVETCxhQUFhQSxDQUFDQSxJQUFJQSxFQUFFQSxNQUFNQTtRQUN0Qk0sRUFBRUEsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsTUFBTUEsQ0FBQ0E7WUFDUkEsTUFBTUEsR0FBR0EsSUFBSUEsQ0FBQ0EsZ0JBQWdCQSxFQUFFQSxDQUFDQTtRQUNyQ0EsSUFBSUEsT0FBT0EsR0FBR0EsSUFBSUEsT0FBT0EsQ0FBQ0EsSUFBSUEsQ0FBQ0EsU0FBU0EsRUFBRUEsSUFBSUEsQ0FBQ0EsQ0FBQ0E7UUFDaERBLE1BQU1BLENBQUNBLFdBQVdBLENBQUNBLE9BQU9BLENBQUNBLENBQUNBO0lBQ2hDQSxDQUFDQTtJQUVETixnQkFBZ0JBLENBQUNBLE1BQU1BLEVBQUVBLElBQUlBO1FBQ3pCTyxJQUFJQSxJQUFJQSxHQUFHQSxJQUFJQSxVQUFVQSxDQUFDQSxJQUFJQSxDQUFDQSxTQUFTQSxFQUFFQSxJQUFJQSxDQUFDQSxDQUFDQTtRQUNoREEsTUFBTUEsQ0FBQ0EsV0FBV0EsQ0FBQ0EsSUFBSUEsQ0FBQ0EsQ0FBQ0E7SUFDN0JBLENBQUNBO0lBRURQLFVBQVVBLENBQUNBLElBQUlBO1FBQ1hRLEVBQUVBLENBQUNBLENBQUNBLElBQUlBLENBQUNBLDRCQUE0QkEsSUFBSUEsSUFBSUEsQ0FBQ0EsWUFBWUEsQ0FBQ0EsR0FBR0EsQ0FBQ0EsaUJBQWlCQSxFQUFFQSxDQUFDQSxDQUFDQSxDQUFDQTtZQUNqRkEsSUFBSUEsVUFBVUEsR0FBR0EsSUFBSUEsQ0FBQ0EsWUFBWUEsQ0FBQ0EsU0FBU0EsQ0FBQ0EsT0FBT0EsQ0FBQ0EsQ0FBQ0E7WUFDdERBLElBQUlBLFNBQVNBLEdBQUdBLElBQUlBLENBQUNBLFlBQVlBLENBQUNBLElBQUlBLENBQUNBLFVBQVVBLENBQUNBLENBQUNBO1lBQ25EQSxJQUFJQSxLQUFLQSxHQUFHQSxTQUFTQSxDQUFDQSxJQUFJQSxDQUFDQTtZQUMzQkEsRUFBRUEsQ0FBQ0EsQ0FBQ0EsVUFBVUEsS0FBS0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0E7Z0JBQ25CQSxNQUFNQSxDQUFDQSxJQUFJQSxDQUFDQSxnQkFBZ0JBLENBQUNBLEtBQUtBLEVBQUVBLElBQUlBLENBQUNBLENBQUNBO1lBQzlDQSxDQUFDQTtZQUNEQSxJQUFJQSxJQUFJQSxHQUFHQSxJQUFJQSxVQUFVQSxDQUFDQSxJQUFJQSxDQUFDQSxTQUFTQSxFQUFFQSxJQUFJQSxDQUFDQSxDQUFDQTtZQUNoREEsSUFBSUEsTUFBTUEsR0FBR0EsS0FBS0EsQ0FBQ0EsVUFBVUEsQ0FBQ0E7WUFDOUJBLEVBQUVBLENBQUNBLENBQUNBLE1BQU1BLENBQUNBLENBQUNBLENBQUNBO2dCQUNUQSxNQUFNQSxDQUFDQSxhQUFhQSxDQUFDQSxJQUFJQSxFQUFFQSxLQUFLQSxDQUFDQSxlQUFlQSxFQUFFQSxLQUFLQSxDQUFDQSxDQUFDQTtnQkFDekRBLE1BQU1BLENBQUNBO1lBQ1hBLENBQUNBO1lBQ0RBLElBQUlBLFdBQVdBLEdBQUdBLElBQUlBLENBQUNBLFlBQVlBLENBQUNBLElBQUlBLENBQUNBLFVBQVVBLEdBQUdBLENBQUNBLENBQUNBLENBQUNBLElBQUlBLENBQUNBO1lBQzlEQSxXQUFXQSxDQUFDQSxXQUFXQSxDQUFDQSxJQUFJQSxDQUFDQSxDQUFDQTtZQUM5QkEsTUFBTUEsQ0FBQ0E7UUFDWEEsQ0FBQ0E7UUFDREEsSUFBSUEsQ0FBQ0EsZ0JBQWdCQSxDQUFDQSxJQUFJQSxDQUFDQSxnQkFBZ0JBLEVBQUVBLENBQUNBLElBQUlBLEVBQUVBLElBQUlBLENBQUNBLENBQUNBO0lBQzlEQSxDQUFDQTtJQUVEUixVQUFVQSxDQUFDQSxJQUFJQSxFQUFFQSxNQUFNQTtRQUNuQlMsTUFBTUEsQ0FBQ0EsV0FBV0EsQ0FBQ0EsSUFBSUEsQ0FBQ0EsQ0FBQ0E7SUFDN0JBLENBQUNBO0lBRURULHdCQUF3QkEsQ0FBQ0EsS0FBS0EsRUFBRUEsS0FBS0EsRUFBRUEsV0FBV0E7UUFDOUNVLElBQUlBLE1BQU1BLEdBQUdBLEtBQUtBLENBQUNBLFVBQVVBLENBQUNBO1FBQzlCQSxFQUFFQSxDQUFDQSxDQUFDQSxNQUFNQSxDQUFDQTtZQUNQQSxNQUFNQSxDQUFDQSxhQUFhQSxDQUFDQSxLQUFLQSxFQUFFQSxLQUFLQSxDQUFDQSxlQUFlQSxFQUFFQSxLQUFLQSxDQUFDQSxDQUFDQTtRQUM5REEsSUFBSUE7WUFDQUEsV0FBV0EsQ0FBQ0EsV0FBV0EsQ0FBQ0EsS0FBS0EsQ0FBQ0EsQ0FBQ0E7SUFDdkNBLENBQUNBO0lBRURWLGdCQUFnQkEsQ0FBQ0EsT0FBT0E7UUFDcEJXLE9BQU9BLENBQUNBLE1BQU1BLEVBQUVBLENBQUNBO0lBQ3JCQSxDQUFDQTtJQUVEWCxnQkFBZ0JBLENBQUNBLFNBQVNBLEVBQUVBLFNBQVNBO1FBQ2pDWSxTQUFTQSxDQUFDQSxjQUFjQSxDQUFDQSxTQUFTQSxDQUFDQSxVQUFVQSxDQUFDQSxDQUFDQTtJQUNuREEsQ0FBQ0E7SUFFRFosV0FBV0E7UUFDUGEsSUFBSUEsUUFBUUEsR0FBR0EsSUFBSUEsZ0JBQWdCQSxFQUFFQSxDQUFDQTtRQUN0Q0EsSUFBSUEsQ0FBQ0EsZ0JBQWdCQSxDQUFDQSxJQUFJQSxDQUFDQSxZQUFZQSxDQUFDQSxRQUFRQSxFQUFFQSxRQUFRQSxDQUFDQSxDQUFDQTtRQUM1REEsTUFBTUEsQ0FBQ0EsUUFBUUEsQ0FBQ0E7SUFDcEJBLENBQUNBO0lBRURiLHNCQUFzQkEsQ0FBQ0EsT0FBT0EsRUFBRUEsVUFBVUE7UUFDdENjLEdBQUdBLENBQUNBLENBQUNBLEdBQUdBLENBQUNBLENBQUNBLEdBQUdBLENBQUNBLEVBQUVBLENBQUNBLEdBQUdBLFVBQVVBLENBQUNBLE1BQU1BLEVBQUVBLENBQUNBLEVBQUVBLEVBQUVBLENBQUNBO1lBQ3pDQSxJQUFJQSxTQUFTQSxHQUFHQSxVQUFVQSxDQUFDQSxDQUFDQSxDQUFDQSxDQUFDQTtZQUM5QkEsRUFBRUEsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsWUFBWUEsQ0FBQ0EsT0FBT0EsRUFBRUEsU0FBU0EsQ0FBQ0EsUUFBUUEsQ0FBQ0EsQ0FBQ0E7Z0JBQzNDQSxPQUFPQSxDQUFDQSxVQUFVQSxDQUFDQSxJQUFJQSxDQUFDQSxTQUFTQSxDQUFDQSxDQUFDQTtRQUMzQ0EsQ0FBQ0E7SUFDTEEsQ0FBQ0E7QUFDTGQsQ0FBQ0E7QUFBQSIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBUcmVlQnVpbGRlciBmcm9tICcuL1RyZWVCdWlsZGVyJztcbmltcG9ydCBDaGFyYWN0ZXJzIGZyb20gJy4vQ2hhcmFjdGVycyc7XG5pbXBvcnQgQ29tbWVudCBmcm9tICcuL0NvbW1lbnQnO1xuaW1wb3J0IERvY3VtZW50IGZyb20gJy4vRG9jdW1lbnQnO1xuaW1wb3J0IERURCBmcm9tICcuL0RURCc7XG5pbXBvcnQgRWxlbWVudCBmcm9tICcuL0VsZW1lbnQnO1xuaW1wb3J0IGdldEF0dHJpYnV0ZSBmcm9tICcuL2dldEF0dHJpYnV0ZSc7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFNBWFRyZWVCdWlsZGVyIGV4dGVuZHMgVHJlZUJ1aWxkZXIge1xuICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICBzdXBlcigpO1xuICAgIH1cblxuICAgIHN0YXJ0KHRva2VuaXplcikge1xuICAgICAgICB0aGlzLmRvY3VtZW50ID0gbmV3IERvY3VtZW50KHRoaXMudG9rZW5pemVyKTtcbiAgICB9XG5cbiAgICBlbmQoKSB7XG4gICAgICAgIHRoaXMuZG9jdW1lbnQuZW5kTG9jYXRvciA9IHRoaXMudG9rZW5pemVyO1xuICAgIH1cblxuICAgIGluc2VydERvY3R5cGUobmFtZSwgcHVibGljSWQsIHN5c3RlbUlkKSB7XG4gICAgICAgIHZhciBkb2N0eXBlID0gbmV3IERURCh0aGlzLnRva2VuaXplciwgbmFtZSwgcHVibGljSWQsIHN5c3RlbUlkKTtcbiAgICAgICAgZG9jdHlwZS5lbmRMb2NhdG9yID0gdGhpcy50b2tlbml6ZXI7XG4gICAgICAgIHRoaXMuZG9jdW1lbnQuYXBwZW5kQ2hpbGQoZG9jdHlwZSk7XG4gICAgfVxuXG4gICAgY3JlYXRlRWxlbWVudChuYW1lc3BhY2VVUkksIGxvY2FsTmFtZSwgYXR0cmlidXRlcykge1xuICAgICAgICB2YXIgZWxlbWVudCA9IG5ldyBFbGVtZW50KHRoaXMudG9rZW5pemVyLCBuYW1lc3BhY2VVUkksIGxvY2FsTmFtZSwgbG9jYWxOYW1lLCBhdHRyaWJ1dGVzIHx8IFtdKTtcbiAgICAgICAgcmV0dXJuIGVsZW1lbnQ7XG4gICAgfVxuXG4gICAgaW5zZXJ0Q29tbWVudChkYXRhLCBwYXJlbnQpIHtcbiAgICAgICAgaWYgKCFwYXJlbnQpXG4gICAgICAgICAgICBwYXJlbnQgPSB0aGlzLmN1cnJlbnRTdGFja0l0ZW0oKTtcbiAgICAgICAgdmFyIGNvbW1lbnQgPSBuZXcgQ29tbWVudCh0aGlzLnRva2VuaXplciwgZGF0YSk7XG4gICAgICAgIHBhcmVudC5hcHBlbmRDaGlsZChjb21tZW50KTtcbiAgICB9XG5cbiAgICBhcHBlbmRDaGFyYWN0ZXJzKHBhcmVudCwgZGF0YSkge1xuICAgICAgICB2YXIgdGV4dCA9IG5ldyBDaGFyYWN0ZXJzKHRoaXMudG9rZW5pemVyLCBkYXRhKTtcbiAgICAgICAgcGFyZW50LmFwcGVuZENoaWxkKHRleHQpO1xuICAgIH1cblxuICAgIGluc2VydFRleHQoZGF0YSkge1xuICAgICAgICBpZiAodGhpcy5yZWRpcmVjdEF0dGFjaFRvRm9zdGVyUGFyZW50ICYmIHRoaXMub3BlbkVsZW1lbnRzLnRvcC5pc0Zvc3RlclBhcmVudGluZygpKSB7XG4gICAgICAgICAgICB2YXIgdGFibGVJbmRleCA9IHRoaXMub3BlbkVsZW1lbnRzLmZpbmRJbmRleCgndGFibGUnKTtcbiAgICAgICAgICAgIHZhciB0YWJsZUl0ZW0gPSB0aGlzLm9wZW5FbGVtZW50cy5pdGVtKHRhYmxlSW5kZXgpO1xuICAgICAgICAgICAgdmFyIHRhYmxlID0gdGFibGVJdGVtLm5vZGU7XG4gICAgICAgICAgICBpZiAodGFibGVJbmRleCA9PT0gMCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmFwcGVuZENoYXJhY3RlcnModGFibGUsIGRhdGEpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIHRleHQgPSBuZXcgQ2hhcmFjdGVycyh0aGlzLnRva2VuaXplciwgZGF0YSk7XG4gICAgICAgICAgICB2YXIgcGFyZW50ID0gdGFibGUucGFyZW50Tm9kZTtcbiAgICAgICAgICAgIGlmIChwYXJlbnQpIHtcbiAgICAgICAgICAgICAgICBwYXJlbnQuaW5zZXJ0QmV0d2Vlbih0ZXh0LCB0YWJsZS5wcmV2aW91c1NpYmxpbmcsIHRhYmxlKTtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgc3RhY2tQYXJlbnQgPSB0aGlzLm9wZW5FbGVtZW50cy5pdGVtKHRhYmxlSW5kZXggLSAxKS5ub2RlO1xuICAgICAgICAgICAgc3RhY2tQYXJlbnQuYXBwZW5kQ2hpbGQodGV4dCk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5hcHBlbmRDaGFyYWN0ZXJzKHRoaXMuY3VycmVudFN0YWNrSXRlbSgpLm5vZGUsIGRhdGEpO1xuICAgIH1cblxuICAgIGF0dGFjaE5vZGUobm9kZSwgcGFyZW50KSB7XG4gICAgICAgIHBhcmVudC5hcHBlbmRDaGlsZChub2RlKTtcbiAgICB9XG5cbiAgICBhdHRhY2hOb2RlVG9Gb3N0ZXJQYXJlbnQoY2hpbGQsIHRhYmxlLCBzdGFja1BhcmVudCkge1xuICAgICAgICB2YXIgcGFyZW50ID0gdGFibGUucGFyZW50Tm9kZTtcbiAgICAgICAgaWYgKHBhcmVudClcbiAgICAgICAgICAgIHBhcmVudC5pbnNlcnRCZXR3ZWVuKGNoaWxkLCB0YWJsZS5wcmV2aW91c1NpYmxpbmcsIHRhYmxlKTtcbiAgICAgICAgZWxzZVxuICAgICAgICAgICAgc3RhY2tQYXJlbnQuYXBwZW5kQ2hpbGQoY2hpbGQpO1xuICAgIH1cblxuICAgIGRldGFjaEZyb21QYXJlbnQoZWxlbWVudCkge1xuICAgICAgICBlbGVtZW50LmRldGFjaCgpO1xuICAgIH1cblxuICAgIHJlcGFyZW50Q2hpbGRyZW4ob2xkUGFyZW50LCBuZXdQYXJlbnQpIHtcbiAgICAgICAgbmV3UGFyZW50LmFwcGVuZENoaWxkcmVuKG9sZFBhcmVudC5maXJzdENoaWxkKTtcbiAgICB9XG5cbiAgICBnZXRGcmFnbWVudCgpIHtcbiAgICAgICAgdmFyIGZyYWdtZW50ID0gbmV3IERvY3VtZW50RnJhZ21lbnQoKTtcbiAgICAgICAgdGhpcy5yZXBhcmVudENoaWxkcmVuKHRoaXMub3BlbkVsZW1lbnRzLnJvb3ROb2RlLCBmcmFnbWVudCk7XG4gICAgICAgIHJldHVybiBmcmFnbWVudDtcbiAgICB9XG5cbiAgICBhZGRBdHRyaWJ1dGVzVG9FbGVtZW50KGVsZW1lbnQsIGF0dHJpYnV0ZXMpIHtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBhdHRyaWJ1dGVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgYXR0cmlidXRlID0gYXR0cmlidXRlc1tpXTtcbiAgICAgICAgICAgIGlmICghZ2V0QXR0cmlidXRlKGVsZW1lbnQsIGF0dHJpYnV0ZS5ub2RlTmFtZSkpXG4gICAgICAgICAgICAgICAgZWxlbWVudC5hdHRyaWJ1dGVzLnB1c2goYXR0cmlidXRlKTtcbiAgICAgICAgfVxuICAgIH1cbn1cbiJdfQ==