export var comparePoints = function (p1, p2) {
    return p1.row - p2.row || p1.column - p2.column;
};
export class Range {
    constructor(startRow, startColumn, endRow, endColumn) {
        this.start = {
            row: startRow,
            column: startColumn
        };
        this.end = {
            row: endRow,
            column: endColumn
        };
    }
    isEqual(range) {
        return this.start.row === range.start.row &&
            this.end.row === range.end.row &&
            this.start.column === range.start.column &&
            this.end.column === range.end.column;
    }
    toString() {
        return ("Range: [" + this.start.row + "/" + this.start.column +
            "] -> [" + this.end.row + "/" + this.end.column + "]");
    }
    contains(row, column) {
        return this.compare(row, column) === 0;
    }
    compareRange(range) {
        var cmp;
        var end = range.end;
        var start = range.start;
        cmp = this.compare(end.row, end.column);
        if (cmp === 1) {
            cmp = this.compare(start.row, start.column);
            if (cmp === 1) {
                return 2;
            }
            else if (cmp === 0) {
                return 1;
            }
            else {
                return 0;
            }
        }
        else if (cmp === -1) {
            return -2;
        }
        else {
            cmp = this.compare(start.row, start.column);
            if (cmp === -1) {
                return -1;
            }
            else if (cmp === 1) {
                return 42;
            }
            else {
                return 0;
            }
        }
    }
    comparePoint(p) {
        return this.compare(p.row, p.column);
    }
    containsRange(range) {
        return this.comparePoint(range.start) === 0 && this.comparePoint(range.end) === 0;
    }
    intersects(range) {
        var cmp = this.compareRange(range);
        return (cmp === -1 || cmp === 0 || cmp === 1);
    }
    isEnd(row, column) {
        return this.end.row === row && this.end.column === column;
    }
    isStart(row, column) {
        return this.start.row === row && this.start.column === column;
    }
    setStart(row, column) {
        if (typeof row === "object") {
            this.start.column = row['column'];
            this.start.row = row['row'];
        }
        else {
            this.start.row = row;
            this.start.column = column;
        }
    }
    setEnd(row, column) {
        if (typeof row === "object") {
            this.end.column = row['column'];
            this.end.row = row['row'];
        }
        else {
            this.end.row = row;
            this.end.column = column;
        }
    }
    inside(row, column) {
        if (this.compare(row, column) === 0) {
            if (this.isEnd(row, column) || this.isStart(row, column)) {
                return false;
            }
            else {
                return true;
            }
        }
        return false;
    }
    insideStart(row, column) {
        if (this.compare(row, column) === 0) {
            if (this.isEnd(row, column)) {
                return false;
            }
            else {
                return true;
            }
        }
        return false;
    }
    insideEnd(row, column) {
        if (this.compare(row, column) === 0) {
            if (this.isStart(row, column)) {
                return false;
            }
            else {
                return true;
            }
        }
        return false;
    }
    compare(row, column) {
        if (!this.isMultiLine()) {
            if (row === this.start.row) {
                return column < this.start.column ? -1 : (column > this.end.column ? 1 : 0);
            }
        }
        if (row < this.start.row)
            return -1;
        if (row > this.end.row)
            return 1;
        if (this.start.row === row)
            return column >= this.start.column ? 0 : -1;
        if (this.end.row === row)
            return column <= this.end.column ? 0 : 1;
        return 0;
    }
    compareStart(row, column) {
        if (this.start.row === row && this.start.column === column) {
            return -1;
        }
        else {
            return this.compare(row, column);
        }
    }
    compareEnd(row, column) {
        if (this.end.row === row && this.end.column === column) {
            return 1;
        }
        else {
            return this.compare(row, column);
        }
    }
    compareInside(row, column) {
        if (this.end.row === row && this.end.column === column) {
            return 1;
        }
        else if (this.start.row === row && this.start.column === column) {
            return -1;
        }
        else {
            return this.compare(row, column);
        }
    }
    clipRows(firstRow, lastRow) {
        var start;
        var end;
        if (this.end.row > lastRow)
            end = { row: lastRow + 1, column: 0 };
        else if (this.end.row < firstRow)
            end = { row: firstRow, column: 0 };
        if (this.start.row > lastRow)
            start = { row: lastRow + 1, column: 0 };
        else if (this.start.row < firstRow)
            start = { row: firstRow, column: 0 };
        return Range.fromPoints(start || this.start, end || this.end);
    }
    extend(row, column) {
        var cmp = this.compare(row, column);
        if (cmp === 0) {
            return this;
        }
        else if (cmp === -1) {
            var start = { row: row, column: column };
        }
        else {
            var end = { row: row, column: column };
        }
        return Range.fromPoints(start || this.start, end || this.end);
    }
    isEmpty() {
        return (this.start.row === this.end.row && this.start.column === this.end.column);
    }
    isMultiLine() {
        return (this.start.row !== this.end.row);
    }
    clone() {
        return Range.fromPoints(this.start, this.end);
    }
    collapseRows() {
        if (this.end.column === 0)
            return new Range(this.start.row, 0, Math.max(this.start.row, this.end.row - 1), 0);
        else
            return new Range(this.start.row, 0, this.end.row, 0);
    }
    moveBy(row, column) {
        this.start.row += row;
        this.start.column += column;
        this.end.row += row;
        this.end.column += column;
    }
    static fromPoints(start, end) {
        return new Range(start.row, start.column, end.row, end.column);
    }
    static comparePoints(p1, p2) {
        return p1.row - p2.row || p1.column - p2.column;
    }
}
export class OrientedRange extends Range {
    constructor(startRow, startColumn, endRow, endColumn, cursor, desiredColumn) {
        super(startRow, startColumn, endRow, endColumn);
        this.cursor = cursor;
        this.desiredColumn = desiredColumn;
    }
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicmFuZ2UuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi9zcmMvcmFuZ2UudHMiXSwibmFtZXMiOlsiUmFuZ2UiLCJSYW5nZS5jb25zdHJ1Y3RvciIsIlJhbmdlLmlzRXF1YWwiLCJSYW5nZS50b1N0cmluZyIsIlJhbmdlLmNvbnRhaW5zIiwiUmFuZ2UuY29tcGFyZVJhbmdlIiwiUmFuZ2UuY29tcGFyZVBvaW50IiwiUmFuZ2UuY29udGFpbnNSYW5nZSIsIlJhbmdlLmludGVyc2VjdHMiLCJSYW5nZS5pc0VuZCIsIlJhbmdlLmlzU3RhcnQiLCJSYW5nZS5zZXRTdGFydCIsIlJhbmdlLnNldEVuZCIsIlJhbmdlLmluc2lkZSIsIlJhbmdlLmluc2lkZVN0YXJ0IiwiUmFuZ2UuaW5zaWRlRW5kIiwiUmFuZ2UuY29tcGFyZSIsIlJhbmdlLmNvbXBhcmVTdGFydCIsIlJhbmdlLmNvbXBhcmVFbmQiLCJSYW5nZS5jb21wYXJlSW5zaWRlIiwiUmFuZ2UuY2xpcFJvd3MiLCJSYW5nZS5leHRlbmQiLCJSYW5nZS5pc0VtcHR5IiwiUmFuZ2UuaXNNdWx0aUxpbmUiLCJSYW5nZS5jbG9uZSIsIlJhbmdlLmNvbGxhcHNlUm93cyIsIlJhbmdlLm1vdmVCeSIsIlJhbmdlLmZyb21Qb2ludHMiLCJSYW5nZS5jb21wYXJlUG9pbnRzIiwiT3JpZW50ZWRSYW5nZSIsIk9yaWVudGVkUmFuZ2UuY29uc3RydWN0b3IiXSwibWFwcGluZ3MiOiJBQTZCQSxXQUFXLGFBQWEsR0FBRyxVQUFTLEVBQW1DLEVBQUUsRUFBbUM7SUFDeEcsTUFBTSxDQUFDLEVBQUUsQ0FBQyxHQUFHLEdBQUcsRUFBRSxDQUFDLEdBQUcsSUFBSSxFQUFFLENBQUMsTUFBTSxHQUFHLEVBQUUsQ0FBQyxNQUFNLENBQUM7QUFDcEQsQ0FBQyxDQUFDO0FBZUY7SUFTSUEsWUFBWUEsUUFBZ0JBLEVBQUVBLFdBQW1CQSxFQUFFQSxNQUFjQSxFQUFFQSxTQUFpQkE7UUFDaEZDLElBQUlBLENBQUNBLEtBQUtBLEdB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Q0E7SUFDbERBLENBQUNBO0lBU0RSLEtBQUtBLENBQUNBLEdBQVdBLEVBQUVBLE1BQWNBO1FBQzdCUyxNQUFNQSxDQUFDQSxJQUFJQSxDQUFDQSxHQUFHQSxDQUFDQSxHQUFHQSxLQUFLQSxHQUFHQSxJQUFJQSxJQUFJQSxDQUFDQSxHQUFHQSxDQUFDQSxNQUFNQSxLQUFLQSxNQUFNQSxDQUFDQTtJQUM5REEsQ0FBQ0E7SUFTRFQsT0FBT0EsQ0FBQ0EsR0FBV0EsRUFBRUEsTUFBY0E7UUFDL0JVLE1BQU1BLENBQUNBLElBQUlBLENBQUNBLEtBQUtBLENBQUNBLEdBQUdBLEtBQUtBLEdBQUdBLElBQUlBLElBQUlBLENBQUNBLEtBQUtBLENBQUNBLE1BQU1BLEtBQUtBLE1BQU1BLENBQUNBO0lBQ2xFQSxDQUFDQTtJQVFEVixRQUFRQSxDQUFDQSxHQUFXQSxFQUFFQSxNQUFjQTtRQUNoQ1csRUFBRUEsQ0FBQ0EsQ0FBQ0EsT0FBT0EsR0FBR0EsS0FBS0EsUUFBUUEsQ0FBQ0EsQ0FBQ0EsQ0FBQ0E7WUFFMUJBLElBQUlBLENBQUNBLEtBQUtBLENBQUNBLE1BQU1BLEdBQUdBLEdBQUdBLENBQUNBLFFBQVFBLENBQUNBLENBQUNBO1lBQ2xDQSxJQUFJQSxDQUFDQSxLQUFLQSxDQUFDQSxHQUFHQSxHQUFHQSxHQUFHQSxDQUFDQSxLQUFLQSxDQUFDQSxDQUFDQTtRQUNoQ0EsQ0FBQ0E7UUFDREEsSUFBSUEsQ0FBQ0EsQ0FBQ0E7WUFDRkEsSUFBSUEsQ0FBQ0EsS0FBS0EsQ0FBQ0EsR0FBR0EsR0FBR0EsR0FBR0EsQ0FBQ0E7WUFDckJBLElBQUlBLENBQUNBLEtBQUtBLENBQUNBLE1BQU1BLEdBQUdBLE1BQU1BLENBQUNBO1FBQy9CQSxDQUFDQTtJQUNMQSxDQUFDQTtJQVFEWCxNQUFNQSxDQUFDQSxHQUFXQSxFQUFFQSxNQUFjQTtRQUM5QlksRUFBRUEsQ0FBQ0EsQ0FBQ0EsT0FBT0EsR0FBR0EsS0FBS0EsUUFBUUEsQ0FBQ0EsQ0FBQ0EsQ0FBQ0E7WUFFMUJBLElBQUlBLENBQUNBLEdBQUdBLENBQUNBLE1B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LENBQUNBLEtBQUtBLElBQUlBLElBQUlBLENBQUNBLEtBQUtBLEVBQUVBLEdBQUdBLElBQUlBLElBQUlBLENBQUNBLEdBQUdBLENBQUNBLENBQUNBO0lBQ2xFQSxDQUFDQTtJQVFEcEIsTUFBTUEsQ0FBQ0EsR0FBV0EsRUFBRUEsTUFBY0E7UUFDOUJxQixJQUFJQSxHQUFHQSxHQUFHQSxJQUFJQSxDQUFDQSxPQUFPQSxDQUFDQSxHQUFHQSxFQUFFQSxNQUFNQSxDQUFDQSxDQUFDQTtRQUVwQ0EsRUFBRUEsQ0FBQ0EsQ0FBQ0EsR0FBR0EsS0FBS0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0E7WUFDWkEsTUFBTUEsQ0FBQ0EsSUFBSUEsQ0FBQ0E7UUFDaEJBLENBQUNBO1FBQ0RBLElBQUlBLENBQUNBLEVBQUVBLENBQUNBLENBQUNBLEdBQUdBLEtBQUtBLENBQUNBLENBQUNBLENBQUNBLENBQUNBLENBQUNBO1lBQ2xCQSxJQUFJQSxLQUFLQSxHQUFHQSxFQUFFQSxHQUFHQSxFQUFFQSxHQUFHQSxFQUFFQSxNQUFNQSxFQUFFQSxNQUFNQSxFQUFFQSxDQUFDQTtRQUM3Q0EsQ0FBQ0E7UUFDREEsSUFBSUEsQ0FBQ0EsQ0FBQ0E7WUFDRkEsSUFBSUEsR0FBR0EsR0FBR0EsRUFBRUEsR0FBR0EsRUFBRUEsR0FBR0EsRUFBRUEsTUFBTUEsRUFBRUEsTUFBTUEsRUFBRUEsQ0FBQ0E7UUFDM0NBLENBQUNBO1FBQ0RBLE1BQU1BLENBQUNBLEtBQUtBLENBQUNBLFVBQVVBLENBQUNBLEtBQUtBLElBQUlBLElBQUlBLENBQUNBLEtBQUtBLEVBQUVBLEdBQUdBLElBQUlBLElBQUlBLENBQUNBLEdBQUdBLENBQUNBLENBQUNBO0lBQ2xFQSxDQUFDQTtJQUVEckIsT0FBT0E7UUFDSHNCLE1BQU1BLENBQUNBLENBQUNBLElBQUlBLENBQUNBLEtBQUtBLENBQUNBLEdBQUdBLEtBQUtBLElBQUlBLENBQUNBLEdBQUdBLENBQUNBLEdBQUdBLElBQUlBLElBQUlBLENBQUNBLEtBQUtBLENBQUNBLE1BQU1BLEtBQUtBLElBQUlBLENBQUNBLEdBQUdBLENBQUNBLE1BQU1BLENBQUNBLENBQUNBO0lBQ3RGQSxDQUFDQTtJQU9EdEIsV0FBV0E7UUFDUHVCLE1BQU1BLENBQUNBLENBQUNBLElBQUlBLENBQUNBLEtBQUtBLENBQUNBLEdBQUdBLEtBQUtBLElBQUlBLENBQUNBLEdBQUdBLENBQUNBLEdBQUdBLENBQUNBLENBQUNBO0lBQzdDQSxDQUFDQTtJQU9EdkIsS0FBS0E7UUFDRHdCLE1BQU1BLENBQUNBLEtBQUtBLENBQUNBLFVBQVVBLENBQUNBLElBQUlBLENBQUNBLEtBQUtBLEVBQUVBLElBQUlBLENBQUNBLEdBQUdBLENBQUNBLENBQUNBO0lBQ2xEQSxDQUFDQTtJQU9EeEIsWUFBWUE7UUFDUnlCLEVBQUVBLENBQUNBLENBQUNBLElBQUlBLENBQUNBLEdBQUdBLENBQUNBLE1BQU1BLEtBQUtBLENBQUNBLENBQUNBO1lBQ3RCQSxNQUFNQSxDQUFDQSxJQUFJQSxLQUFLQSxDQUFDQSxJQUFJQSxDQUFDQSxLQUFLQSxDQUFDQSxHQUFHQSxFQUFFQSxDQUFDQSxFQUFFQSxJQUFJQSxDQUFDQSxHQUFHQSxDQUFDQSxJQUFJQSxDQUFDQSxLQUFLQSxDQUFDQSxHQUFHQSxFQUFFQSxJQUFJQSxDQUFDQSxHQUFHQSxDQUFDQSxHQUFHQSxHQUFHQSxDQUFDQSxDQUFDQSxFQUFFQSxDQUFDQSxDQUFDQSxDQUFBQTtRQUN0RkEsSUFBSUE7WUFDQUEsTUFBTUEsQ0FBQ0EsSUFBSUEsS0FBS0EsQ0FBQ0EsSUFBSUEsQ0FBQ0EsS0FBS0EsQ0FBQ0EsR0FBR0EsRUFBRUEsQ0FBQ0EsRUFBRUEsSUFBSUEsQ0FBQ0EsR0FBR0EsQ0FBQ0EsR0FBR0EsRUFBRUEsQ0FBQ0EsQ0FBQ0EsQ0FBQUE7SUFDNURBLENBQUNBO0lBR0R6QixNQUFNQSxDQUFDQSxHQUFXQSxFQUFFQSxNQUFjQTtRQUM5QjBCLElBQUlBLENBQUNBLEtBQUtBLENBQUNBLEdBQUdBLElBQUlBLEdBQUdBLENBQUNBO1FBQ3RCQSxJQUFJQSxDQUFDQSxLQUFLQSxDQUFDQSxNQUFNQSxJQUFJQSxNQUFNQSxDQUFDQTtRQUM1QkEsSUFBSUEsQ0FBQ0EsR0FBR0EsQ0FBQ0EsR0FBR0EsSUFBSUEsR0FBR0EsQ0FBQ0E7UUFDcEJBLElBQUlBLENBQUNBLEdBQUdBLENBQUNBLE1BQU1BLElBQUlBLE1BQU1BLENBQUNBO0lBQzlCQSxDQUFDQTtJQVNEMUIsT0FBT0EsVUFBVUEsQ0FBQ0EsS0FBc0NBLEVBQUVBLEdBQW9DQTtRQUMxRjJCLE1BQU1BLENBQUNBLElBQUlBLEtBQUtBLENBQUNBLEtBQUtBLENBQUNBLEdBQUdBLEVBQUVBLEtBQUtBLENBQUNBLE1BQU1BLEVBQUVBLEdBQUdBLENBQUNBLEdBQUdBLEVBQUVBLEdBQUdBLENBQUNBLE1BQU1BLENBQUNBLENBQUNBO0lBQ25FQSxDQUFDQTtJQUVEM0IsT0FBT0EsYUFBYUEsQ0FBQ0EsRUFBbUNBLEVBQUVBLEVBQW1DQTtRQUN6RjRCLE1BQU1BLENBQUNBLEVBQUVBLENBQUNBLEdBQUdBLEdBQUdBLEVBQUVBLENBQUNBLEdBQUdBLElBQUlBLEVBQUVBLENBQUNBLE1BQU1BLEdBQUdBLEVBQUVBLENBQUNBLE1BQU1BLENBQUNBO0lBQ3BEQSxDQUFDQTtBQUNMNUIsQ0FBQ0E7QUFFRCxtQ0FBbUMsS0FBSztJQUdwQzZCLFlBQVlBLFFBQWdCQSxFQUFFQSxXQUFtQkEsRUFBRUEsTUFBY0EsRUFBRUEsU0FBaUJBLEVBQUVBLE1BQU1BLEVBQUVBLGFBQWFBO1FBQ3ZHQyxNQUFNQSxRQUFRQSxFQUFFQSxXQUFXQSxFQUFFQSxNQUFNQSxFQUFFQSxTQUFTQSxDQUFDQSxDQUFDQTtRQUNoREEsSUFBSUEsQ0FBQ0EsTUFBTUEsR0FBR0EsTUFBTUEsQ0FBQ0E7UUFDckJBLElBQUlBLENBQUNBLGFBQWFBLEdBQUdBLGFBQWFBLENBQUNBO0lBQ3ZDQSxDQUFDQTtBQUNMRCxDQUFDQTtBQUFBIiwic291cmNlc0NvbnRlbnQiOlsiLyogKioqKiogQkVHSU4gTElDRU5TRSBCTE9DSyAqKioqKlxuICogRGlzdHJpYnV0ZWQgdW5kZXIgdGhlIEJTRCBsaWNlbnNlOlxuICpcbiAqIENvcHlyaWdodCAoYykgMjAxMCwgQWpheC5vcmcgQi5WLlxuICogQWxsIHJpZ2h0cyByZXNlcnZlZC5cbiAqXG4gKiBSZWRpc3RyaWJ1dGlvbiBhbmQgdXNlIGluIHNvdXJjZSBhbmQgYmluYXJ5IGZvcm1zLCB3aXRoIG9yIHdpdGhvdXRcbiAqIG1vZGlmaWNhdGlvbiwgYXJlIHBlcm1pdHRlZCBwcm92aWRlZCB0aGF0IHRoZSBmb2xsb3dpbmcgY29uZGl0aW9ucyBhcmUgbWV0OlxuICogICAgICogUmVkaXN0cmlidXRpb25zIG9mIHNvdXJjZSBjb2RlIG11c3QgcmV0YWluIHRoZSBhYm92ZSBjb3B5cmlnaHRcbiAqICAgICAgIG5vdGljZSwgdGhpcyBsaXN0IG9mIGNvbmRpdGlvbnMgYW5kIHRoZSBmb2xsb3dpbmcgZGlzY2xhaW1lci5cbiAqICAgICAqIFJlZGlzdHJpYnV0aW9ucyBpbiBiaW5hcnkgZm9ybSBtdXN0IHJlcHJvZHVjZSB0aGUgYWJvdmUgY29weXJpZ2h0XG4gKiAgICAgICBub3RpY2UsIHRoaXMgbGlzdCBvZiBjb25kaXRpb25zIGFuZCB0aGUgZm9sbG93aW5nIGRpc2NsYWltZXIgaW4gdGhlXG4gKiAgICAgICBkb2N1bWVudGF0aW9uIGFuZC9vciBvdGhlciBtYXRlcmlhbHMgcHJvdmlkZWQgd2l0aCB0aGUgZGlzdHJpYnV0aW9uLlxuICogICAgICogTmVpdGhlciB0aGUgbmFtZSBvZiBBamF4Lm9yZyBCLlYuIG5vciB0aGVcbiAqICAgICAgIG5hbWVzIG9mIGl0cyBjb250cmlidXRvcnMgbWF5IGJlIHVzZWQgdG8gZW5kb3JzZSBvciBwcm9tb3RlIHByb2R1Y3RzXG4gKiAgICAgICBkZXJpdmVkIGZyb20gdGhpcyBzb2Z0d2FyZSB3aXRob3V0IHNwZWNpZmljIHByaW9yIHdyaXR0ZW4gcGVybWlzc2lvbi5cbiAqXG4gKiBUSElTIFNPRlRXQVJFIElTIFBST1ZJREVEIEJZIFRIRSBDT1BZUklHSFQgSE9MREVSUyBBTkQgQ09OVFJJQlVUT1JTIFwiQVMgSVNcIiBBTkRcbiAqIEFOWSBFWFBSRVNTIE9SIElNUExJRUQgV0FSUkFOVElFUywgSU5DTFVESU5HLCBCVVQgTk9UIExJTUlURUQgVE8sIFRIRSBJTVBMSUVEXG4gKiBXQVJSQU5USUVTIE9GIE1FUkNIQU5UQUJJTElUWSBBTkQgRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UgQVJFXG4gKiBESVNDTEFJTUVELiBJTiBOTyBFVkVOVCBTSEFMTCBBSkFYLk9SRyBCLlYuIEJFIExJQUJMRSBGT1IgQU5ZXG4gKiBESVJFQ1QsIElORElSRUNULCBJTkNJREVOVEFMLCBTUEVDSUFMLCBFWEVNUExBUlksIE9SIENPTlNFUVVFTlRJQUwgREFNQUdFU1xuICogKElOQ0xVRElORywgQlVUIE5PVCBMSU1JVEVEIFRPLCBQUk9DVVJFTUVOVCBPRiBTVUJTVElUVVRFIEdPT0RTIE9SIFNFUlZJQ0VTO1xuICogTE9TUyBPRiBVU0UsIERBVEEsIE9SIFBST0ZJVFM7IE9SIEJVU0lORVNTIElOVEVSUlVQVElPTikgSE9XRVZFUiBDQVVTRUQgQU5EXG4gKiBPTiBBTlkgVEhFT1JZIE9GIExJQUJJTElUWSwgV0hFVEhFUiBJTiBDT05UUkFDVCwgU1RSSUNUIExJQUJJTElUWSwgT1IgVE9SVFxuICogKElOQ0xVRElORyBORUdMSUdFTkNFIE9SIE9USEVSV0lTRSkgQVJJU0lORyBJTiBBTlkgV0FZIE9VVCBPRiBUSEUgVVNFIE9GIFRISVNcbiAqIFNPRlRXQVJFLCBFVkVOIElGIEFEVklTRUQgT0YgVEhFIFBPU1NJQklMSVRZIE9GIFNVQ0ggREFNQUdFLlxuICpcbiAqICoqKioqIEVORCBMSUNFTlNFIEJMT0NLICoqKioqICovXG5leHBvcnQgdmFyIGNvbXBhcmVQb2ludHMgPSBmdW5jdGlvbihwMTogeyByb3c6IG51bWJlcjsgY29sdW1uOiBudW1iZXIgfSwgcDI6IHsgcm93OiBudW1iZXI7IGNvbHVtbjogbnVtYmVyIH0pIHtcbiAgICByZXR1cm4gcDEucm93IC0gcDIucm93IHx8IHAxLmNvbHVtbiAtIHAyLmNvbHVtbjtcbn07XG4vKipcbiAqIFRoaXMgb2JqZWN0IGlzIHVzZWQgaW4gdmFyaW91cyBwbGFjZXMgdG8gaW5kaWNhdGUgYSByZWdpb24gd2l0aGluIHRoZSBlZGl0b3IuIFRvIGJldHRlciB2aXN1YWxpemUgaG93IHRoaXMgd29ya3MsIGltYWdpbmUgYSByZWN0YW5nbGUuIEVhY2ggcXVhZHJhbnQgb2YgdGhlIHJlY3RhbmdsZSBpcyBhbmFsb2d1cyB0byBhIHJhbmdlLCBhcyByYW5nZXMgY29udGFpbiBhIHN0YXJ0aW5nIHJvdyBhbmQgc3RhcnRpbmcgY29sdW1uLCBhbmQgYW4gZW5kaW5nIHJvdywgYW5kIGVuZGluZyBjb2x1bW4uXG4gKiBAY2xhc3MgUmFuZ2VcbiAqKi9cblxuLyoqXG4gKiBDcmVhdGVzIGEgbmV3IGBFZGl0b3JSYW5nZWAgb2JqZWN0IHdpdGggdGhlIGdpdmVuIHN0YXJ0aW5nIGFuZCBlbmRpbmcgcm93IGFuZCBjb2x1bW4gcG9pbnRzLlxuICogQHBhcmFtIHtOdW1iZXJ9IHN0YXJ0Um93IFRoZSBzdGFydGluZyByb3dcbiAqIEBwYXJhbSB7TnVtYmVyfSBzdGFydENvbHVtbiBUaGUgc3RhcnRpbmcgY29sdW1uXG4gKiBAcGFyYW0ge051bWJlcn0gZW5kUm93IFRoZSBlbmRpbmcgcm93XG4gKiBAcGFyYW0ge051bWJlcn0gZW5kQ29sdW1uIFRoZSBlbmRpbmcgY29sdW1uXG4gKlxuICogQGNvbnN0cnVjdG9yXG4gKiovXG5leHBvcnQgY2xhc3MgUmFuZ2Uge1xuICAgIHB1YmxpYyBzdGFydDogeyByb3c6IG51bWJlcjsgY29sdW1uOiBudW1iZXIgfTtcbiAgICBwdWJsaWMgZW5kOiB7IHJvdzogbnVtYmVyOyBjb2x1bW46IG51bWJlciB9O1xuICAgIC8vICBwdWJsaWMgY3Vyc29yOiBSYW5nZTtcbiAgICAvLyAgcHVibGljIGlzQmFja3dhcmRzOiBib29sZWFuO1xuICAgIC8qKlxuICAgICAqIEBjbGFzcyBSYW5nZVxuICAgICAqIEBjb25zdHJ1Y3RvclxuICAgICAqL1xuICAgIGNvbnN0cnVjdG9yKHN0YXJ0Um93OiBudW1iZXIsIHN0YXJ0Q29sdW1uOiBudW1iZXIsIGVuZFJvdzogbnVtYmVyLCBlbmRDb2x1bW46IG51bWJlcikge1xuICAgICAgICB0aGlzLnN0YXJ0ID0ge1xuICAgICAgICAgICAgcm93OiBzdGFydFJvdyxcbiAgICAgICAgICAgIGNvbHVtbjogc3RhcnRDb2x1bW5cbiAgICAgICAgfTtcblxuICAgICAgICB0aGlzLmVuZCA9IHtcbiAgICAgICAgICAgIHJvdzogZW5kUm93LFxuICAgICAgICAgICAgY29sdW1uOiBlbmRDb2x1bW5cbiAgICAgICAgfTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmV0dXJucyBgdHJ1ZWAgaWYgYW5kIG9ubHkgaWYgdGhlIHN0YXJ0aW5nIHJvdyBhbmQgY29sdW1uLCBhbmQgZW5kaW5nIHJvdyBhbmQgY29sdW1uLCBhcmUgZXF1aXZhbGVudCB0byB0aG9zZSBnaXZlbiBieSBgcmFuZ2VgLlxuICAgICAqIEBwYXJhbSB7RWRpdG9yUmFuZ2V9IHJhbmdlIEEgcmFuZ2UgdG8gY2hlY2sgYWdhaW5zdFxuICAgICAqXG4gICAgICogQHJldHVybiB7Qm9vbGVhbn1cbiAgICAgKiovXG4gICAgaXNFcXVhbChyYW5nZTogUmFuZ2UpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuc3RhcnQucm93ID09PSByYW5nZS5zdGFydC5yb3cgJiZcbiAgICAgICAgICAgIHRoaXMuZW5kLnJvdyA9PT0gcmFuZ2UuZW5kLnJvdyAmJlxuICAgICAgICAgICAgdGhpcy5zdGFydC5jb2x1bW4gPT09IHJhbmdlLnN0YXJ0LmNvbHVtbiAmJlxuICAgICAgICAgICAgdGhpcy5lbmQuY29sdW1uID09PSByYW5nZS5lbmQuY29sdW1uO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqXG4gICAgICogUmV0dXJucyBhIHN0cmluZyBjb250YWluaW5nIHRoZSByYW5nZSdzIHJvdyBhbmQgY29sdW1uIGluZm9ybWF0aW9uLCBnaXZlbiBsaWtlIHRoaXM6XG4gICAgICogYGBgXG4gICAgICogICAgW3N0YXJ0LnJvdy9zdGFydC5jb2x1bW5dIC0+IFtlbmQucm93L2VuZC5jb2x1bW5dXG4gICAgICogYGBgXG4gICAgICogQHJldHVybiB7U3RyaW5nfVxuICAgICAqKi9cbiAgICB0b1N0cmluZygpIHtcbiAgICAgICAgcmV0dXJuIChcIlJhbmdlOiBbXCIgKyB0aGlzLnN0YXJ0LnJvdyArIFwiL1wiICsgdGhpcy5zdGFydC5jb2x1bW4gK1xuICAgICAgICAgICAgXCJdIC0+IFtcIiArIHRoaXMuZW5kLnJvdyArIFwiL1wiICsgdGhpcy5lbmQuY29sdW1uICsgXCJdXCIpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqXG4gICAgICogUmV0dXJucyBgdHJ1ZWAgaWYgdGhlIGByb3dgIGFuZCBgY29sdW1uYCBwcm92aWRlZCBhcmUgd2l0aGluIHRoZSBnaXZlbiByYW5nZS4gVGhpcyBjYW4gYmV0dGVyIGJlIGV4cHJlc3NlZCBhcyByZXR1cm5pbmcgYHRydWVgIGlmOlxuICAgICAqIGBgYGphdmFzY3JpcHRcbiAgICAgKiAgICB0aGlzLnN0YXJ0LnJvdyA8PSByb3cgPD0gdGhpcy5lbmQucm93ICYmXG4gICAgICogICAgdGhpcy5zdGFydC5jb2x1bW4gPD0gY29sdW1uIDw9IHRoaXMuZW5kLmNvbHVtblxuICAgICAqIGBgYFxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSByb3cgQSByb3cgdG8gY2hlY2sgZm9yXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IGNvbHVtbiBBIGNvbHVtbiB0byBjaGVjayBmb3JcbiAgICAgKiBAcmV0dXJucyB7Qm9vbGVhbn1cbiAgICAgKiBAcmVsYXRlZCBFZGl0b3JSYW5nZS5jb21wYXJlXG4gICAgICoqL1xuXG4gICAgY29udGFpbnMocm93OiBudW1iZXIsIGNvbHVtbjogbnVtYmVyKTogYm9vbGVhbiB7XG4gICAgICAgIHJldHVybiB0aGlzLmNvbXBhcmUocm93LCBjb2x1bW4pID09PSAwO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENvbXBhcmVzIGB0aGlzYCByYW5nZSAoQSkgd2l0aCBhbm90aGVyIHJhbmdlIChCKS5cbiAgICAgKiBAcGFyYW0ge0VkaXRvclJhbmdlfSByYW5nZSBBIHJhbmdlIHRvIGNvbXBhcmUgd2l0aFxuICAgICAqXG4gICAgICogQHJlbGF0ZWQgRWRpdG9yUmFuZ2UuY29tcGFyZVxuICAgICAqIEByZXR1cm5zIHtOdW1iZXJ9IFRoaXMgbWV0aG9kIHJldHVybnMgb25lIG9mIHRoZSBmb2xsb3dpbmcgbnVtYmVyczo8YnIvPlxuICAgICAqIDxici8+XG4gICAgICogKiBgLTJgOiAoQikgaXMgaW4gZnJvbnQgb2YgKEEpLCBhbmQgZG9lc24ndCBpbnRlcnNlY3Qgd2l0aCAoQSk8YnIvPlxuICAgICAqICogYC0xYDogKEIpIGJlZ2lucyBiZWZvcmUgKEEpIGJ1dCBlbmRzIGluc2lkZSBvZiAoQSk8YnIvPlxuICAgICAqICogYDBgOiAoQikgaXMgY29tcGxldGVseSBpbnNpZGUgb2YgKEEpIE9SIChBKSBpcyBjb21wbGV0ZWx5IGluc2lkZSBvZiAoQik8YnIvPlxuICAgICAqICogYCsxYDogKEIpIGJlZ2lucyBpbnNpZGUgb2YgKEEpIGJ1dCBlbmRzIG91dHNpZGUgb2YgKEEpPGJyLz5cbiAgICAgKiAqIGArMmA6IChCKSBpcyBhZnRlciAoQSkgYW5kIGRvZXNuJ3QgaW50ZXJzZWN0IHdpdGggKEEpPGJyLz5cbiAgICAgKiAqIGA0MmA6IEZUVyBzdGF0ZTogKEIpIGVuZHMgaW4gKEEpIGJ1dCBzdGFydHMgb3V0c2lkZSBvZiAoQSlcbiAgICAgKiovXG4gICAgY29tcGFyZVJhbmdlKHJhbmdlOiBSYW5nZSk6IG51bWJlciB7XG4gICAgICAgIHZhciBjbXA6IG51bWJlclxuICAgICAgICB2YXIgZW5kID0gcmFuZ2UuZW5kO1xuICAgICAgICB2YXIgc3RhcnQgPSByYW5nZS5zdGFydDtcblxuICAgICAgICBjbXAgPSB0aGlzLmNvbXBhcmUoZW5kLnJvdywgZW5kLmNvbHVtbik7XG4gICAgICAgIGlmIChjbXAgPT09IDEpIHtcbiAgICAgICAgICAgIGNtcCA9IHRoaXMuY29tcGFyZShzdGFydC5yb3csIHN0YXJ0LmNvbHVtbik7XG4gICAgICAgICAgICBpZiAoY21wID09PSAxKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIDI7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChjbXAgPT09IDApIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gMTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHJldHVybiAwO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKGNtcCA9PT0gLTEpIHtcbiAgICAgICAgICAgIHJldHVybiAtMjtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGNtcCA9IHRoaXMuY29tcGFyZShzdGFydC5yb3csIHN0YXJ0LmNvbHVtbik7XG4gICAgICAgICAgICBpZiAoY21wID09PSAtMSkge1xuICAgICAgICAgICAgICAgIHJldHVybiAtMTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKGNtcCA9PT0gMSkge1xuICAgICAgICAgICAgICAgIHJldHVybiA0MjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHJldHVybiAwO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ2hlY2tzIHRoZSByb3cgYW5kIGNvbHVtbiBwb2ludHMgb2YgYHBgIHdpdGggdGhlIHJvdyBhbmQgY29sdW1uIHBvaW50cyBvZiB0aGUgY2FsbGluZyByYW5nZS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7RWRpdG9yUmFuZ2V9IHAgQSBwb2ludCB0byBjb21wYXJlIHdpdGhcbiAgICAgKlxuICAgICAqIEByZWxhdGVkIEVkaXRvclJhbmdlLmNvbXBhcmVcbiAgICAgKiBAcmV0dXJucyB7TnVtYmVyfSBUaGlzIG1ldGhvZCByZXR1cm5zIG9uZSBvZiB0aGUgZm9sbG93aW5nIG51bWJlcnM6PGJyLz5cbiAgICAgKiAqIGAwYCBpZiB0aGUgdHdvIHBvaW50cyBhcmUgZXhhY3RseSBlcXVhbDxici8+XG4gICAgICogKiBgLTFgIGlmIGBwLnJvd2AgaXMgbGVzcyB0aGVuIHRoZSBjYWxsaW5nIHJhbmdlPGJyLz5cbiAgICAgKiAqIGAxYCBpZiBgcC5yb3dgIGlzIGdyZWF0ZXIgdGhhbiB0aGUgY2FsbGluZyByYW5nZTxici8+XG4gICAgICogPGJyLz5cbiAgICAgKiBJZiB0aGUgc3RhcnRpbmcgcm93IG9mIHRoZSBjYWxsaW5nIHJhbmdlIGlzIGVxdWFsIHRvIGBwLnJvd2AsIGFuZDo8YnIvPlxuICAgICAqICogYHAuY29sdW1uYCBpcyBncmVhdGVyIHRoYW4gb3IgZXF1YWwgdG8gdGhlIGNhbGxpbmcgcmFuZ2UncyBzdGFydGluZyBjb2x1bW4sIHRoaXMgcmV0dXJucyBgMGA8YnIvPlxuICAgICAqICogT3RoZXJ3aXNlLCBpdCByZXR1cm5zIC0xPGJyLz5cbiAgICAgKjxici8+XG4gICAgICogSWYgdGhlIGVuZGluZyByb3cgb2YgdGhlIGNhbGxpbmcgcmFuZ2UgaXMgZXF1YWwgdG8gYHAucm93YCwgYW5kOjxici8+XG4gICAgICogKiBgcC5jb2x1bW5gIGlzIGxlc3MgdGhhbiBvciBlcXVhbCB0byB0aGUgY2FsbGluZyByYW5nZSdzIGVuZGluZyBjb2x1bW4sIHRoaXMgcmV0dXJucyBgMGA8YnIvPlxuICAgICAqICogT3RoZXJ3aXNlLCBpdCByZXR1cm5zIDE8YnIvPlxuICAgICAqKi9cbiAgICBjb21wYXJlUG9pbnQocDogeyByb3c6IG51bWJlcjsgY29sdW1uOiBudW1iZXIgfSk6IG51bWJlciB7XG4gICAgICAgIHJldHVybiB0aGlzLmNvbXBhcmUocC5yb3csIHAuY29sdW1uKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDaGVja3MgdGhlIHN0YXJ0IGFuZCBlbmQgcG9pbnRzIG9mIGByYW5nZWAgYW5kIGNvbXBhcmVzIHRoZW0gdG8gdGhlIGNhbGxpbmcgcmFuZ2UuIFJldHVybnMgYHRydWVgIGlmIHRoZSBgcmFuZ2VgIGlzIGNvbnRhaW5lZCB3aXRoaW4gdGhlIGNhbGxlcidzIHJhbmdlLlxuICAgICAqIEBwYXJhbSB7RWRpdG9yUmFuZ2V9IHJhbmdlIEEgcmFuZ2UgdG8gY29tcGFyZSB3aXRoXG4gICAgICpcbiAgICAgKiBAcmV0dXJucyB7Qm9vbGVhbn1cbiAgICAgKiBAcmVsYXRlZCBFZGl0b3JSYW5nZS5jb21wYXJlUG9pbnRcbiAgICAgKiovXG4gICAgY29udGFpbnNSYW5nZShyYW5nZTogUmFuZ2UpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuY29tcGFyZVBvaW50KHJhbmdlLnN0YXJ0KSA9PT0gMCAmJiB0aGlzLmNvbXBhcmVQb2ludChyYW5nZS5lbmQpID09PSAwO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFJldHVybnMgYHRydWVgIGlmIHBhc3NlZCBpbiBgcmFuZ2VgIGludGVyc2VjdHMgd2l0aCB0aGUgb25lIGNhbGxpbmcgdGhpcyBtZXRob2QuXG4gICAgICogQHBhcmFtIHtFZGl0b3JSYW5nZX0gcmFuZ2UgQSByYW5nZSB0byBjb21wYXJlIHdpdGhcbiAgICAgKlxuICAgICAqIEByZXR1cm5zIHtCb29sZWFufVxuICAgICAqKi9cbiAgICBpbnRlcnNlY3RzKHJhbmdlOiBSYW5nZSkge1xuICAgICAgICB2YXIgY21wID0gdGhpcy5jb21wYXJlUmFuZ2UocmFuZ2UpO1xuICAgICAgICByZXR1cm4gKGNtcCA9PT0gLTEgfHwgY21wID09PSAwIHx8IGNtcCA9PT0gMSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogUmV0dXJucyBgdHJ1ZWAgaWYgdGhlIGNhbGxlcidzIGVuZGluZyByb3cgcG9pbnQgaXMgdGhlIHNhbWUgYXMgYHJvd2AsIGFuZCBpZiB0aGUgY2FsbGVyJ3MgZW5kaW5nIGNvbHVtbiBpcyB0aGUgc2FtZSBhcyBgY29sdW1uYC5cbiAgICAgKiBAcGFyYW0ge051bWJlcn0gcm93IEEgcm93IHBvaW50IHRvIGNvbXBhcmUgd2l0aFxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBjb2x1bW4gQSBjb2x1bW4gcG9pbnQgdG8gY29tcGFyZSB3aXRoXG4gICAgICpcbiAgICAgKiBAcmV0dXJucyB7Qm9vbGVhbn1cbiAgICAgKiovXG4gICAgaXNFbmQocm93OiBudW1iZXIsIGNvbHVtbjogbnVtYmVyKTogYm9vbGVhbiB7XG4gICAgICAgIHJldHVybiB0aGlzLmVuZC5yb3cgPT09IHJvdyAmJiB0aGlzLmVuZC5jb2x1bW4gPT09IGNvbHVtbjtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIGB0cnVlYCBpZiB0aGUgY2FsbGVyJ3Mgc3RhcnRpbmcgcm93IHBvaW50IGlzIHRoZSBzYW1lIGFzIGByb3dgLCBhbmQgaWYgdGhlIGNhbGxlcidzIHN0YXJ0aW5nIGNvbHVtbiBpcyB0aGUgc2FtZSBhcyBgY29sdW1uYC5cbiAgICAgKiBAcGFyYW0ge051bWJlcn0gcm93IEEgcm93IHBvaW50IHRvIGNvbXBhcmUgd2l0aFxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBjb2x1bW4gQSBjb2x1bW4gcG9pbnQgdG8gY29tcGFyZSB3aXRoXG4gICAgICpcbiAgICAgKiBAcmV0dXJucyB7Qm9vbGVhbn1cbiAgICAgKiovXG4gICAgaXNTdGFydChyb3c6IG51bWJlciwgY29sdW1uOiBudW1iZXIpOiBib29sZWFuIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuc3RhcnQucm93ID09PSByb3cgJiYgdGhpcy5zdGFydC5jb2x1bW4gPT09IGNvbHVtbjtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBTZXRzIHRoZSBzdGFydGluZyByb3cgYW5kIGNvbHVtbiBmb3IgdGhlIHJhbmdlLlxuICAgICAqIEBwYXJhbSByb3cge251bWJlcn0gQSByb3cgcG9pbnQgdG8gc2V0XG4gICAgICogQHBhcmFtIGNvbHVtbiB7bnVtYmVyfSBBIGNvbHVtbiBwb2ludCB0byBzZXRcbiAgICAgKlxuICAgICAqKi9cbiAgICBzZXRTdGFydChyb3c6IG51bWJlciwgY29sdW1uOiBudW1iZXIpOiB2b2lkIHtcbiAgICAgICAgaWYgKHR5cGVvZiByb3cgPT09IFwib2JqZWN0XCIpIHtcbiAgICAgICAgICAgIC8vIEZhbGxiYWNrIHVudGlsIGNvZGUgaXMgY29tcGxldGVseSB0eXBlZC5cbiAgICAgICAgICAgIHRoaXMuc3RhcnQuY29sdW1uID0gcm93Wydjb2x1bW4nXTtcbiAgICAgICAgICAgIHRoaXMuc3RhcnQucm93ID0gcm93Wydyb3cnXTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuc3RhcnQucm93ID0gcm93O1xuICAgICAgICAgICAgdGhpcy5zdGFydC5jb2x1bW4gPSBjb2x1bW47XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBTZXRzIHRoZSBzdGFydGluZyByb3cgYW5kIGNvbHVtbiBmb3IgdGhlIHJhbmdlLlxuICAgICAqIEBwYXJhbSByb3cge251bWJlcn0gQSByb3cgcG9pbnQgdG8gc2V0XG4gICAgICogQHBhcmFtIGNvbHVtbiB7bnVtYmVyfSBBIGNvbHVtbiBwb2ludCB0byBzZXRcbiAgICAgKlxuICAgICAqKi9cbiAgICBzZXRFbmQocm93OiBudW1iZXIsIGNvbHVtbjogbnVtYmVyKTogdm9pZCB7XG4gICAgICAgIGlmICh0eXBlb2Ygcm93ID09PSBcIm9iamVjdFwiKSB7XG4gICAgICAgICAgICAvLyBGYWxsYmFjayB1bnRpbCBjb2RlIGlzIGNvbXBsZXRlbHkgdHlwZWQuXG4gICAgICAgICAgICB0aGlzLmVuZC5jb2x1bW4gPSByb3dbJ2NvbHVtbiddO1xuICAgICAgICAgICAgdGhpcy5lbmQucm93ID0gcm93Wydyb3cnXTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuZW5kLnJvdyA9IHJvdztcbiAgICAgICAgICAgIHRoaXMuZW5kLmNvbHVtbiA9IGNvbHVtbjtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFJldHVybnMgYHRydWVgIGlmIHRoZSBgcm93YCBhbmQgYGNvbHVtbmAgYXJlIHdpdGhpbiB0aGUgZ2l2ZW4gcmFuZ2UuXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IHJvdyBBIHJvdyBwb2ludCB0byBjb21wYXJlIHdpdGhcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gY29sdW1uIEEgY29sdW1uIHBvaW50IHRvIGNvbXBhcmUgd2l0aFxuICAgICAqXG4gICAgICpcbiAgICAgKiBAcmV0dXJucyB7Qm9vbGVhbn1cbiAgICAgKiBAcmVsYXRlZCBFZGl0b3JSYW5nZS5jb21wYXJlXG4gICAgICoqL1xuICAgIGluc2lkZShyb3c6IG51bWJlciwgY29sdW1uOiBudW1iZXIpOiBib29sZWFuIHtcbiAgICAgICAgaWYgKHRoaXMuY29tcGFyZShyb3csIGNvbHVtbikgPT09IDApIHtcbiAgICAgICAgICAgIGlmICh0aGlzLmlzRW5kKHJvdywgY29sdW1uKSB8fCB0aGlzLmlzU3RhcnQocm93LCBjb2x1bW4pKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFJldHVybnMgYHRydWVgIGlmIHRoZSBgcm93YCBhbmQgYGNvbHVtbmAgYXJlIHdpdGhpbiB0aGUgZ2l2ZW4gcmFuZ2UncyBzdGFydGluZyBwb2ludHMuXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IHJvdyBBIHJvdyBwb2ludCB0byBjb21wYXJlIHdpdGhcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gY29sdW1uIEEgY29sdW1uIHBvaW50IHRvIGNvbXBhcmUgd2l0aFxuICAgICAqXG4gICAgICogQHJldHVybnMge0Jvb2xlYW59XG4gICAgICogQHJlbGF0ZWQgRWRpdG9yUmFuZ2UuY29tcGFyZVxuICAgICAqKi9cbiAgICBpbnNpZGVTdGFydChyb3c6IG51bWJlciwgY29sdW1uOiBudW1iZXIpOiBib29sZWFuIHtcbiAgICAgICAgaWYgKHRoaXMuY29tcGFyZShyb3csIGNvbHVtbikgPT09IDApIHtcbiAgICAgICAgICAgIGlmICh0aGlzLmlzRW5kKHJvdywgY29sdW1uKSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIGB0cnVlYCBpZiB0aGUgYHJvd2AgYW5kIGBjb2x1bW5gIGFyZSB3aXRoaW4gdGhlIGdpdmVuIHJhbmdlJ3MgZW5kaW5nIHBvaW50cy5cbiAgICAgKiBAcGFyYW0ge051bWJlcn0gcm93IEEgcm93IHBvaW50IHRvIGNvbXBhcmUgd2l0aFxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBjb2x1bW4gQSBjb2x1bW4gcG9pbnQgdG8gY29tcGFyZSB3aXRoXG4gICAgICpcbiAgICAgKiBAcmV0dXJucyB7Qm9vbGVhbn1cbiAgICAgKiBAcmVsYXRlZCBFZGl0b3JSYW5nZS5jb21wYXJlXG4gICAgICpcbiAgICAgKiovXG4gICAgaW5zaWRlRW5kKHJvdzogbnVtYmVyLCBjb2x1bW46IG51bWJlcik6IGJvb2xlYW4ge1xuICAgICAgICBpZiAodGhpcy5jb21wYXJlKHJvdywgY29sdW1uKSA9PT0gMCkge1xuICAgICAgICAgICAgaWYgKHRoaXMuaXNTdGFydChyb3csIGNvbHVtbikpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ2hlY2tzIHRoZSByb3cgYW5kIGNvbHVtbiBwb2ludHMgd2l0aCB0aGUgcm93IGFuZCBjb2x1bW4gcG9pbnRzIG9mIHRoZSBjYWxsaW5nIHJhbmdlLlxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSByb3cgQSByb3cgcG9pbnQgdG8gY29tcGFyZSB3aXRoXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IGNvbHVtbiBBIGNvbHVtbiBwb2ludCB0byBjb21wYXJlIHdpdGhcbiAgICAgKlxuICAgICAqXG4gICAgICogQHJldHVybnMge051bWJlcn0gVGhpcyBtZXRob2QgcmV0dXJucyBvbmUgb2YgdGhlIGZvbGxvd2luZyBudW1iZXJzOjxici8+XG4gICAgICogYDBgIGlmIHRoZSB0d28gcG9pbnRzIGFyZSBleGFjdGx5IGVxdWFsIDxici8+XG4gICAgICogYC0xYCBpZiBgcC5yb3dgIGlzIGxlc3MgdGhlbiB0aGUgY2FsbGluZyByYW5nZSA8YnIvPlxuICAgICAqIGAxYCBpZiBgcC5yb3dgIGlzIGdyZWF0ZXIgdGhhbiB0aGUgY2FsbGluZyByYW5nZSA8YnIvPlxuICAgICAqICA8YnIvPlxuICAgICAqIElmIHRoZSBzdGFydGluZyByb3cgb2YgdGhlIGNhbGxpbmcgcmFuZ2UgaXMgZXF1YWwgdG8gYHAucm93YCwgYW5kOiA8YnIvPlxuICAgICAqIGBwLmNvbHVtbmAgaXMgZ3JlYXRlciB0aGFuIG9yIGVxdWFsIHRvIHRoZSBjYWxsaW5nIHJhbmdlJ3Mgc3RhcnRpbmcgY29sdW1uLCB0aGlzIHJldHVybnMgYDBgPGJyLz5cbiAgICAgKiBPdGhlcndpc2UsIGl0IHJldHVybnMgLTE8YnIvPlxuICAgICAqIDxici8+XG4gICAgICogSWYgdGhlIGVuZGluZyByb3cgb2YgdGhlIGNhbGxpbmcgcmFuZ2UgaXMgZXF1YWwgdG8gYHAucm93YCwgYW5kOiA8YnIvPlxuICAgICAqIGBwLmNvbHVtbmAgaXMgbGVzcyB0aGFuIG9yIGVxdWFsIHRvIHRoZSBjYWxsaW5nIHJhbmdlJ3MgZW5kaW5nIGNvbHVtbiwgdGhpcyByZXR1cm5zIGAwYCA8YnIvPlxuICAgICAqIE90aGVyd2lzZSwgaXQgcmV0dXJucyAxXG4gICAgICoqL1xuICAgIGNvbXBhcmUocm93OiBudW1iZXIsIGNvbHVtbjogbnVtYmVyKTogbnVtYmVyIHtcbiAgICAgICAgaWYgKCF0aGlzLmlzTXVsdGlMaW5lKCkpIHtcbiAgICAgICAgICAgIGlmIChyb3cgPT09IHRoaXMuc3RhcnQucm93KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGNvbHVtbiA8IHRoaXMuc3RhcnQuY29sdW1uID8gLTEgOiAoY29sdW1uID4gdGhpcy5lbmQuY29sdW1uID8gMSA6IDApO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHJvdyA8IHRoaXMuc3RhcnQucm93KVxuICAgICAgICAgICAgcmV0dXJuIC0xO1xuXG4gICAgICAgIGlmIChyb3cgPiB0aGlzLmVuZC5yb3cpXG4gICAgICAgICAgICByZXR1cm4gMTtcblxuICAgICAgICBpZiAodGhpcy5zdGFydC5yb3cgPT09IHJvdylcbiAgICAgICAgICAgIHJldHVybiBjb2x1bW4gPj0gdGhpcy5zdGFydC5jb2x1bW4gPyAwIDogLTE7XG5cbiAgICAgICAgaWYgKHRoaXMuZW5kLnJvdyA9PT0gcm93KVxuICAgICAgICAgICAgcmV0dXJuIGNvbHVtbiA8PSB0aGlzLmVuZC5jb2x1bW4gPyAwIDogMTtcblxuICAgICAgICByZXR1cm4gMDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDaGVja3MgdGhlIHJvdyBhbmQgY29sdW1uIHBvaW50cyB3aXRoIHRoZSByb3cgYW5kIGNvbHVtbiBwb2ludHMgb2YgdGhlIGNhbGxpbmcgcmFuZ2UuXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IHJvdyBBIHJvdyBwb2ludCB0byBjb21wYXJlIHdpdGhcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gY29sdW1uIEEgY29sdW1uIHBvaW50IHRvIGNvbXBhcmUgd2l0aFxuICAgICAqXG4gICAgICogQHJldHVybnMge051bWJlcn0gVGhpcyBtZXRob2QgcmV0dXJucyBvbmUgb2YgdGhlIGZvbGxvd2luZyBudW1iZXJzOjxici8+XG4gICAgICogPGJyLz5cbiAgICAgKiBgMGAgaWYgdGhlIHR3byBwb2ludHMgYXJlIGV4YWN0bHkgZXF1YWw8YnIvPlxuICAgICAqIGAtMWAgaWYgYHAucm93YCBpcyBsZXNzIHRoZW4gdGhlIGNhbGxpbmcgcmFuZ2U8YnIvPlxuICAgICAqIGAxYCBpZiBgcC5yb3dgIGlzIGdyZWF0ZXIgdGhhbiB0aGUgY2FsbGluZyByYW5nZSwgb3IgaWYgYGlzU3RhcnRgIGlzIGB0cnVlYC48YnIvPlxuICAgICAqIDxici8+XG4gICAgICogSWYgdGhlIHN0YXJ0aW5nIHJvdyBvZiB0aGUgY2FsbGluZyByYW5nZSBpcyBlcXVhbCB0byBgcC5yb3dgLCBhbmQ6PGJyLz5cbiAgICAgKiBgcC5jb2x1bW5gIGlzIGdyZWF0ZXIgdGhhbiBvciBlcXVhbCB0byB0aGUgY2FsbGluZyByYW5nZSdzIHN0YXJ0aW5nIGNvbHVtbiwgdGhpcyByZXR1cm5zIGAwYDxici8+XG4gICAgICogT3RoZXJ3aXNlLCBpdCByZXR1cm5zIC0xPGJyLz5cbiAgICAgKiA8YnIvPlxuICAgICAqIElmIHRoZSBlbmRpbmcgcm93IG9mIHRoZSBjYWxsaW5nIHJhbmdlIGlzIGVxdWFsIHRvIGBwLnJvd2AsIGFuZDo8YnIvPlxuICAgICAqIGBwLmNvbHVtbmAgaXMgbGVzcyB0aGFuIG9yIGVxdWFsIHRvIHRoZSBjYWxsaW5nIHJhbmdlJ3MgZW5kaW5nIGNvbHVtbiwgdGhpcyByZXR1cm5zIGAwYDxici8+XG4gICAgICogT3RoZXJ3aXNlLCBpdCByZXR1cm5zIDFcbiAgICAgKlxuICAgICAqKi9cbiAgICBjb21wYXJlU3RhcnQocm93OiBudW1iZXIsIGNvbHVtbjogbnVtYmVyKTogbnVtYmVyIHtcbiAgICAgICAgaWYgKHRoaXMuc3RhcnQucm93ID09PSByb3cgJiYgdGhpcy5zdGFydC5jb2x1bW4gPT09IGNvbHVtbikge1xuICAgICAgICAgICAgcmV0dXJuIC0xO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuY29tcGFyZShyb3csIGNvbHVtbik7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDaGVja3MgdGhlIHJvdyBhbmQgY29sdW1uIHBvaW50cyB3aXRoIHRoZSByb3cgYW5kIGNvbHVtbiBwb2ludHMgb2YgdGhlIGNhbGxpbmcgcmFuZ2UuXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IHJvdyBBIHJvdyBwb2ludCB0byBjb21wYXJlIHdpdGhcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gY29sdW1uIEEgY29sdW1uIHBvaW50IHRvIGNvbXBhcmUgd2l0aFxuICAgICAqXG4gICAgICpcbiAgICAgKiBAcmV0dXJucyB7TnVtYmVyfSBUaGlzIG1ldGhvZCByZXR1cm5zIG9uZSBvZiB0aGUgZm9sbG93aW5nIG51bWJlcnM6PGJyLz5cbiAgICAgKiBgMGAgaWYgdGhlIHR3byBwb2ludHMgYXJlIGV4YWN0bHkgZXF1YWw8YnIvPlxuICAgICAqIGAtMWAgaWYgYHAucm93YCBpcyBsZXNzIHRoZW4gdGhlIGNhbGxpbmcgcmFuZ2U8YnIvPlxuICAgICAqIGAxYCBpZiBgcC5yb3dgIGlzIGdyZWF0ZXIgdGhhbiB0aGUgY2FsbGluZyByYW5nZSwgb3IgaWYgYGlzRW5kYCBpcyBgdHJ1ZS48YnIvPlxuICAgICAqIDxici8+XG4gICAgICogSWYgdGhlIHN0YXJ0aW5nIHJvdyBvZiB0aGUgY2FsbGluZyByYW5nZSBpcyBlcXVhbCB0byBgcC5yb3dgLCBhbmQ6PGJyLz5cbiAgICAgKiBgcC5jb2x1bW5gIGlzIGdyZWF0ZXIgdGhhbiBvciBlcXVhbCB0byB0aGUgY2FsbGluZyByYW5nZSdzIHN0YXJ0aW5nIGNvbHVtbiwgdGhpcyByZXR1cm5zIGAwYDxici8+XG4gICAgICogT3RoZXJ3aXNlLCBpdCByZXR1cm5zIC0xPGJyLz5cbiAgICAgKjxici8+XG4gICAgICogSWYgdGhlIGVuZGluZyByb3cgb2YgdGhlIGNhbGxpbmcgcmFuZ2UgaXMgZXF1YWwgdG8gYHAucm93YCwgYW5kOjxici8+XG4gICAgICogYHAuY29sdW1uYCBpcyBsZXNzIHRoYW4gb3IgZXF1YWwgdG8gdGhlIGNhbGxpbmcgcmFuZ2UncyBlbmRpbmcgY29sdW1uLCB0aGlzIHJldHVybnMgYDBgPGJyLz5cbiAgICAgKiBPdGhlcndpc2UsIGl0IHJldHVybnMgMVxuICAgICAqL1xuICAgIGNvbXBhcmVFbmQocm93OiBudW1iZXIsIGNvbHVtbjogbnVtYmVyKTogbnVtYmVyIHtcbiAgICAgICAgaWYgKHRoaXMuZW5kLnJvdyA9PT0gcm93ICYmIHRoaXMuZW5kLmNvbHVtbiA9PT0gY29sdW1uKSB7XG4gICAgICAgICAgICByZXR1cm4gMTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmNvbXBhcmUocm93LCBjb2x1bW4pO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ2hlY2tzIHRoZSByb3cgYW5kIGNvbHVtbiBwb2ludHMgd2l0aCB0aGUgcm93IGFuZCBjb2x1bW4gcG9pbnRzIG9mIHRoZSBjYWxsaW5nIHJhbmdlLlxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSByb3cgQSByb3cgcG9pbnQgdG8gY29tcGFyZSB3aXRoXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IGNvbHVtbiBBIGNvbHVtbiBwb2ludCB0byBjb21wYXJlIHdpdGhcbiAgICAgKlxuICAgICAqXG4gICAgICogQHJldHVybnMge051bWJlcn0gVGhpcyBtZXRob2QgcmV0dXJucyBvbmUgb2YgdGhlIGZvbGxvd2luZyBudW1iZXJzOjxici8+XG4gICAgICogKiBgMWAgaWYgdGhlIGVuZGluZyByb3cgb2YgdGhlIGNhbGxpbmcgcmFuZ2UgaXMgZXF1YWwgdG8gYHJvd2AsIGFuZCB0aGUgZW5kaW5nIGNvbHVtbiBvZiB0aGUgY2FsbGluZyByYW5nZSBpcyBlcXVhbCB0byBgY29sdW1uYDxici8+XG4gICAgICogKiBgLTFgIGlmIHRoZSBzdGFydGluZyByb3cgb2YgdGhlIGNhbGxpbmcgcmFuZ2UgaXMgZXF1YWwgdG8gYHJvd2AsIGFuZCB0aGUgc3RhcnRpbmcgY29sdW1uIG9mIHRoZSBjYWxsaW5nIHJhbmdlIGlzIGVxdWFsIHRvIGBjb2x1bW5gPGJyLz5cbiAgICAgKiA8YnIvPlxuICAgICAqIE90aGVyd2lzZSwgaXQgcmV0dXJucyB0aGUgdmFsdWUgYWZ0ZXIgY2FsbGluZyBbW0VkaXRvclJhbmdlLmNvbXBhcmUgYGNvbXBhcmUoKWBdXS5cbiAgICAgKlxuICAgICAqKi9cbiAgICBjb21wYXJlSW5zaWRlKHJvdzogbnVtYmVyLCBjb2x1bW46IG51bWJlcik6IG51bWJlciB7XG4gICAgICAgIGlmICh0aGlzLmVuZC5yb3cgPT09IHJvdyAmJiB0aGlzLmVuZC5jb2x1bW4gPT09IGNvbHVtbikge1xuICAgICAgICAgICAgcmV0dXJuIDE7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAodGhpcy5zdGFydC5yb3cgPT09IHJvdyAmJiB0aGlzLnN0YXJ0LmNvbHVtbiA9PT0gY29sdW1uKSB7XG4gICAgICAgICAgICByZXR1cm4gLTE7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5jb21wYXJlKHJvdywgY29sdW1uKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFJldHVybnMgdGhlIHBhcnQgb2YgdGhlIGN1cnJlbnQgYEVkaXRvclJhbmdlYCB0aGF0IG9jY3VycyB3aXRoaW4gdGhlIGJvdW5kYXJpZXMgb2YgYGZpcnN0Um93YCBhbmQgYGxhc3RSb3dgIGFzIGEgbmV3IGBFZGl0b3JSYW5nZWAgb2JqZWN0LlxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBmaXJzdFJvdyBUaGUgc3RhcnRpbmcgcm93XG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IGxhc3RSb3cgVGhlIGVuZGluZyByb3dcbiAgICAgKiBAcmV0dXJucyB7RWRpdG9yUmFuZ2V9XG4gICAgKiovXG4gICAgY2xpcFJvd3MoZmlyc3RSb3c6IG51bWJlciwgbGFzdFJvdzogbnVtYmVyKTogUmFuZ2Uge1xuICAgICAgICB2YXIgc3RhcnQ6IHsgcm93OiBudW1iZXI7IGNvbHVtbjogbnVtYmVyIH07XG4gICAgICAgIHZhciBlbmQ6IHsgcm93OiBudW1iZXI7IGNvbHVtbjogbnVtYmVyIH07XG4gICAgICAgIGlmICh0aGlzLmVuZC5yb3cgPiBsYXN0Um93KVxuICAgICAgICAgICAgZW5kID0geyByb3c6IGxhc3RSb3cgKyAxLCBjb2x1bW46IDAgfTtcbiAgICAgICAgZWxzZSBpZiAodGhpcy5lbmQucm93IDwgZmlyc3RSb3cpXG4gICAgICAgICAgICBlbmQgPSB7IHJvdzogZmlyc3RSb3csIGNvbHVtbjogMCB9O1xuXG4gICAgICAgIGlmICh0aGlzLnN0YXJ0LnJvdyA+IGxhc3RSb3cpXG4gICAgICAgICAgICBzdGFydCA9IHsgcm93OiBsYXN0Um93ICsgMSwgY29sdW1uOiAwIH07XG4gICAgICAgIGVsc2UgaWYgKHRoaXMuc3RhcnQucm93IDwgZmlyc3RSb3cpXG4gICAgICAgICAgICBzdGFydCA9IHsgcm93OiBmaXJzdFJvdywgY29sdW1uOiAwIH07XG5cbiAgICAgICAgcmV0dXJuIFJhbmdlLmZyb21Qb2ludHMoc3RhcnQgfHwgdGhpcy5zdGFydCwgZW5kIHx8IHRoaXMuZW5kKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDaGFuZ2VzIHRoZSByb3cgYW5kIGNvbHVtbiBwb2ludHMgZm9yIHRoZSBjYWxsaW5nIHJhbmdlIGZvciBib3RoIHRoZSBzdGFydGluZyBhbmQgZW5kaW5nIHBvaW50cy5cbiAgICAgKiBAcGFyYW0ge051bWJlcn0gcm93IEEgbmV3IHJvdyB0byBleHRlbmQgdG9cbiAgICAgKiBAcGFyYW0ge051bWJlcn0gY29sdW1uIEEgbmV3IGNvbHVtbiB0byBleHRlbmQgdG9cbiAgICAgKiBAcmV0dXJucyB7RWRpdG9yUmFuZ2V9IFRoZSBvcmlnaW5hbCByYW5nZSB3aXRoIHRoZSBuZXcgcm93XG4gICAgKiovXG4gICAgZXh0ZW5kKHJvdzogbnVtYmVyLCBjb2x1bW46IG51bWJlcik6IFJhbmdlIHtcbiAgICAgICAgdmFyIGNtcCA9IHRoaXMuY29tcGFyZShyb3csIGNvbHVtbik7XG5cbiAgICAgICAgaWYgKGNtcCA9PT0gMCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoY21wID09PSAtMSkge1xuICAgICAgICAgICAgdmFyIHN0YXJ0ID0geyByb3c6IHJvdywgY29sdW1uOiBjb2x1bW4gfTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHZhciBlbmQgPSB7IHJvdzogcm93LCBjb2x1bW46IGNvbHVtbiB9O1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBSYW5nZS5mcm9tUG9pbnRzKHN0YXJ0IHx8IHRoaXMuc3RhcnQsIGVuZCB8fCB0aGlzLmVuZCk7XG4gICAgfVxuXG4gICAgaXNFbXB0eSgpOiBib29sZWFuIHtcbiAgICAgICAgcmV0dXJuICh0aGlzLnN0YXJ0LnJvdyA9PT0gdGhpcy5lbmQucm93ICYmIHRoaXMuc3RhcnQuY29sdW1uID09PSB0aGlzLmVuZC5jb2x1bW4pO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqXG4gICAgICogUmV0dXJucyBgdHJ1ZWAgaWYgdGhlIHJhbmdlIHNwYW5zIGFjcm9zcyBtdWx0aXBsZSBsaW5lcy5cbiAgICAgKiBAcmV0dXJucyB7Qm9vbGVhbn1cbiAgICAqKi9cbiAgICBpc011bHRpTGluZSgpOiBib29sZWFuIHtcbiAgICAgICAgcmV0dXJuICh0aGlzLnN0YXJ0LnJvdyAhPT0gdGhpcy5lbmQucm93KTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKlxuICAgICAqIFJldHVybnMgYSBkdXBsaWNhdGUgb2YgdGhlIGNhbGxpbmcgcmFuZ2UuXG4gICAgICogQHJldHVybnMge0VkaXRvclJhbmdlfVxuICAgICoqL1xuICAgIGNsb25lKCkge1xuICAgICAgICByZXR1cm4gUmFuZ2UuZnJvbVBvaW50cyh0aGlzLnN0YXJ0LCB0aGlzLmVuZCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICpcbiAgICAgKiBSZXR1cm5zIGEgcmFuZ2UgY29udGFpbmluZyB0aGUgc3RhcnRpbmcgYW5kIGVuZGluZyByb3dzIG9mIHRoZSBvcmlnaW5hbCByYW5nZSwgYnV0IHdpdGggYSBjb2x1bW4gdmFsdWUgb2YgYDBgLlxuICAgICAqIEByZXR1cm5zIHtFZGl0b3JSYW5nZX1cbiAgICAqKi9cbiAgICBjb2xsYXBzZVJvd3MoKSB7XG4gICAgICAgIGlmICh0aGlzLmVuZC5jb2x1bW4gPT09IDApXG4gICAgICAgICAgICByZXR1cm4gbmV3IFJhbmdlKHRoaXMuc3RhcnQucm93LCAwLCBNYXRoLm1heCh0aGlzLnN0YXJ0LnJvdywgdGhpcy5lbmQucm93IC0gMSksIDApXG4gICAgICAgIGVsc2VcbiAgICAgICAgICAgIHJldHVybiBuZXcgUmFuZ2UodGhpcy5zdGFydC5yb3csIDAsIHRoaXMuZW5kLnJvdywgMClcbiAgICB9XG5cbiAgICAvKiBleHBlcmltZW50YWwgKi9cbiAgICBtb3ZlQnkocm93OiBudW1iZXIsIGNvbHVtbjogbnVtYmVyKSB7XG4gICAgICAgIHRoaXMuc3RhcnQucm93ICs9IHJvdztcbiAgICAgICAgdGhpcy5zdGFydC5jb2x1bW4gKz0gY29sdW1uO1xuICAgICAgICB0aGlzLmVuZC5yb3cgKz0gcm93O1xuICAgICAgICB0aGlzLmVuZC5jb2x1bW4gKz0gY29sdW1uO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENyZWF0ZXMgYW5kIHJldHVybnMgYSBuZXcgYEVkaXRvclJhbmdlYCBiYXNlZCBvbiB0aGUgcm93IGFuZCBjb2x1bW4gb2YgdGhlIGdpdmVuIHBhcmFtZXRlcnMuXG4gICAgICogQHBhcmFtIHtFZGl0b3JSYW5nZX0gc3RhcnQgQSBzdGFydGluZyBwb2ludCB0byB1c2VcbiAgICAgKiBAcGFyYW0ge0VkaXRvclJhbmdlfSBlbmQgQW4gZW5kaW5nIHBvaW50IHRvIHVzZVxuICAgICAqXG4gICAgICogQHJldHVybnMge0VkaXRvclJhbmdlfVxuICAgICoqL1xuICAgIHN0YXRpYyBmcm9tUG9pbnRzKHN0YXJ0OiB7IHJvdzogbnVtYmVyOyBjb2x1bW46IG51bWJlciB9LCBlbmQ6IHsgcm93OiBudW1iZXI7IGNvbHVtbjogbnVtYmVyIH0pIHtcbiAgICAgICAgcmV0dXJuIG5ldyBSYW5nZShzdGFydC5yb3csIHN0YXJ0LmNvbHVtbiwgZW5kLnJvdywgZW5kLmNvbHVtbik7XG4gICAgfVxuXG4gICAgc3RhdGljIGNvbXBhcmVQb2ludHMocDE6IHsgcm93OiBudW1iZXI7IGNvbHVtbjogbnVtYmVyIH0sIHAyOiB7IHJvdzogbnVtYmVyOyBjb2x1bW46IG51bWJlciB9KSB7XG4gICAgICAgIHJldHVybiBwMS5yb3cgLSBwMi5yb3cgfHwgcDEuY29sdW1uIC0gcDIuY29sdW1uO1xuICAgIH1cbn1cblxuZXhwb3J0IGNsYXNzIE9yaWVudGVkUmFuZ2UgZXh0ZW5kcyBSYW5nZSB7XG4gICAgcHVibGljIGN1cnNvcjtcbiAgICBwdWJsaWMgZGVzaXJlZENvbHVtbjtcbiAgICBjb25zdHJ1Y3RvcihzdGFydFJvdzogbnVtYmVyLCBzdGFydENvbHVtbjogbnVtYmVyLCBlbmRSb3c6IG51bWJlciwgZW5kQ29sdW1uOiBudW1iZXIsIGN1cnNvciwgZGVzaXJlZENvbHVtbikge1xuICAgICAgICBzdXBlcihzdGFydFJvdywgc3RhcnRDb2x1bW4sIGVuZFJvdywgZW5kQ29sdW1uKTtcbiAgICAgICAgdGhpcy5jdXJzb3IgPSBjdXJzb3I7XG4gICAgICAgIHRoaXMuZGVzaXJlZENvbHVtbiA9IGRlc2lyZWRDb2x1bW47XG4gICAgfVxufVxuIl19