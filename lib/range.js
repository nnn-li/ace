var __extends = (this && this.__extends) || function (d, b) {
    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];
    function __() { this.constructor = d; }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
};
exports.comparePoints = function (p1, p2) {
    return p1.row - p2.row || p1.column - p2.column;
};
var Range = (function () {
    function Range(startRow, startColumn, endRow, endColumn) {
        this.start = {
            row: startRow,
            column: startColumn
        };
        this.end = {
            row: endRow,
            column: endColumn
        };
    }
    Range.prototype.isEqual = function (range) {
        return this.start.row === range.start.row &&
            this.end.row === range.end.row &&
            this.start.column === range.start.column &&
            this.end.column === range.end.column;
    };
    Range.prototype.toString = function () {
        return ("Range: [" + this.start.row + "/" + this.start.column +
            "] -> [" + this.end.row + "/" + this.end.column + "]");
    };
    Range.prototype.contains = function (row, column) {
        return this.compare(row, column) === 0;
    };
    Range.prototype.compareRange = function (range) {
        var cmp;
        var end = range.end;
        var start = range.start;
        cmp = this.compare(end.row, end.column);
        if (cmp === 1) {
            cmp = this.compare(start.row, start.column);
            if (cmp === 1) {
                return 2;
            }
            else if (cmp === 0) {
                return 1;
            }
            else {
                return 0;
            }
        }
        else if (cmp === -1) {
            return -2;
        }
        else {
            cmp = this.compare(start.row, start.column);
            if (cmp === -1) {
                return -1;
            }
            else if (cmp === 1) {
                return 42;
            }
            else {
                return 0;
            }
        }
    };
    Range.prototype.comparePoint = function (p) {
        return this.compare(p.row, p.column);
    };
    Range.prototype.containsRange = function (range) {
        return this.comparePoint(range.start) === 0 && this.comparePoint(range.end) === 0;
    };
    Range.prototype.intersects = function (range) {
        var cmp = this.compareRange(range);
        return (cmp === -1 || cmp === 0 || cmp === 1);
    };
    Range.prototype.isEnd = function (row, column) {
        return this.end.row === row && this.end.column === column;
    };
    Range.prototype.isStart = function (row, column) {
        return this.start.row === row && this.start.column === column;
    };
    Range.prototype.setStart = function (row, column) {
        if (typeof row === "object") {
            this.start.column = row['column'];
            this.start.row = row['row'];
        }
        else {
            this.start.row = row;
            this.start.column = column;
        }
    };
    Range.prototype.setEnd = function (row, column) {
        if (typeof row === "object") {
            this.end.column = row['column'];
            this.end.row = row['row'];
        }
        else {
            this.end.row = row;
            this.end.column = column;
        }
    };
    Range.prototype.inside = function (row, column) {
        if (this.compare(row, column) === 0) {
            if (this.isEnd(row, column) || this.isStart(row, column)) {
                return false;
            }
            else {
                return true;
            }
        }
        return false;
    };
    Range.prototype.insideStart = function (row, column) {
        if (this.compare(row, column) === 0) {
            if (this.isEnd(row, column)) {
                return false;
            }
            else {
                return true;
            }
        }
        return false;
    };
    Range.prototype.insideEnd = function (row, column) {
        if (this.compare(row, column) === 0) {
            if (this.isStart(row, column)) {
                return false;
            }
            else {
                return true;
            }
        }
        return false;
    };
    Range.prototype.compare = function (row, column) {
        if (!this.isMultiLine()) {
            if (row === this.start.row) {
                return column < this.start.column ? -1 : (column > this.end.column ? 1 : 0);
            }
        }
        if (row < this.start.row)
            return -1;
        if (row > this.end.row)
            return 1;
        if (this.start.row === row)
            return column >= this.start.column ? 0 : -1;
        if (this.end.row === row)
            return column <= this.end.column ? 0 : 1;
        return 0;
    };
    Range.prototype.compareStart = function (row, column) {
        if (this.start.row === row && this.start.column === column) {
            return -1;
        }
        else {
            return this.compare(row, column);
        }
    };
    Range.prototype.compareEnd = function (row, column) {
        if (this.end.row === row && this.end.column === column) {
            return 1;
        }
        else {
            return this.compare(row, column);
        }
    };
    Range.prototype.compareInside = function (row, column) {
        if (this.end.row === row && this.end.column === column) {
            return 1;
        }
        else if (this.start.row === row && this.start.column === column) {
            return -1;
        }
        else {
            return this.compare(row, column);
        }
    };
    Range.prototype.clipRows = function (firstRow, lastRow) {
        var start;
        var end;
        if (this.end.row > lastRow)
            end = { row: lastRow + 1, column: 0 };
        else if (this.end.row < firstRow)
            end = { row: firstRow, column: 0 };
        if (this.start.row > lastRow)
            start = { row: lastRow + 1, column: 0 };
        else if (this.start.row < firstRow)
            start = { row: firstRow, column: 0 };
        return Range.fromPoints(start || this.start, end || this.end);
    };
    Range.prototype.extend = function (row, column) {
        var cmp = this.compare(row, column);
        if (cmp === 0) {
            return this;
        }
        else if (cmp === -1) {
            var start = { row: row, column: column };
        }
        else {
            var end = { row: row, column: column };
        }
        return Range.fromPoints(start || this.start, end || this.end);
    };
    Range.prototype.isEmpty = function () {
        return (this.start.row === this.end.row && this.start.column === this.end.column);
    };
    Range.prototype.isMultiLine = function () {
        return (this.start.row !== this.end.row);
    };
    Range.prototype.clone = function () {
        return Range.fromPoints(this.start, this.end);
    };
    Range.prototype.collapseRows = function () {
        if (this.end.column === 0)
            return new Range(this.start.row, 0, Math.max(this.start.row, this.end.row - 1), 0);
        else
            return new Range(this.start.row, 0, this.end.row, 0);
    };
    Range.prototype.toScreenRange = function (session) {
        var screenPosStart = session.documentToScreenPosition(this.start.row, this.start.column);
        var screenPosEnd = session.documentToScreenPosition(this.end.row, this.end.column);
        return new Range(screenPosStart.row, screenPosStart.column, screenPosEnd.row, screenPosEnd.column);
    };
    Range.prototype.moveBy = function (row, column) {
        this.start.row += row;
        this.start.column += column;
        this.end.row += row;
        this.end.column += column;
    };
    Range.fromPoints = function (start, end) {
        return new Range(start.row, start.column, end.row, end.column);
    };
    Range.comparePoints = function (p1, p2) {
        return p1.row - p2.row || p1.column - p2.column;
    };
    return Range;
})();
exports.Range = Range;
var OrientedRange = (function (_super) {
    __extends(OrientedRange, _super);
    function OrientedRange(startRow, startColumn, endRow, endColumn, cursor, desiredColumn) {
        _super.call(this, startRow, startColumn, endRow, endColumn);
        this.cursor = cursor;
        this.desiredColumn = desiredColumn;
    }
    return OrientedRange;
})(Range);
exports.OrientedRange = OrientedRange;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicmFuZ2UuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi9zcmMvcmFuZ2UudHMiXSwibmFtZXMiOlsiUmFuZ2UiLCJSYW5nZS5jb25zdHJ1Y3RvciIsIlJhbmdlLmlzRXF1YWwiLCJSYW5nZS50b1N0cmluZyIsIlJhbmdlLmNvbnRhaW5zIiwiUmFuZ2UuY29tcGFyZVJhbmdlIiwiUmFuZ2UuY29tcGFyZVBvaW50IiwiUmFuZ2UuY29udGFpbnNSYW5nZSIsIlJhbmdlLmludGVyc2VjdHMiLCJSYW5nZS5pc0VuZCIsIlJhbmdlLmlzU3RhcnQiLCJSYW5nZS5zZXRTdGFydCIsIlJhbmdlLnNldEVuZCIsIlJhbmdlLmluc2lkZSIsIlJhbmdlLmluc2lkZVN0YXJ0IiwiUmFuZ2UuaW5zaWRlRW5kIiwiUmFuZ2UuY29tcGFyZSIsIlJhbmdlLmNvbXBhcmVTdGFydCIsIlJhbmdlLmNvbXBhcmVFbmQiLCJSYW5nZS5jb21wYXJlSW5zaWRlIiwiUmFuZ2UuY2xpcFJvd3MiLCJSYW5nZS5leHRlbmQiLCJSYW5nZS5pc0VtcHR5IiwiUmFuZ2UuaXNNdWx0aUxpbmUiLCJSYW5nZS5jbG9uZSIsIlJhbmdlLmNvbGxhcHNlUm93cyIsIlJhbmdlLnRvU2NyZWVuUmFuZ2UiLCJSYW5nZS5tb3ZlQnkiLCJSYW5nZS5mcm9tUG9pbnRzIiwiUmFuZ2UuY29tcGFyZVBvaW50cyIsIk9yaWVudGVkUmFuZ2UiLCJPcmllbnRlZFJhbmdlLmNvbnN0cnVjdG9yIl0sIm1hcHBpbmdzIjoiOzs7OztBQStCVyxxQkFBYSxHQUFHLFVBQVMsRUFBbUMsRUFBRSxFQUFtQztJQUN4RyxNQUFNLENBQUMsRUFBRSxDQUFDLEdBQUcsR0FBRyxFQUFFLENBQUMsR0FBRyxJQUFJLEVBQUUsQ0FBQyxNQUFNLEdBQUcsRUFBRSxDQUFDLE1BQU0sQ0FBQztBQUNwRCxDQUFDLENBQUM7QUFlRjtJQVNJQSxlQUFZQSxRQUFnQkEsRUFBRUEsV0FBbUJBLEVBQUVBLE1BQWNBLEVBQUVBLFNBQWlCQTtRQUNoRkMsSUFBSUEsQ0FBQ0EsS0FBS0EsR0FBR0E7WUFDVEEsR0FBR0EsRUFBRUEsUUFBUUE7WUFDYkEsTUFBTUEsRUFBRUEsV0FBV0E7U0FDdEJBLENBQUNBO1FBRUZBLElBQUlBLENBQUNBLEdBQUdBLEdBQUdBO1lBQ1BBLEdBQUdBLEVBQUVBLE1BQU1BO1lBQ1hBLE1BQU1BLEVBQUVBLFNBQVNBO1NBQ3BCQSxDQUFDQTtJQUNOQSxDQUFDQTtJQU9ERCx1QkFBT0EsR0FBUEEsVUFBUUEsS0FBWUE7UUFDaEJFLE1BQU1BLENBQUNBLElBQUlBLENBQUNBLEtBQUtBLENBQUNBLEdBQUdBLEtBQUtBLEtBQUtBLENBQUNBLEtBQUtBLENBQUNBLEdBQUdBO1lBQ3JDQSxJQUFJQSxDQUFDQSxHQUFHQSxDQUFDQSxHQUFHQSxLQUFLQSxLQUFLQSxDQUFDQSxHQUFHQSxDQUFDQSxHQUFHQTtZQUM5QkEsSUFBSUEsQ0FBQ0EsS0FBS0EsQ0FBQ0EsTUFBTUEsS0FBS0EsS0FBS0EsQ0FBQ0EsS0FBS0EsQ0FBQ0EsTUFBTUE7WUFDeENBLElBQUlBLENBQUNBLEdBQUdBLENBQUNBLE1BQU1BLEtBQUtBLEtBQUtBLENBQUNBLEdBQUdBLENBQUNBLE1BQU1BLENBQUNBO0lBQzdDQSxDQUFDQTtJQVVERix3QkFBUUEsR0FBUkE7UUFDSUcsTUFBTUEsQ0FBQ0EsQ0FBQ0EsVUFBVUEsR0FBR0EsSUFBSUEsQ0FBQ0EsS0FBS0EsQ0FBQ0EsR0FBR0EsR0FBR0EsR0FBR0EsR0FBR0EsSUFBSUEsQ0FBQ0EsS0FBS0EsQ0FBQ0EsTUFBTUE7WUFDekRBLFFBQVFBLEdBQUdBLElBQUlBLENBQUNBLEdBQUdBLENBQUNBLEdBQUdBLEdBQUdBLEdBQUdBLEdBQUdBLElBQUlBLENBQUNBLEdBQUdBLENBQUNBLE1BQU1BLEdBQUdBLEdBQUdBLENBQUNBLENBQUNBO0lBQy9EQSxDQUFDQTtJQWVESCx3QkFBUUEsR0FBUkEsVUFBU0EsR0FBV0EsRUFBRUEsTUFBY0E7UUFDaENJLE1BQU1BLENBQUNBLElBQUlBLENBQUNBLE9BQU9BLENBQUNBLEdB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QUNBLENBQUNBLElBQUlBLENBQUNBLEtBQUtBLENBQUNBLEdBQUdBLEtBQUtBLEdBQUdBLElBQUlBLElBQUlBLENBQUNBLEtBQUtBLENBQUNBLE1BQU1BLEtBQUtBLE1BQU1BLENBQUNBLENBQUNBLENBQUNBO1lBQ3pEQSxNQUFNQSxDQUFDQSxDQUFDQSxDQUFDQSxDQUFDQTtRQUNkQSxDQUFDQTtRQUNEQSxJQUFJQSxDQUFDQSxDQUFDQTtZQUNGQSxNQUFNQSxDQUFDQSxJQUFJQSxDQUFDQSxPQUFPQSxDQUFDQSxHQUFHQSxFQUFFQSxNQUFNQSxDQUFDQSxDQUFDQTtRQUNyQ0EsQ0FBQ0E7SUFDTEEsQ0FBQ0E7SUFxQkRqQiwwQkFBVUEsR0FBVkEsVUFBV0EsR0FBV0EsRUFBRUEsTUFBY0E7UUFDbENrQixFQUFFQSxDQUFDQSxDQUFDQSxJQUFJQSxDQUFDQSxHQUFHQSxDQUFDQSxHQUFHQSxLQUFLQSxHQUFHQSxJQUFJQSxJQUFJQSxDQUFDQSxHQUFHQSxDQUFDQSxNQUFNQSxLQUFLQSxNQUFNQSxDQUFDQSxDQUFDQSxDQUFDQTtZQUNyREEsTUFBTUEsQ0FBQ0EsQ0FBQ0EsQ0FBQ0E7UUFDYkEsQ0FBQ0E7UUFDREEsSUFBSUEsQ0FBQ0EsQ0FBQ0E7WUFDRkEsTUFBTUEsQ0FBQ0EsSUFBSUEsQ0FBQ0EsT0FBT0EsQ0FBQ0EsR0FBR0EsRUFBRUEsTUFBTUEsQ0FBQ0EsQ0FBQ0E7UUFDckNBLENBQUNBO0lBQ0xBLENBQUNBO0lBZURsQiw2QkFBYUEsR0FBYkEsVUFBY0EsR0FBV0EsRUFBRUEsTUFBY0E7UUFDckNtQixFQUFFQSxDQUFDQSxDQUFDQSxJQUFJQSxDQUFDQSxHQUFHQSxDQUFDQSxHQUFHQSxLQUFLQSxHQUFHQSxJQUFJQSxJQUFJQSxDQUFDQSxHQUFHQSxDQUFDQSxNQUFNQSxLQUFLQSxNQUFNQSxDQUFDQSxDQUFDQSxDQUFDQTtZQUNyREEsTUFBTUEsQ0FBQ0EsQ0FBQ0EsQ0FBQ0E7UUFDYkEsQ0FBQ0E7UUFDREEsSUFBSUEsQ0FBQ0EsRUFBRUEsQ0FBQ0EsQ0FBQ0EsSUFBSUEsQ0FBQ0EsS0FBS0EsQ0FBQ0EsR0FBR0EsS0FBS0EsR0FBR0EsSUFBSUEsSUFBSUEsQ0FBQ0EsS0FBS0EsQ0FBQ0EsTUFBTUEsS0FBS0EsTUFBTUEsQ0FBQ0EsQ0FBQ0EsQ0FBQ0E7WUFDOURBLE1BQU1BLENBQUNBLENBQUNBLENBQUNBLENBQUNBO1FBQ2RBLENBQUNBO1FBQ0RBLElBQUlBLENBQUNBLENBQUNBO1lBQ0ZBLE1BQU1BLENBQUNBLElBQUlBLENBQUNBLE9BQU9BLENBQUNBLEdBQUdBLEVBQUVBLE1BQU1BLENBQUNBLENBQUNBO1FBQ3JDQSxDQUFDQTtJQUNMQSxDQUFDQTtJQVFEbkIsd0JBQVFBLEdBQVJBLFVBQVNBLFFBQWdCQSxFQUFFQSxPQUFlQTtRQUN0Q29CLElBQUlBLEtBQXNDQSxDQUFDQTtRQUMzQ0EsSUFBSUEsR0FBb0NBLENBQUNBO1FBQ3pDQSxFQUFFQSxDQUFDQSxDQUFDQSxJQUFJQSxDQUFDQSxHQUFHQSxDQUFDQSxHQUFHQSxHQUFHQSxPQUFPQSxDQUFDQTtZQUN2QkEsR0FBR0EsR0FBR0EsRUFBRUEsR0FBR0EsRUFBRUEsT0FBT0EsR0FBR0EsQ0FBQ0EsRUFBRUEsTUFBTUEsRUFBRUEsQ0FBQ0EsRUFBRUEsQ0FBQ0E7UUFDMUNBLElBQUlBLENBQUNBLEVBQUVBLENBQUNBLENBQUNBLElBQUlBLENBQUNBLEdBQUdBLENBQUNBLEdBQUdBLEdBQUdBLFFBQVFBLENBQUNBO1lBQzdCQSxHQUFHQSxHQUFHQSxFQUFFQSxHQUFHQSxFQUFFQSxRQUFRQSxFQUFFQSxNQUFNQSxFQUFFQSxDQUFDQSxFQUFFQSxDQUFDQTtRQUV2Q0EsRUFBRUEsQ0FBQ0EsQ0FBQ0EsSUFBSUEsQ0FBQ0EsS0FBS0EsQ0FBQ0EsR0FBR0EsR0FBR0EsT0FBT0EsQ0FBQ0E7WUFDekJBLEtBQUtBLEdBQUdBLEVBQUVBLEdBQUdBLEVBQUVBLE9BQU9BLEdBQUdBLENBQUNBLEVBQUVBLE1BQU1BLEVBQUVBLENBQUNBLEVBQUVBLENBQUNBO1FBQzVDQSxJQUFJQSxDQUFDQSxFQUFFQSxDQUFDQSxDQUFDQSxJQUFJQSxDQUFDQSxLQUFLQSxDQUFDQSxHQUFHQSxHQUFHQSxRQUFRQSxDQUFDQTtZQUMvQkEsS0FBS0EsR0FBR0EsRUFBRUEsR0FBR0EsRUFBRUEsUUFBUUEsRUFBRUEsTUFBTUEsRUFBRUEsQ0FBQ0EsRUFBRUEsQ0FBQ0E7UUFFekNBLE1BQU1BLENBQUNBLEtBQUtBLENBQUNBLFVBQVVBLENBQUNBLEtBQUtBLElBQUlBLElBQUlBLENBQUNBLEtBQUtBLEVBQUVBLEdBQUdBLElBQUlBLElBQUlBLENBQUNBLEdBQUdBLENBQUNBLENBQUNBO0lBQ2xFQSxDQUFDQTtJQVFEcEIsc0JBQU1BLEdBQU5BLFVBQU9BLEdBQVdBLEVBQUVBLE1BQWNBO1FBQzlCcUIsSUFBSUEsR0FBR0EsR0FBR0EsSUFBSUEsQ0FBQ0EsT0FBT0EsQ0FBQ0EsR0FBR0EsRUFBRUEsTUFBTUEsQ0FBQ0EsQ0FBQ0E7UUFFcENBLEVBQUVBLENBQUNBLENBQUNBLEdBQUdBLEtBQUtBLENBQUNBLENBQUNBLENBQUNBLENBQUNBO1lBQ1pBLE1BQU1BLENBQUNBLElBQUlBLENBQUNBO1FBQ2hCQSxDQUFDQTtRQUNEQSxJQUFJQSxDQUFDQSxFQUFFQSxDQUFDQSxDQUFDQSxHQUFHQSxLQUFLQSxDQUFDQSxDQUFDQSxDQUFDQSxDQUFDQSxDQUFDQTtZQUNsQkEsSUFBSUEsS0FBS0EsR0FBR0EsRUFBRUEsR0FBR0EsRUFBRUEsR0FBR0EsRUFBRUEsTUFBTUEsRUFBRUEsTUFBTUEsRUFBRUEsQ0FBQ0E7UUFDN0NBLENBQUNBO1FBQ0RBLElBQUlBLENBQUNBLENBQUNBO1lBQ0ZBLElBQUlBLEdBQUdBLEdBQUdBLEVBQUVBLEdBQUdBLEVBQUVBLEdBQUdBLEVBQUVBLE1BQU1BLEVBQUVBLE1BQU1BLEVBQUVBLENBQUNBO1FBQzNDQSxDQUFDQTtRQUNEQSxNQUFNQSxDQUFDQSxLQUFLQSxDQUFDQSxVQUFVQSxDQUFDQSxLQUFLQSxJQUFJQSxJQUFJQSxDQUFDQSxLQUFLQSxFQUFFQSxHQUFHQSxJQUFJQSxJQUFJQSxDQUFDQSxHQUFHQSxDQUFDQSxDQUFDQTtJ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QUNBLE1BQU1BLEVBQUVBLEdBQUdBLENBQUNBLEdBQUdBLEVBQUVBLEdBQUdBLENBQUNBLE1BQU1BLENBQUNBLENBQUNBO0lBQ25FQSxDQUFDQTtJQUVNNUIsbUJBQWFBLEdBQXBCQSxVQUFxQkEsRUFBbUNBLEVBQUVBLEVBQW1DQTtRQUN6RjZCLE1BQU1BLENBQUNBLEVBQUVBLENBQUNBLEdBQUdBLEdBQUdBLEVBQUVBLENBQUNBLEdBQUdBLElBQUlBLEVBQUVBLENBQUNBLE1BQU1BLEdBQUdBLEVBQUVBLENBQUNBLE1BQU1BLENBQUNBO0lBQ3BEQSxDQUFDQTtJQUNMN0IsWUFBQ0E7QUFBREEsQ0FBQ0EsQUFsZ0JELElBa2dCQztBQWxnQlksYUFBSyxRQWtnQmpCLENBQUE7QUFFRDtJQUFtQzhCLGlDQUFLQTtJQUdwQ0EsdUJBQVlBLFFBQWdCQSxFQUFFQSxXQUFtQkEsRUFBRUEsTUFBY0EsRUFBRUEsU0FBaUJBLEVBQUVBLE1BQU1BLEVBQUVBLGFBQWFBO1FBQ3ZHQyxrQkFBTUEsUUFBUUEsRUFBRUEsV0FBV0EsRUFBRUEsTUFBTUEsRUFBRUEsU0FBU0EsQ0FBQ0EsQ0FBQ0E7UUFDaERBLElBQUlBLENBQUNBLE1BQU1BLEdBQUdBLE1BQU1BLENBQUNBO1FBQ3JCQSxJQUFJQSxDQUFDQSxhQUFhQSxHQUFHQSxhQUFhQSxDQUFDQTtJQUN2Q0EsQ0FBQ0E7SUFDTEQsb0JBQUNBO0FBQURBLENBQUNBLEFBUkQsRUFBbUMsS0FBSyxFQVF2QztBQVJZLHFCQUFhLGdCQVF6QixDQUFBIiwic291cmNlc0NvbnRlbnQiOlsiLyogKioqKiogQkVHSU4gTElDRU5TRSBCTE9DSyAqKioqKlxuICogRGlzdHJpYnV0ZWQgdW5kZXIgdGhlIEJTRCBsaWNlbnNlOlxuICpcbiAqIENvcHlyaWdodCAoYykgMjAxMCwgQWpheC5vcmcgQi5WLlxuICogQWxsIHJpZ2h0cyByZXNlcnZlZC5cbiAqXG4gKiBSZWRpc3RyaWJ1dGlvbiBhbmQgdXNlIGluIHNvdXJjZSBhbmQgYmluYXJ5IGZvcm1zLCB3aXRoIG9yIHdpdGhvdXRcbiAqIG1vZGlmaWNhdGlvbiwgYXJlIHBlcm1pdHRlZCBwcm92aWRlZCB0aGF0IHRoZSBmb2xsb3dpbmcgY29uZGl0aW9ucyBhcmUgbWV0OlxuICogICAgICogUmVkaXN0cmlidXRpb25zIG9mIHNvdXJjZSBjb2RlIG11c3QgcmV0YWluIHRoZSBhYm92ZSBjb3B5cmlnaHRcbiAqICAgICAgIG5vdGljZSwgdGhpcyBsaXN0IG9mIGNvbmRpdGlvbnMgYW5kIHRoZSBmb2xsb3dpbmcgZGlzY2xhaW1lci5cbiAqICAgICAqIFJlZGlzdHJpYnV0aW9ucyBpbiBiaW5hcnkgZm9ybSBtdXN0IHJlcHJvZHVjZSB0aGUgYWJvdmUgY29weXJpZ2h0XG4gKiAgICAgICBub3RpY2UsIHRoaXMgbGlzdCBvZiBjb25kaXRpb25zIGFuZCB0aGUgZm9sbG93aW5nIGRpc2NsYWltZXIgaW4gdGhlXG4gKiAgICAgICBkb2N1bWVudGF0aW9uIGFuZC9vciBvdGhlciBtYXRlcmlhbHMgcHJvdmlkZWQgd2l0aCB0aGUgZGlzdHJpYnV0aW9uLlxuICogICAgICogTmVpdGhlciB0aGUgbmFtZSBvZiBBamF4Lm9yZyBCLlYuIG5vciB0aGVcbiAqICAgICAgIG5hbWVzIG9mIGl0cyBjb250cmlidXRvcnMgbWF5IGJlIHVzZWQgdG8gZW5kb3JzZSBvciBwcm9tb3RlIHByb2R1Y3RzXG4gKiAgICAgICBkZXJpdmVkIGZyb20gdGhpcyBzb2Z0d2FyZSB3aXRob3V0IHNwZWNpZmljIHByaW9yIHdyaXR0ZW4gcGVybWlzc2lvbi5cbiAqXG4gKiBUSElTIFNPRlRXQVJFIElTIFBST1ZJREVEIEJZIFRIRSBDT1BZUklHSFQgSE9MREVSUyBBTkQgQ09OVFJJQlVUT1JTIFwiQVMgSVNcIiBBTkRcbiAqIEFOWSBFWFBSRVNTIE9SIElNUExJRUQgV0FSUkFOVElFUywgSU5DTFVESU5HLCBCVVQgTk9UIExJTUlURUQgVE8sIFRIRSBJTVBMSUVEXG4gKiBXQVJSQU5USUVTIE9GIE1FUkNIQU5UQUJJTElUWSBBTkQgRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UgQVJFXG4gKiBESVNDTEFJTUVELiBJTiBOTyBFVkVOVCBTSEFMTCBBSkFYLk9SRyBCLlYuIEJFIExJQUJMRSBGT1IgQU5ZXG4gKiBESVJFQ1QsIElORElSRUNULCBJTkNJREVOVEFMLCBTUEVDSUFMLCBFWEVNUExBUlksIE9SIENPTlNFUVVFTlRJQUwgREFNQUdFU1xuICogKElOQ0xVRElORywgQlVUIE5PVCBMSU1JVEVEIFRPLCBQUk9DVVJFTUVOVCBPRiBTVUJTVElUVVRFIEdPT0RTIE9SIFNFUlZJQ0VTO1xuICogTE9TUyBPRiBVU0UsIERBVEEsIE9SIFBST0ZJVFM7IE9SIEJVU0lORVNTIElOVEVSUlVQVElPTikgSE9XRVZFUiBDQVVTRUQgQU5EXG4gKiBPTiBBTlkgVEhFT1JZIE9GIExJQUJJTElUWSwgV0hFVEhFUiBJTiBDT05UUkFDVCwgU1RSSUNUIExJQUJJTElUWSwgT1IgVE9SVFxuICogKElOQ0xVRElORyBORUdMSUdFTkNFIE9SIE9USEVSV0lTRSkgQVJJU0lORyBJTiBBTlkgV0FZIE9VVCBPRiBUSEUgVVNFIE9GIFRISVNcbiAqIFNPRlRXQVJFLCBFVkVOIElGIEFEVklTRUQgT0YgVEhFIFBPU1NJQklMSVRZIE9GIFNVQ0ggREFNQUdFLlxuICpcbiAqICoqKioqIEVORCBMSUNFTlNFIEJMT0NLICoqKioqICovXG5pbXBvcnQgZXNtID0gcmVxdWlyZSgnLi9lZGl0X3Nlc3Npb24nKTtcblxuZXhwb3J0IHZhciBjb21wYXJlUG9pbnRzID0gZnVuY3Rpb24ocDE6IHsgcm93OiBudW1iZXI7IGNvbHVtbjogbnVtYmVyIH0sIHAyOiB7IHJvdzogbnVtYmVyOyBjb2x1bW46IG51bWJlciB9KSB7XG4gICAgcmV0dXJuIHAxLnJvdyAtIHAyLnJvdyB8fCBwMS5jb2x1bW4gLSBwMi5jb2x1bW47XG59O1xuLyoqXG4gKiBUaGlzIG9iamVjdCBpcyB1c2VkIGluIHZhcmlvdXMgcGxhY2VzIHRvIGluZGljYXRlIGEgcmVnaW9uIHdpdGhpbiB0aGUgZWRpdG9yLiBUbyBiZXR0ZXIgdmlzdWFsaXplIGhvdyB0aGlzIHdvcmtzLCBpbWFnaW5lIGEgcmVjdGFuZ2xlLiBFYWNoIHF1YWRyYW50IG9mIHRoZSByZWN0YW5nbGUgaXMgYW5hbG9ndXMgdG8gYSByYW5nZSwgYXMgcmFuZ2VzIGNvbnRhaW4gYSBzdGFydGluZyByb3cgYW5kIHN0YXJ0aW5nIGNvbHVtbiwgYW5kIGFuIGVuZGluZyByb3csIGFuZCBlbmRpbmcgY29sdW1uLlxuICogQGNsYXNzIFJhbmdlXG4gKiovXG5cbi8qKlxuICogQ3JlYXRlcyBhIG5ldyBgRWRpdG9yUmFuZ2VgIG9iamVjdCB3aXRoIHRoZSBnaXZlbiBzdGFydGluZyBhbmQgZW5kaW5nIHJvdyBhbmQgY29sdW1uIHBvaW50cy5cbiAqIEBwYXJhbSB7TnVtYmVyfSBzdGFydFJvdyBUaGUgc3RhcnRpbmcgcm93XG4gKiBAcGFyYW0ge051bWJlcn0gc3RhcnRDb2x1bW4gVGhlIHN0YXJ0aW5nIGNvbHVtblxuICogQHBhcmFtIHtOdW1iZXJ9IGVuZFJvdyBUaGUgZW5kaW5nIHJvd1xuICogQHBhcmFtIHtOdW1iZXJ9IGVuZENvbHVtbiBUaGUgZW5kaW5nIGNvbHVtblxuICpcbiAqIEBjb25zdHJ1Y3RvclxuICoqL1xuZXhwb3J0IGNsYXNzIFJhbmdlIHtcbiAgICBwdWJsaWMgc3RhcnQ6IHsgcm93OiBudW1iZXI7IGNvbHVtbjogbnVtYmVyIH07XG4gICAgcHVibGljIGVuZDogeyByb3c6IG51bWJlcjsgY29sdW1uOiBudW1iZXIgfTtcbiAgICAvLyAgcHVibGljIGN1cnNvcjogUmFuZ2U7XG4gICAgLy8gIHB1YmxpYyBpc0JhY2t3YXJkczogYm9vbGVhbjtcbiAgICAvKipcbiAgICAgKiBAY2xhc3MgUmFuZ2VcbiAgICAgKiBAY29uc3RydWN0b3JcbiAgICAgKi9cbiAgICBjb25zdHJ1Y3RvcihzdGFydFJvdzogbnVtYmVyLCBzdGFydENvbHVtbjogbnVtYmVyLCBlbmRSb3c6IG51bWJlciwgZW5kQ29sdW1uOiBudW1iZXIpIHtcbiAgICAgICAgdGhpcy5zdGFydCA9IHtcbiAgICAgICAgICAgIHJvdzogc3RhcnRSb3csXG4gICAgICAgICAgICBjb2x1bW46IHN0YXJ0Q29sdW1uXG4gICAgICAgIH07XG5cbiAgICAgICAgdGhpcy5lbmQgPSB7XG4gICAgICAgICAgICByb3c6IGVuZFJvdyxcbiAgICAgICAgICAgIGNvbHVtbjogZW5kQ29sdW1uXG4gICAgICAgIH07XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJldHVybnMgYHRydWVgIGlmIGFuZCBvbmx5IGlmIHRoZSBzdGFydGluZyByb3cgYW5kIGNvbHVtbiwgYW5kIGVuZGluZyByb3cgYW5kIGNvbHVtbiwgYXJlIGVxdWl2YWxlbnQgdG8gdGhvc2UgZ2l2ZW4gYnkgYHJhbmdlYC5cbiAgICAgKiBAcGFyYW0ge0VkaXRvclJhbmdlfSByYW5nZSBBIHJhbmdlIHRvIGNoZWNrIGFnYWluc3RcbiAgICAgKlxuICAgICAqIEByZXR1cm4ge0Jvb2xlYW59XG4gICAgICoqL1xuICAgIGlzRXF1YWwocmFuZ2U6IFJhbmdlKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnN0YXJ0LnJvdyA9PT0gcmFuZ2Uuc3RhcnQucm93ICYmXG4gICAgICAgICAgICB0aGlzLmVuZC5yb3cgPT09IHJhbmdlLmVuZC5yb3cgJiZcbiAgICAgICAgICAgIHRoaXMuc3RhcnQuY29sdW1uID09PSByYW5nZS5zdGFydC5jb2x1bW4gJiZcbiAgICAgICAgICAgIHRoaXMuZW5kLmNvbHVtbiA9PT0gcmFuZ2UuZW5kLmNvbHVtbjtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKlxuICAgICAqIFJldHVybnMgYSBzdHJpbmcgY29udGFpbmluZyB0aGUgcmFuZ2UncyByb3cgYW5kIGNvbHVtbiBpbmZvcm1hdGlvbiwgZ2l2ZW4gbGlrZSB0aGlzOlxuICAgICAqIGBgYFxuICAgICAqICAgIFtzdGFydC5yb3cvc3RhcnQuY29sdW1uXSAtPiBbZW5kLnJvdy9lbmQuY29sdW1uXVxuICAgICAqIGBgYFxuICAgICAqIEByZXR1cm4ge1N0cmluZ31cbiAgICAgKiovXG4gICAgdG9TdHJpbmcoKSB7XG4gICAgICAgIHJldHVybiAoXCJSYW5nZTogW1wiICsgdGhpcy5zdGFydC5yb3cgKyBcIi9cIiArIHRoaXMuc3RhcnQuY29sdW1uICtcbiAgICAgICAgICAgIFwiXSAtPiBbXCIgKyB0aGlzLmVuZC5yb3cgKyBcIi9cIiArIHRoaXMuZW5kLmNvbHVtbiArIFwiXVwiKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKlxuICAgICAqIFJldHVybnMgYHRydWVgIGlmIHRoZSBgcm93YCBhbmQgYGNvbHVtbmAgcHJvdmlkZWQgYXJlIHdpdGhpbiB0aGUgZ2l2ZW4gcmFuZ2UuIFRoaXMgY2FuIGJldHRlciBiZSBleHByZXNzZWQgYXMgcmV0dXJuaW5nIGB0cnVlYCBpZjpcbiAgICAgKiBgYGBqYXZhc2NyaXB0XG4gICAgICogICAgdGhpcy5zdGFydC5yb3cgPD0gcm93IDw9IHRoaXMuZW5kLnJvdyAmJlxuICAgICAqICAgIHRoaXMuc3RhcnQuY29sdW1uIDw9IGNvbHVtbiA8PSB0aGlzLmVuZC5jb2x1bW5cbiAgICAgKiBgYGBcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gcm93IEEgcm93IHRvIGNoZWNrIGZvclxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBjb2x1bW4gQSBjb2x1bW4gdG8gY2hlY2sgZm9yXG4gICAgICogQHJldHVybnMge0Jvb2xlYW59XG4gICAgICogQHJlbGF0ZWQgRWRpdG9yUmFuZ2UuY29tcGFyZVxuICAgICAqKi9cblxuICAgIGNvbnRhaW5zKHJvdzogbnVtYmVyLCBjb2x1bW46IG51bWJlcik6IGJvb2xlYW4ge1xuICAgICAgICByZXR1cm4gdGhpcy5jb21wYXJlKHJvdywgY29sdW1uKSA9PT0gMDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDb21wYXJlcyBgdGhpc2AgcmFuZ2UgKEEpIHdpdGggYW5vdGhlciByYW5nZSAoQikuXG4gICAgICogQHBhcmFtIHtFZGl0b3JSYW5nZX0gcmFuZ2UgQSByYW5nZSB0byBjb21wYXJlIHdpdGhcbiAgICAgKlxuICAgICAqIEByZWxhdGVkIEVkaXRvclJhbmdlLmNvbXBhcmVcbiAgICAgKiBAcmV0dXJucyB7TnVtYmVyfSBUaGlzIG1ldGhvZCByZXR1cm5zIG9uZSBvZiB0aGUgZm9sbG93aW5nIG51bWJlcnM6PGJyLz5cbiAgICAgKiA8YnIvPlxuICAgICAqICogYC0yYDogKEIpIGlzIGluIGZyb250IG9mIChBKSwgYW5kIGRvZXNuJ3QgaW50ZXJzZWN0IHdpdGggKEEpPGJyLz5cbiAgICAgKiAqIGAtMWA6IChCKSBiZWdpbnMgYmVmb3JlIChBKSBidXQgZW5kcyBpbnNpZGUgb2YgKEEpPGJyLz5cbiAgICAgKiAqIGAwYDogKEIpIGlzIGNvbXBsZXRlbHkgaW5zaWRlIG9mIChBKSBPUiAoQSkgaXMgY29tcGxldGVseSBpbnNpZGUgb2YgKEIpPGJyLz5cbiAgICAgKiAqIGArMWA6IChCKSBiZWdpbnMgaW5zaWRlIG9mIChBKSBidXQgZW5kcyBvdXRzaWRlIG9mIChBKTxici8+XG4gICAgICogKiBgKzJgOiAoQikgaXMgYWZ0ZXIgKEEpIGFuZCBkb2Vzbid0IGludGVyc2VjdCB3aXRoIChBKTxici8+XG4gICAgICogKiBgNDJgOiBGVFcgc3RhdGU6IChCKSBlbmRzIGluIChBKSBidXQgc3RhcnRzIG91dHNpZGUgb2YgKEEpXG4gICAgICoqL1xuICAgIGNvbXBhcmVSYW5nZShyYW5nZTogUmFuZ2UpOiBudW1iZXIge1xuICAgICAgICB2YXIgY21wOiBudW1iZXJcbiAgICAgICAgdmFyIGVuZCA9IHJhbmdlLmVuZDtcbiAgICAgICAgdmFyIHN0YXJ0ID0gcmFuZ2Uuc3RhcnQ7XG5cbiAgICAgICAgY21wID0gdGhpcy5jb21wYXJlKGVuZC5yb3csIGVuZC5jb2x1bW4pO1xuICAgICAgICBpZiAoY21wID09PSAxKSB7XG4gICAgICAgICAgICBjbXAgPSB0aGlzLmNvbXBhcmUoc3RhcnQucm93LCBzdGFydC5jb2x1bW4pO1xuICAgICAgICAgICAgaWYgKGNtcCA9PT0gMSkge1xuICAgICAgICAgICAgICAgIHJldHVybiAyO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAoY21wID09PSAwKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIDE7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gMDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChjbXAgPT09IC0xKSB7XG4gICAgICAgICAgICByZXR1cm4gLTI7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBjbXAgPSB0aGlzLmNvbXBhcmUoc3RhcnQucm93LCBzdGFydC5jb2x1bW4pO1xuICAgICAgICAgICAgaWYgKGNtcCA9PT0gLTEpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gLTE7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChjbXAgPT09IDEpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gNDI7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gMDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENoZWNrcyB0aGUgcm93IGFuZCBjb2x1bW4gcG9pbnRzIG9mIGBwYCB3aXRoIHRoZSByb3cgYW5kIGNvbHVtbiBwb2ludHMgb2YgdGhlIGNhbGxpbmcgcmFuZ2UuXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge0VkaXRvclJhbmdlfSBwIEEgcG9pbnQgdG8gY29tcGFyZSB3aXRoXG4gICAgICpcbiAgICAgKiBAcmVsYXRlZCBFZGl0b3JSYW5nZS5jb21wYXJlXG4gICAgICogQHJldHVybnMge051bWJlcn0gVGhpcyBtZXRob2QgcmV0dXJucyBvbmUgb2YgdGhlIGZvbGxvd2luZyBudW1iZXJzOjxici8+XG4gICAgICogKiBgMGAgaWYgdGhlIHR3byBwb2ludHMgYXJlIGV4YWN0bHkgZXF1YWw8YnIvPlxuICAgICAqICogYC0xYCBpZiBgcC5yb3dgIGlzIGxlc3MgdGhlbiB0aGUgY2FsbGluZyByYW5nZTxici8+XG4gICAgICogKiBgMWAgaWYgYHAucm93YCBpcyBncmVhdGVyIHRoYW4gdGhlIGNhbGxpbmcgcmFuZ2U8YnIvPlxuICAgICAqIDxici8+XG4gICAgICogSWYgdGhlIHN0YXJ0aW5nIHJvdyBvZiB0aGUgY2FsbGluZyByYW5nZSBpcyBlcXVhbCB0byBgcC5yb3dgLCBhbmQ6PGJyLz5cbiAgICAgKiAqIGBwLmNvbHVtbmAgaXMgZ3JlYXRlciB0aGFuIG9yIGVxdWFsIHRvIHRoZSBjYWxsaW5nIHJhbmdlJ3Mgc3RhcnRpbmcgY29sdW1uLCB0aGlzIHJldHVybnMgYDBgPGJyLz5cbiAgICAgKiAqIE90aGVyd2lzZSwgaXQgcmV0dXJucyAtMTxici8+XG4gICAgICo8YnIvPlxuICAgICAqIElmIHRoZSBlbmRpbmcgcm93IG9mIHRoZSBjYWxsaW5nIHJhbmdlIGlzIGVxdWFsIHRvIGBwLnJvd2AsIGFuZDo8YnIvPlxuICAgICAqICogYHAuY29sdW1uYCBpcyBsZXNzIHRoYW4gb3IgZXF1YWwgdG8gdGhlIGNhbGxpbmcgcmFuZ2UncyBlbmRpbmcgY29sdW1uLCB0aGlzIHJldHVybnMgYDBgPGJyLz5cbiAgICAgKiAqIE90aGVyd2lzZSwgaXQgcmV0dXJucyAxPGJyLz5cbiAgICAgKiovXG4gICAgY29tcGFyZVBvaW50KHA6IHsgcm93OiBudW1iZXI7IGNvbHVtbjogbnVtYmVyIH0pOiBudW1iZXIge1xuICAgICAgICByZXR1cm4gdGhpcy5jb21wYXJlKHAucm93LCBwLmNvbHVtbik7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ2hlY2tzIHRoZSBzdGFydCBhbmQgZW5kIHBvaW50cyBvZiBgcmFuZ2VgIGFuZCBjb21wYXJlcyB0aGVtIHRvIHRoZSBjYWxsaW5nIHJhbmdlLiBSZXR1cm5zIGB0cnVlYCBpZiB0aGUgYHJhbmdlYCBpcyBjb250YWluZWQgd2l0aGluIHRoZSBjYWxsZXIncyByYW5nZS5cbiAgICAgKiBAcGFyYW0ge0VkaXRvclJhbmdlfSByYW5nZSBBIHJhbmdlIHRvIGNvbXBhcmUgd2l0aFxuICAgICAqXG4gICAgICogQHJldHVybnMge0Jvb2xlYW59XG4gICAgICogQHJlbGF0ZWQgRWRpdG9yUmFuZ2UuY29tcGFyZVBvaW50XG4gICAgICoqL1xuICAgIGNvbnRhaW5zUmFuZ2UocmFuZ2U6IFJhbmdlKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmNvbXBhcmVQb2ludChyYW5nZS5zdGFydCkgPT09IDAgJiYgdGhpcy5jb21wYXJlUG9pbnQocmFuZ2UuZW5kKSA9PT0gMDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIGB0cnVlYCBpZiBwYXNzZWQgaW4gYHJhbmdlYCBpbnRlcnNlY3RzIHdpdGggdGhlIG9uZSBjYWxsaW5nIHRoaXMgbWV0aG9kLlxuICAgICAqIEBwYXJhbSB7RWRpdG9yUmFuZ2V9IHJhbmdlIEEgcmFuZ2UgdG8gY29tcGFyZSB3aXRoXG4gICAgICpcbiAgICAgKiBAcmV0dXJucyB7Qm9vbGVhbn1cbiAgICAgKiovXG4gICAgaW50ZXJzZWN0cyhyYW5nZTogUmFuZ2UpIHtcbiAgICAgICAgdmFyIGNtcCA9IHRoaXMuY29tcGFyZVJhbmdlKHJhbmdlKTtcbiAgICAgICAgcmV0dXJuIChjbXAgPT09IC0xIHx8IGNtcCA9PT0gMCB8fCBjbXAgPT09IDEpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFJldHVybnMgYHRydWVgIGlmIHRoZSBjYWxsZXIncyBlbmRpbmcgcm93IHBvaW50IGlzIHRoZSBzYW1lIGFzIGByb3dgLCBhbmQgaWYgdGhlIGNhbGxlcidzIGVuZGluZyBjb2x1bW4gaXMgdGhlIHNhbWUgYXMgYGNvbHVtbmAuXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IHJvdyBBIHJvdyBwb2ludCB0byBjb21wYXJlIHdpdGhcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gY29sdW1uIEEgY29sdW1uIHBvaW50IHRvIGNvbXBhcmUgd2l0aFxuICAgICAqXG4gICAgICogQHJldHVybnMge0Jvb2xlYW59XG4gICAgICoqL1xuICAgIGlzRW5kKHJvdzogbnVtYmVyLCBjb2x1bW46IG51bWJlcik6IGJvb2xlYW4ge1xuICAgICAgICByZXR1cm4gdGhpcy5lbmQucm93ID09PSByb3cgJiYgdGhpcy5lbmQuY29sdW1uID09PSBjb2x1bW47XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogUmV0dXJucyBgdHJ1ZWAgaWYgdGhlIGNhbGxlcidzIHN0YXJ0aW5nIHJvdyBwb2ludCBpcyB0aGUgc2FtZSBhcyBgcm93YCwgYW5kIGlmIHRoZSBjYWxsZXIncyBzdGFydGluZyBjb2x1bW4gaXMgdGhlIHNhbWUgYXMgYGNvbHVtbmAuXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IHJvdyBBIHJvdyBwb2ludCB0byBjb21wYXJlIHdpdGhcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gY29sdW1uIEEgY29sdW1uIHBvaW50IHRvIGNvbXBhcmUgd2l0aFxuICAgICAqXG4gICAgICogQHJldHVybnMge0Jvb2xlYW59XG4gICAgICoqL1xuICAgIGlzU3RhcnQocm93OiBudW1iZXIsIGNvbHVtbjogbnVtYmVyKTogYm9vbGVhbiB7XG4gICAgICAgIHJldHVybiB0aGlzLnN0YXJ0LnJvdyA9PT0gcm93ICYmIHRoaXMuc3RhcnQuY29sdW1uID09PSBjb2x1bW47XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogU2V0cyB0aGUgc3RhcnRpbmcgcm93IGFuZCBjb2x1bW4gZm9yIHRoZSByYW5nZS5cbiAgICAgKiBAcGFyYW0gcm93IHtudW1iZXJ9IEEgcm93IHBvaW50IHRvIHNldFxuICAgICAqIEBwYXJhbSBjb2x1bW4ge251bWJlcn0gQSBjb2x1bW4gcG9pbnQgdG8gc2V0XG4gICAgICpcbiAgICAgKiovXG4gICAgc2V0U3RhcnQocm93OiBudW1iZXIsIGNvbHVtbjogbnVtYmVyKTogdm9pZCB7XG4gICAgICAgIGlmICh0eXBlb2Ygcm93ID09PSBcIm9iamVjdFwiKSB7XG4gICAgICAgICAgICAvLyBGYWxsYmFjayB1bnRpbCBjb2RlIGlzIGNvbXBsZXRlbHkgdHlwZWQuXG4gICAgICAgICAgICB0aGlzLnN0YXJ0LmNvbHVtbiA9IHJvd1snY29sdW1uJ107XG4gICAgICAgICAgICB0aGlzLnN0YXJ0LnJvdyA9IHJvd1sncm93J107XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0aGlzLnN0YXJ0LnJvdyA9IHJvdztcbiAgICAgICAgICAgIHRoaXMuc3RhcnQuY29sdW1uID0gY29sdW1uO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogU2V0cyB0aGUgc3RhcnRpbmcgcm93IGFuZCBjb2x1bW4gZm9yIHRoZSByYW5nZS5cbiAgICAgKiBAcGFyYW0gcm93IHtudW1iZXJ9IEEgcm93IHBvaW50IHRvIHNldFxuICAgICAqIEBwYXJhbSBjb2x1bW4ge251bWJlcn0gQSBjb2x1bW4gcG9pbnQgdG8gc2V0XG4gICAgICpcbiAgICAgKiovXG4gICAgc2V0RW5kKHJvdzogbnVtYmVyLCBjb2x1bW46IG51bWJlcik6IHZvaWQge1xuICAgICAgICBpZiAodHlwZW9mIHJvdyA9PT0gXCJvYmplY3RcIikge1xuICAgICAgICAgICAgLy8gRmFsbGJhY2sgdW50aWwgY29kZSBpcyBjb21wbGV0ZWx5IHR5cGVkLlxuICAgICAgICAgICAgdGhpcy5lbmQuY29sdW1uID0gcm93Wydjb2x1bW4nXTtcbiAgICAgICAgICAgIHRoaXMuZW5kLnJvdyA9IHJvd1sncm93J107XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0aGlzLmVuZC5yb3cgPSByb3c7XG4gICAgICAgICAgICB0aGlzLmVuZC5jb2x1bW4gPSBjb2x1bW47XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIGB0cnVlYCBpZiB0aGUgYHJvd2AgYW5kIGBjb2x1bW5gIGFyZSB3aXRoaW4gdGhlIGdpdmVuIHJhbmdlLlxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSByb3cgQSByb3cgcG9pbnQgdG8gY29tcGFyZSB3aXRoXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IGNvbHVtbiBBIGNvbHVtbiBwb2ludCB0byBjb21wYXJlIHdpdGhcbiAgICAgKlxuICAgICAqXG4gICAgICogQHJldHVybnMge0Jvb2xlYW59XG4gICAgICogQHJlbGF0ZWQgRWRpdG9yUmFuZ2UuY29tcGFyZVxuICAgICAqKi9cbiAgICBpbnNpZGUocm93OiBudW1iZXIsIGNvbHVtbjogbnVtYmVyKTogYm9vbGVhbiB7XG4gICAgICAgIGlmICh0aGlzLmNvbXBhcmUocm93LCBjb2x1bW4pID09PSAwKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5pc0VuZChyb3csIGNvbHVtbikgfHwgdGhpcy5pc1N0YXJ0KHJvdywgY29sdW1uKSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIGB0cnVlYCBpZiB0aGUgYHJvd2AgYW5kIGBjb2x1bW5gIGFyZSB3aXRoaW4gdGhlIGdpdmVuIHJhbmdlJ3Mgc3RhcnRpbmcgcG9pbnRzLlxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSByb3cgQSByb3cgcG9pbnQgdG8gY29tcGFyZSB3aXRoXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IGNvbHVtbiBBIGNvbHVtbiBwb2ludCB0byBjb21wYXJlIHdpdGhcbiAgICAgKlxuICAgICAqIEByZXR1cm5zIHtCb29sZWFufVxuICAgICAqIEByZWxhdGVkIEVkaXRvclJhbmdlLmNvbXBhcmVcbiAgICAgKiovXG4gICAgaW5zaWRlU3RhcnQocm93OiBudW1iZXIsIGNvbHVtbjogbnVtYmVyKTogYm9vbGVhbiB7XG4gICAgICAgIGlmICh0aGlzLmNvbXBhcmUocm93LCBjb2x1bW4pID09PSAwKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5pc0VuZChyb3csIGNvbHVtbikpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogUmV0dXJucyBgdHJ1ZWAgaWYgdGhlIGByb3dgIGFuZCBgY29sdW1uYCBhcmUgd2l0aGluIHRoZSBnaXZlbiByYW5nZSdzIGVuZGluZyBwb2ludHMuXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IHJvdyBBIHJvdyBwb2ludCB0byBjb21wYXJlIHdpdGhcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gY29sdW1uIEEgY29sdW1uIHBvaW50IHRvIGNvbXBhcmUgd2l0aFxuICAgICAqXG4gICAgICogQHJldHVybnMge0Jvb2xlYW59XG4gICAgICogQHJlbGF0ZWQgRWRpdG9yUmFuZ2UuY29tcGFyZVxuICAgICAqXG4gICAgICoqL1xuICAgIGluc2lkZUVuZChyb3c6IG51bWJlciwgY29sdW1uOiBudW1iZXIpOiBib29sZWFuIHtcbiAgICAgICAgaWYgKHRoaXMuY29tcGFyZShyb3csIGNvbHVtbikgPT09IDApIHtcbiAgICAgICAgICAgIGlmICh0aGlzLmlzU3RhcnQocm93LCBjb2x1bW4pKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENoZWNrcyB0aGUgcm93IGFuZCBjb2x1bW4gcG9pbnRzIHdpdGggdGhlIHJvdyBhbmQgY29sdW1uIHBvaW50cyBvZiB0aGUgY2FsbGluZyByYW5nZS5cbiAgICAgKiBAcGFyYW0ge051bWJlcn0gcm93IEEgcm93IHBvaW50IHRvIGNvbXBhcmUgd2l0aFxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBjb2x1bW4gQSBjb2x1bW4gcG9pbnQgdG8gY29tcGFyZSB3aXRoXG4gICAgICpcbiAgICAgKlxuICAgICAqIEByZXR1cm5zIHtOdW1iZXJ9IFRoaXMgbWV0aG9kIHJldHVybnMgb25lIG9mIHRoZSBmb2xsb3dpbmcgbnVtYmVyczo8YnIvPlxuICAgICAqIGAwYCBpZiB0aGUgdHdvIHBvaW50cyBhcmUgZXhhY3RseSBlcXVhbCA8YnIvPlxuICAgICAqIGAtMWAgaWYgYHAucm93YCBpcyBsZXNzIHRoZW4gdGhlIGNhbGxpbmcgcmFuZ2UgPGJyLz5cbiAgICAgKiBgMWAgaWYgYHAucm93YCBpcyBncmVhdGVyIHRoYW4gdGhlIGNhbGxpbmcgcmFuZ2UgPGJyLz5cbiAgICAgKiAgPGJyLz5cbiAgICAgKiBJZiB0aGUgc3RhcnRpbmcgcm93IG9mIHRoZSBjYWxsaW5nIHJhbmdlIGlzIGVxdWFsIHRvIGBwLnJvd2AsIGFuZDogPGJyLz5cbiAgICAgKiBgcC5jb2x1bW5gIGlzIGdyZWF0ZXIgdGhhbiBvciBlcXVhbCB0byB0aGUgY2FsbGluZyByYW5nZSdzIHN0YXJ0aW5nIGNvbHVtbiwgdGhpcyByZXR1cm5zIGAwYDxici8+XG4gICAgICogT3RoZXJ3aXNlLCBpdCByZXR1cm5zIC0xPGJyLz5cbiAgICAgKiA8YnIvPlxuICAgICAqIElmIHRoZSBlbmRpbmcgcm93IG9mIHRoZSBjYWxsaW5nIHJhbmdlIGlzIGVxdWFsIHRvIGBwLnJvd2AsIGFuZDogPGJyLz5cbiAgICAgKiBgcC5jb2x1bW5gIGlzIGxlc3MgdGhhbiBvciBlcXVhbCB0byB0aGUgY2FsbGluZyByYW5nZSdzIGVuZGluZyBjb2x1bW4sIHRoaXMgcmV0dXJucyBgMGAgPGJyLz5cbiAgICAgKiBPdGhlcndpc2UsIGl0IHJldHVybnMgMVxuICAgICAqKi9cbiAgICBjb21wYXJlKHJvdzogbnVtYmVyLCBjb2x1bW46IG51bWJlcik6IG51bWJlciB7XG4gICAgICAgIGlmICghdGhpcy5pc011bHRpTGluZSgpKSB7XG4gICAgICAgICAgICBpZiAocm93ID09PSB0aGlzLnN0YXJ0LnJvdykge1xuICAgICAgICAgICAgICAgIHJldHVybiBjb2x1bW4gPCB0aGlzLnN0YXJ0LmNvbHVtbiA/IC0xIDogKGNvbHVtbiA+IHRoaXMuZW5kLmNvbHVtbiA/IDEgOiAwKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChyb3cgPCB0aGlzLnN0YXJ0LnJvdylcbiAgICAgICAgICAgIHJldHVybiAtMTtcblxuICAgICAgICBpZiAocm93ID4gdGhpcy5lbmQucm93KVxuICAgICAgICAgICAgcmV0dXJuIDE7XG5cbiAgICAgICAgaWYgKHRoaXMuc3RhcnQucm93ID09PSByb3cpXG4gICAgICAgICAgICByZXR1cm4gY29sdW1uID49IHRoaXMuc3RhcnQuY29sdW1uID8gMCA6IC0xO1xuXG4gICAgICAgIGlmICh0aGlzLmVuZC5yb3cgPT09IHJvdylcbiAgICAgICAgICAgIHJldHVybiBjb2x1bW4gPD0gdGhpcy5lbmQuY29sdW1uID8gMCA6IDE7XG5cbiAgICAgICAgcmV0dXJuIDA7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ2hlY2tzIHRoZSByb3cgYW5kIGNvbHVtbiBwb2ludHMgd2l0aCB0aGUgcm93IGFuZCBjb2x1bW4gcG9pbnRzIG9mIHRoZSBjYWxsaW5nIHJhbmdlLlxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSByb3cgQSByb3cgcG9pbnQgdG8gY29tcGFyZSB3aXRoXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IGNvbHVtbiBBIGNvbHVtbiBwb2ludCB0byBjb21wYXJlIHdpdGhcbiAgICAgKlxuICAgICAqIEByZXR1cm5zIHtOdW1iZXJ9IFRoaXMgbWV0aG9kIHJldHVybnMgb25lIG9mIHRoZSBmb2xsb3dpbmcgbnVtYmVyczo8YnIvPlxuICAgICAqIDxici8+XG4gICAgICogYDBgIGlmIHRoZSB0d28gcG9pbnRzIGFyZSBleGFjdGx5IGVxdWFsPGJyLz5cbiAgICAgKiBgLTFgIGlmIGBwLnJvd2AgaXMgbGVzcyB0aGVuIHRoZSBjYWxsaW5nIHJhbmdlPGJyLz5cbiAgICAgKiBgMWAgaWYgYHAucm93YCBpcyBncmVhdGVyIHRoYW4gdGhlIGNhbGxpbmcgcmFuZ2UsIG9yIGlmIGBpc1N0YXJ0YCBpcyBgdHJ1ZWAuPGJyLz5cbiAgICAgKiA8YnIvPlxuICAgICAqIElmIHRoZSBzdGFydGluZyByb3cgb2YgdGhlIGNhbGxpbmcgcmFuZ2UgaXMgZXF1YWwgdG8gYHAucm93YCwgYW5kOjxici8+XG4gICAgICogYHAuY29sdW1uYCBpcyBncmVhdGVyIHRoYW4gb3IgZXF1YWwgdG8gdGhlIGNhbGxpbmcgcmFuZ2UncyBzdGFydGluZyBjb2x1bW4sIHRoaXMgcmV0dXJucyBgMGA8YnIvPlxuICAgICAqIE90aGVyd2lzZSwgaXQgcmV0dXJucyAtMTxici8+XG4gICAgICogPGJyLz5cbiAgICAgKiBJZiB0aGUgZW5kaW5nIHJvdyBvZiB0aGUgY2FsbGluZyByYW5nZSBpcyBlcXVhbCB0byBgcC5yb3dgLCBhbmQ6PGJyLz5cbiAgICAgKiBgcC5jb2x1bW5gIGlzIGxlc3MgdGhhbiBvciBlcXVhbCB0byB0aGUgY2FsbGluZyByYW5nZSdzIGVuZGluZyBjb2x1bW4sIHRoaXMgcmV0dXJucyBgMGA8YnIvPlxuICAgICAqIE90aGVyd2lzZSwgaXQgcmV0dXJucyAxXG4gICAgICpcbiAgICAgKiovXG4gICAgY29tcGFyZVN0YXJ0KHJvdzogbnVtYmVyLCBjb2x1bW46IG51bWJlcik6IG51bWJlciB7XG4gICAgICAgIGlmICh0aGlzLnN0YXJ0LnJvdyA9PT0gcm93ICYmIHRoaXMuc3RhcnQuY29sdW1uID09PSBjb2x1bW4pIHtcbiAgICAgICAgICAgIHJldHVybiAtMTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmNvbXBhcmUocm93LCBjb2x1bW4pO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ2hlY2tzIHRoZSByb3cgYW5kIGNvbHVtbiBwb2ludHMgd2l0aCB0aGUgcm93IGFuZCBjb2x1bW4gcG9pbnRzIG9mIHRoZSBjYWxsaW5nIHJhbmdlLlxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSByb3cgQSByb3cgcG9pbnQgdG8gY29tcGFyZSB3aXRoXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IGNvbHVtbiBBIGNvbHVtbiBwb2ludCB0byBjb21wYXJlIHdpdGhcbiAgICAgKlxuICAgICAqXG4gICAgICogQHJldHVybnMge051bWJlcn0gVGhpcyBtZXRob2QgcmV0dXJucyBvbmUgb2YgdGhlIGZvbGxvd2luZyBudW1iZXJzOjxici8+XG4gICAgICogYDBgIGlmIHRoZSB0d28gcG9pbnRzIGFyZSBleGFjdGx5IGVxdWFsPGJyLz5cbiAgICAgKiBgLTFgIGlmIGBwLnJvd2AgaXMgbGVzcyB0aGVuIHRoZSBjYWxsaW5nIHJhbmdlPGJyLz5cbiAgICAgKiBgMWAgaWYgYHAucm93YCBpcyBncmVhdGVyIHRoYW4gdGhlIGNhbGxpbmcgcmFuZ2UsIG9yIGlmIGBpc0VuZGAgaXMgYHRydWUuPGJyLz5cbiAgICAgKiA8YnIvPlxuICAgICAqIElmIHRoZSBzdGFydGluZyByb3cgb2YgdGhlIGNhbGxpbmcgcmFuZ2UgaXMgZXF1YWwgdG8gYHAucm93YCwgYW5kOjxici8+XG4gICAgICogYHAuY29sdW1uYCBpcyBncmVhdGVyIHRoYW4gb3IgZXF1YWwgdG8gdGhlIGNhbGxpbmcgcmFuZ2UncyBzdGFydGluZyBjb2x1bW4sIHRoaXMgcmV0dXJucyBgMGA8YnIvPlxuICAgICAqIE90aGVyd2lzZSwgaXQgcmV0dXJucyAtMTxici8+XG4gICAgICo8YnIvPlxuICAgICAqIElmIHRoZSBlbmRpbmcgcm93IG9mIHRoZSBjYWxsaW5nIHJhbmdlIGlzIGVxdWFsIHRvIGBwLnJvd2AsIGFuZDo8YnIvPlxuICAgICAqIGBwLmNvbHVtbmAgaXMgbGVzcyB0aGFuIG9yIGVxdWFsIHRvIHRoZSBjYWxsaW5nIHJhbmdlJ3MgZW5kaW5nIGNvbHVtbiwgdGhpcyByZXR1cm5zIGAwYDxici8+XG4gICAgICogT3RoZXJ3aXNlLCBpdCByZXR1cm5zIDFcbiAgICAgKi9cbiAgICBjb21wYXJlRW5kKHJvdzogbnVtYmVyLCBjb2x1bW46IG51bWJlcik6IG51bWJlciB7XG4gICAgICAgIGlmICh0aGlzLmVuZC5yb3cgPT09IHJvdyAmJiB0aGlzLmVuZC5jb2x1bW4gPT09IGNvbHVtbikge1xuICAgICAgICAgICAgcmV0dXJuIDE7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5jb21wYXJlKHJvdywgY29sdW1uKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENoZWNrcyB0aGUgcm93IGFuZCBjb2x1bW4gcG9pbnRzIHdpdGggdGhlIHJvdyBhbmQgY29sdW1uIHBvaW50cyBvZiB0aGUgY2FsbGluZyByYW5nZS5cbiAgICAgKiBAcGFyYW0ge051bWJlcn0gcm93IEEgcm93IHBvaW50IHRvIGNvbXBhcmUgd2l0aFxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBjb2x1bW4gQSBjb2x1bW4gcG9pbnQgdG8gY29tcGFyZSB3aXRoXG4gICAgICpcbiAgICAgKlxuICAgICAqIEByZXR1cm5zIHtOdW1iZXJ9IFRoaXMgbWV0aG9kIHJldHVybnMgb25lIG9mIHRoZSBmb2xsb3dpbmcgbnVtYmVyczo8YnIvPlxuICAgICAqICogYDFgIGlmIHRoZSBlbmRpbmcgcm93IG9mIHRoZSBjYWxsaW5nIHJhbmdlIGlzIGVxdWFsIHRvIGByb3dgLCBhbmQgdGhlIGVuZGluZyBjb2x1bW4gb2YgdGhlIGNhbGxpbmcgcmFuZ2UgaXMgZXF1YWwgdG8gYGNvbHVtbmA8YnIvPlxuICAgICAqICogYC0xYCBpZiB0aGUgc3RhcnRpbmcgcm93IG9mIHRoZSBjYWxsaW5nIHJhbmdlIGlzIGVxdWFsIHRvIGByb3dgLCBhbmQgdGhlIHN0YXJ0aW5nIGNvbHVtbiBvZiB0aGUgY2FsbGluZyByYW5nZSBpcyBlcXVhbCB0byBgY29sdW1uYDxici8+XG4gICAgICogPGJyLz5cbiAgICAgKiBPdGhlcndpc2UsIGl0IHJldHVybnMgdGhlIHZhbHVlIGFmdGVyIGNhbGxpbmcgW1tFZGl0b3JSYW5nZS5jb21wYXJlIGBjb21wYXJlKClgXV0uXG4gICAgICpcbiAgICAgKiovXG4gICAgY29tcGFyZUluc2lkZShyb3c6IG51bWJlciwgY29sdW1uOiBudW1iZXIpOiBudW1iZXIge1xuICAgICAgICBpZiAodGhpcy5lbmQucm93ID09PSByb3cgJiYgdGhpcy5lbmQuY29sdW1uID09PSBjb2x1bW4pIHtcbiAgICAgICAgICAgIHJldHVybiAxO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKHRoaXMuc3RhcnQucm93ID09PSByb3cgJiYgdGhpcy5zdGFydC5jb2x1bW4gPT09IGNvbHVtbikge1xuICAgICAgICAgICAgcmV0dXJuIC0xO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuY29tcGFyZShyb3csIGNvbHVtbik7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIHRoZSBwYXJ0IG9mIHRoZSBjdXJyZW50IGBFZGl0b3JSYW5nZWAgdGhhdCBvY2N1cnMgd2l0aGluIHRoZSBib3VuZGFyaWVzIG9mIGBmaXJzdFJvd2AgYW5kIGBsYXN0Um93YCBhcyBhIG5ldyBgRWRpdG9yUmFuZ2VgIG9iamVjdC5cbiAgICAgKiBAcGFyYW0ge051bWJlcn0gZmlyc3RSb3cgVGhlIHN0YXJ0aW5nIHJvd1xuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBsYXN0Um93IFRoZSBlbmRpbmcgcm93XG4gICAgICogQHJldHVybnMge0VkaXRvclJhbmdlfVxuICAgICoqL1xuICAgIGNsaXBSb3dzKGZpcnN0Um93OiBudW1iZXIsIGxhc3RSb3c6IG51bWJlcik6IFJhbmdlIHtcbiAgICAgICAgdmFyIHN0YXJ0OiB7IHJvdzogbnVtYmVyOyBjb2x1bW46IG51bWJlciB9O1xuICAgICAgICB2YXIgZW5kOiB7IHJvdzogbnVtYmVyOyBjb2x1bW46IG51bWJlciB9O1xuICAgICAgICBpZiAodGhpcy5lbmQucm93ID4gbGFzdFJvdylcbiAgICAgICAgICAgIGVuZCA9IHsgcm93OiBsYXN0Um93ICsgMSwgY29sdW1uOiAwIH07XG4gICAgICAgIGVsc2UgaWYgKHRoaXMuZW5kLnJvdyA8IGZpcnN0Um93KVxuICAgICAgICAgICAgZW5kID0geyByb3c6IGZpcnN0Um93LCBjb2x1bW46IDAgfTtcblxuICAgICAgICBpZiAodGhpcy5zdGFydC5yb3cgPiBsYXN0Um93KVxuICAgICAgICAgICAgc3RhcnQgPSB7IHJvdzogbGFzdFJvdyArIDEsIGNvbHVtbjogMCB9O1xuICAgICAgICBlbHNlIGlmICh0aGlzLnN0YXJ0LnJvdyA8IGZpcnN0Um93KVxuICAgICAgICAgICAgc3RhcnQgPSB7IHJvdzogZmlyc3RSb3csIGNvbHVtbjogMCB9O1xuXG4gICAgICAgIHJldHVybiBSYW5nZS5mcm9tUG9pbnRzKHN0YXJ0IHx8IHRoaXMuc3RhcnQsIGVuZCB8fCB0aGlzLmVuZCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ2hhbmdlcyB0aGUgcm93IGFuZCBjb2x1bW4gcG9pbnRzIGZvciB0aGUgY2FsbGluZyByYW5nZSBmb3IgYm90aCB0aGUgc3RhcnRpbmcgYW5kIGVuZGluZyBwb2ludHMuXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IHJvdyBBIG5ldyByb3cgdG8gZXh0ZW5kIHRvXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IGNvbHVtbiBBIG5ldyBjb2x1bW4gdG8gZXh0ZW5kIHRvXG4gICAgICogQHJldHVybnMge0VkaXRvclJhbmdlfSBUaGUgb3JpZ2luYWwgcmFuZ2Ugd2l0aCB0aGUgbmV3IHJvd1xuICAgICoqL1xuICAgIGV4dGVuZChyb3c6IG51bWJlciwgY29sdW1uOiBudW1iZXIpOiBSYW5nZSB7XG4gICAgICAgIHZhciBjbXAgPSB0aGlzLmNvbXBhcmUocm93LCBjb2x1bW4pO1xuXG4gICAgICAgIGlmIChjbXAgPT09IDApIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKGNtcCA9PT0gLTEpIHtcbiAgICAgICAgICAgIHZhciBzdGFydCA9IHsgcm93OiByb3csIGNvbHVtbjogY29sdW1uIH07XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB2YXIgZW5kID0geyByb3c6IHJvdywgY29sdW1uOiBjb2x1bW4gfTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gUmFuZ2UuZnJvbVBvaW50cyhzdGFydCB8fCB0aGlzLnN0YXJ0LCBlbmQgfHwgdGhpcy5lbmQpO1xuICAgIH1cblxuICAgIGlzRW1wdHkoKTogYm9vbGVhbiB7XG4gICAgICAgIHJldHVybiAodGhpcy5zdGFydC5yb3cgPT09IHRoaXMuZW5kLnJvdyAmJiB0aGlzLnN0YXJ0LmNvbHVtbiA9PT0gdGhpcy5lbmQuY29sdW1uKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKlxuICAgICAqIFJldHVybnMgYHRydWVgIGlmIHRoZSByYW5nZSBzcGFucyBhY3Jvc3MgbXVsdGlwbGUgbGluZXMuXG4gICAgICogQHJldHVybnMge0Jvb2xlYW59XG4gICAgKiovXG4gICAgaXNNdWx0aUxpbmUoKTogYm9vbGVhbiB7XG4gICAgICAgIHJldHVybiAodGhpcy5zdGFydC5yb3cgIT09IHRoaXMuZW5kLnJvdyk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICpcbiAgICAgKiBSZXR1cm5zIGEgZHVwbGljYXRlIG9mIHRoZSBjYWxsaW5nIHJhbmdlLlxuICAgICAqIEByZXR1cm5zIHtFZGl0b3JSYW5nZX1cbiAgICAqKi9cbiAgICBjbG9uZSgpIHtcbiAgICAgICAgcmV0dXJuIFJhbmdlLmZyb21Qb2ludHModGhpcy5zdGFydCwgdGhpcy5lbmQpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqXG4gICAgICogUmV0dXJucyBhIHJhbmdlIGNvbnRhaW5pbmcgdGhlIHN0YXJ0aW5nIGFuZCBlbmRpbmcgcm93cyBvZiB0aGUgb3JpZ2luYWwgcmFuZ2UsIGJ1dCB3aXRoIGEgY29sdW1uIHZhbHVlIG9mIGAwYC5cbiAgICAgKiBAcmV0dXJucyB7RWRpdG9yUmFuZ2V9XG4gICAgKiovXG4gICAgY29sbGFwc2VSb3dzKCkge1xuICAgICAgICBpZiAodGhpcy5lbmQuY29sdW1uID09PSAwKVxuICAgICAgICAgICAgcmV0dXJuIG5ldyBSYW5nZSh0aGlzLnN0YXJ0LnJvdywgMCwgTWF0aC5tYXgodGhpcy5zdGFydC5yb3csIHRoaXMuZW5kLnJvdyAtIDEpLCAwKVxuICAgICAgICBlbHNlXG4gICAgICAgICAgICByZXR1cm4gbmV3IFJhbmdlKHRoaXMuc3RhcnQucm93LCAwLCB0aGlzLmVuZC5yb3csIDApXG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogR2l2ZW4gdGhlIGN1cnJlbnQgYEVkaXRvclJhbmdlYCwgdGhpcyBmdW5jdGlvbiBjb252ZXJ0cyB0aG9zZSBzdGFydGluZyBhbmQgZW5kaW5nIHBvaW50cyBpbnRvIHNjcmVlbiBwb3NpdGlvbnMsIGFuZCB0aGVuIHJldHVybnMgYSBuZXcgYEVkaXRvclJhbmdlYCBvYmplY3QuXG4gICAgICogQHBhcmFtIHtFZGl0U2Vzc2lvbn0gc2Vzc2lvbiBUaGUgYEVkaXRTZXNzaW9uYCB0byByZXRyaWV2ZSBjb29yZGluYXRlcyBmcm9tXG4gICAgICpcbiAgICAgKlxuICAgICAqIEByZXR1cm5zIHtFZGl0b3JSYW5nZX1cbiAgICAqKi9cbiAgICB0b1NjcmVlblJhbmdlKHNlc3Npb246IGVzbS5FZGl0U2Vzc2lvbikge1xuXG4gICAgICAgIHZhciBzY3JlZW5Qb3NTdGFydCA9IHNlc3Npb24uZG9jdW1lbnRUb1NjcmVlblBvc2l0aW9uKHRoaXMuc3RhcnQucm93LCB0aGlzLnN0YXJ0LmNvbHVtbik7XG4gICAgICAgIHZhciBzY3JlZW5Qb3NFbmQgPSBzZXNzaW9uLmRvY3VtZW50VG9TY3JlZW5Qb3NpdGlvbih0aGlzLmVuZC5yb3csIHRoaXMuZW5kLmNvbHVtbik7XG5cbiAgICAgICAgcmV0dXJuIG5ldyBSYW5nZShzY3JlZW5Qb3NTdGFydC5yb3csIHNjcmVlblBvc1N0YXJ0LmNvbHVtbiwgc2NyZWVuUG9zRW5kLnJvdywgc2NyZWVuUG9zRW5kLmNvbHVtbik7XG4gICAgfVxuXG4gICAgLyogZXhwZXJpbWVudGFsICovXG4gICAgbW92ZUJ5KHJvdzogbnVtYmVyLCBjb2x1bW46IG51bWJlcikge1xuICAgICAgICB0aGlzLnN0YXJ0LnJvdyArPSByb3c7XG4gICAgICAgIHRoaXMuc3RhcnQuY29sdW1uICs9IGNvbHVtbjtcbiAgICAgICAgdGhpcy5lbmQucm93ICs9IHJvdztcbiAgICAgICAgdGhpcy5lbmQuY29sdW1uICs9IGNvbHVtbjtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDcmVhdGVzIGFuZCByZXR1cm5zIGEgbmV3IGBFZGl0b3JSYW5nZWAgYmFzZWQgb24gdGhlIHJvdyBhbmQgY29sdW1uIG9mIHRoZSBnaXZlbiBwYXJhbWV0ZXJzLlxuICAgICAqIEBwYXJhbSB7RWRpdG9yUmFuZ2V9IHN0YXJ0IEEgc3RhcnRpbmcgcG9pbnQgdG8gdXNlXG4gICAgICogQHBhcmFtIHtFZGl0b3JSYW5nZX0gZW5kIEFuIGVuZGluZyBwb2ludCB0byB1c2VcbiAgICAgKlxuICAgICAqIEByZXR1cm5zIHtFZGl0b3JSYW5nZX1cbiAgICAqKi9cbiAgICBzdGF0aWMgZnJvbVBvaW50cyhzdGFydDogeyByb3c6IG51bWJlcjsgY29sdW1uOiBudW1iZXIgfSwgZW5kOiB7IHJvdzogbnVtYmVyOyBjb2x1bW46IG51bWJlciB9KSB7XG4gICAgICAgIHJldHVybiBuZXcgUmFuZ2Uoc3RhcnQucm93LCBzdGFydC5jb2x1bW4sIGVuZC5yb3csIGVuZC5jb2x1bW4pO1xuICAgIH1cblxuICAgIHN0YXRpYyBjb21wYXJlUG9pbnRzKHAxOiB7IHJvdzogbnVtYmVyOyBjb2x1bW46IG51bWJlciB9LCBwMjogeyByb3c6IG51bWJlcjsgY29sdW1uOiBudW1iZXIgfSkge1xuICAgICAgICByZXR1cm4gcDEucm93IC0gcDIucm93IHx8IHAxLmNvbHVtbiAtIHAyLmNvbHVtbjtcbiAgICB9XG59XG5cbmV4cG9ydCBjbGFzcyBPcmllbnRlZFJhbmdlIGV4dGVuZHMgUmFuZ2Uge1xuICAgIHB1YmxpYyBjdXJzb3I7XG4gICAgcHVibGljIGRlc2lyZWRDb2x1bW47XG4gICAgY29uc3RydWN0b3Ioc3RhcnRSb3c6IG51bWJlciwgc3RhcnRDb2x1bW46IG51bWJlciwgZW5kUm93OiBudW1iZXIsIGVuZENvbHVtbjogbnVtYmVyLCBjdXJzb3IsIGRlc2lyZWRDb2x1bW4pIHtcbiAgICAgICAgc3VwZXIoc3RhcnRSb3csIHN0YXJ0Q29sdW1uLCBlbmRSb3csIGVuZENvbHVtbik7XG4gICAgICAgIHRoaXMuY3Vyc29yID0gY3Vyc29yO1xuICAgICAgICB0aGlzLmRlc2lyZWRDb2x1bW4gPSBkZXNpcmVkQ29sdW1uO1xuICAgIH1cbn1cbiJdfQ==