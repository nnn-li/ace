var TokenIterator = (function () {
    function TokenIterator(session, initialRow, initialColumn) {
        this.$session = session;
        this.$row = initialRow;
        this.$rowTokens = session.getTokens(initialRow);
        var token = session.getTokenAt(initialRow, initialColumn);
        this.$tokenIndex = token ? token.index : -1;
    }
    TokenIterator.prototype.stepBackward = function () {
        this.$tokenIndex -= 1;
        while (this.$tokenIndex < 0) {
            this.$row -= 1;
            if (this.$row < 0) {
                this.$row = 0;
                return null;
            }
            this.$rowTokens = this.$session.getTokens(this.$row);
            this.$tokenIndex = this.$rowTokens.length - 1;
        }
        return this.$rowTokens[this.$tokenIndex];
    };
    TokenIterator.prototype.stepForward = function () {
        this.$tokenIndex += 1;
        var rowCount;
        while (this.$tokenIndex >= this.$rowTokens.length) {
            this.$row += 1;
            if (!rowCount)
                rowCount = this.$session.getLength();
            if (this.$row >= rowCount) {
                this.$row = rowCount - 1;
                return null;
            }
            this.$rowTokens = this.$session.getTokens(this.$row);
            this.$tokenIndex = 0;
        }
        return this.$rowTokens[this.$tokenIndex];
    };
    TokenIterator.prototype.getCurrentToken = function () {
        return this.$rowTokens[this.$tokenIndex];
    };
    TokenIterator.prototype.getCurrentTokenRow = function () {
        return this.$row;
    };
    TokenIterator.prototype.getCurrentTokenColumn = function () {
        var rowTokens = this.$rowTokens;
        var tokenIndex = this.$tokenIndex;
        var column = rowTokens[tokenIndex].start;
        if (column !== undefined)
            return column;
        column = 0;
        while (tokenIndex > 0) {
            tokenIndex -= 1;
            column += rowTokens[tokenIndex].value.length;
        }
        return column;
    };
    return TokenIterator;
})();
module.exports = TokenIterator;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiVG9rZW5JdGVyYXRvci5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uL3NyYy9Ub2tlbkl0ZXJhdG9yLnRzIl0sIm5hbWVzIjpbIlRva2VuSXRlcmF0b3IiLCJUb2tlbkl0ZXJhdG9yLmNvbnN0cnVjdG9yIiwiVG9rZW5JdGVyYXRvci5zdGVwQmFja3dhcmQiLCJUb2tlbkl0ZXJhdG9yLnN0ZXBGb3J3YXJkIiwiVG9rZW5JdGVyYXRvci5nZXRDdXJyZW50VG9rZW4iLCJUb2tlbkl0ZXJhdG9yLmdldEN1cnJlbnRUb2tlblJvdyIsIlRva2VuSXRlcmF0b3IuZ2V0Q3VycmVudFRva2VuQ29sdW1uIl0sIm1hcHBpbmdzIjoiQUErQ0E7SUFLSUEsdUJBQVlBLE9BQTBCQSxFQUFFQSxVQUFrQkEsRUFBRUEsYUFBcUJBO1FBQzdFQyxJQUFJQSxDQUFDQSxRQUFRQSxHQUFHQSxPQUFPQSxDQUFDQTtRQUN4QkEsSUFBSUEsQ0FBQ0EsSUFBSUEsR0FBR0EsVUFBVUEsQ0FBQ0E7UUFDdkJBLElBQUlBLENBQUNBLFVBQVVBLEdBQUdBLE9BQU9BLENBQUNBLFNBQVNBLENBQUNBLFVBQVVBLENBQUNBLENBQUNBO1FBRWhEQSxJQUFJQSxLQUFLQSxHQUFjQSxPQUFPQSxDQUFDQSxVQUFVQSxDQUFDQSxVQUFVQSxFQUFFQSxhQUFhQSxDQUFDQSxDQUFDQTtRQUNyRUEsSUFBSUEsQ0FBQ0EsV0FBV0EsR0FBR0EsS0FBS0EsR0FBR0EsS0FBS0EsQ0FBQ0EsS0FBS0EsR0FBR0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0E7SUFFaERBLENBQUNBO0lBT0RELG9DQUFZQSxHQUFaQTtRQUNJRSxJQUFJQSxDQUFDQSxXQUFXQSxJQUFJQSxDQUFDQSxDQUFDQTtRQUV0QkEsT0FBT0EsSUFBSUEsQ0FBQ0EsV0FBV0EsR0FBR0EsQ0FBQ0EsRUFBRUEsQ0FBQ0E7WUFDMUJBLElBQUlBLENBQUNBLElBQUlBLElBQUlBLENBQUNBLENBQUNBO1lBQ2ZBLEVBQUVBLENBQUNBLENBQUNBLElBQUlBLENBQUNBLElBQUlBLEdBQUdBLENBQUNBLENBQUNBLENBQUNBLENBQUNBO2dCQUNoQkEsSUFBSUEsQ0FBQ0EsSUFBSUEsR0FBR0EsQ0FBQ0EsQ0FBQ0E7Z0JBQ2RBLE1BQU1BLENBQUNBLElBQUlBLENBQUNBO1lBQ2hCQSxDQUFDQTtZQUVEQSxJQUFJQSxDQUFDQSxVQUFVQSxHQUFHQSxJQUFJQSxDQUFDQSxRQUFRQSxDQUFDQSxTQUFTQSxDQUFDQSxJQUFJQSxDQUFDQSxJQUFJQSxDQUFDQSxDQUFDQTtZQUNyREEsSUFBSUEsQ0FBQ0EsV0FBV0EsR0FBR0EsSUFBSUEsQ0FBQ0EsVUFBVUEsQ0FBQ0EsTUFBTUEsR0FBR0EsQ0FBQ0EsQ0FBQ0E7UUFDbERBLENBQUNBO1FBRURBLE1BQU1BLENBQUNBLElBQUlBLENBQUNBLFVBQVVBLENBQUNBLElBQUlBLENBQUNBLFdBQVdBLENBQUNBLENBQUNBO0lBQzdDQSxDQUFDQTtJQU9ERixtQ0FBV0EsR0FBWEE7UUFDSUcsSUFBSUEsQ0FBQ0EsV0FBV0EsSUFBSUEsQ0FBQ0EsQ0FBQ0E7UUFDdEJBLElBQUlBLFFBQVFBLENBQUNBO1FBQ2JBLE9BQU9BLElBQUlBLENBQUNBLFdBQVdBLElBQUlBLElBQUlBLENBQUNBLFVBQVVBLENBQUNBLE1BQU1BLEVBQUVBLENBQUNBO1lBQ2hEQSxJQUFJQSxDQUFDQSxJQUFJQSxJQUFJQSxDQUFDQSxDQUFDQTtZQUNmQSxFQUFFQSxDQUFDQSxDQUFDQSxDQUFDQSxRQUFRQSxDQUFDQTtnQkFDVkEsUUFBUUEsR0FBR0EsSUFBSUEsQ0FBQ0EsUUFBUUEsQ0FBQ0EsU0FBU0EsRUFBRUEsQ0FBQ0E7WUFDekNBLEVBQUVBLENBQUNBLENBQUNBLElBQUlBLENBQUNBLElBQUlBLElBQUlBLFFBQVFBLENBQUNBLENBQUNBLENBQUNBO2dCQUN4QkEsSUFBSUEsQ0FBQ0EsSUFBSUEsR0FBR0EsUUFBUUEsR0FBR0EsQ0FBQ0EsQ0FBQ0E7Z0JBQ3pCQSxNQUFNQSxDQUFDQSxJQUFJQSxDQUFDQTtZQUNoQkEsQ0FBQ0E7WUFFREEsSUFBSUEsQ0FBQ0EsVUFBVUEsR0FBR0EsSUFBSUEsQ0FBQ0EsUUFBUUEsQ0FBQ0EsU0FBU0EsQ0FBQ0EsSUFBSUEsQ0FBQ0EsSUFBSUEsQ0FBQ0EsQ0FBQ0E7WUFDckRBLElBQUlBLENBQUNBLFdBQVdBLEdBQUdBLENBQUNBLENBQUNBO1FBQ3pCQSxDQUFDQTtRQUVEQSxNQUFNQSxDQUFDQSxJQUFJQSxDQUFDQSxVQUFVQSxDQUFDQSxJQUFJQSxDQUFDQSxXQUFXQSxDQUFDQSxDQUFDQTtJQUM3Q0EsQ0FBQ0E7SUFPREgsdUNBQWVBLEdBQWZBO1FBQ0lJLE1BQU1BLENBQUNBLElBQUlBLENBQUNBLFVBQVVBLENBQUNBLElBQUlBLENBQUNBLFdBQVdBLENBQUNBLENBQUNBO0lBQzdDQSxDQUFDQTtJQU9ESiwwQ0FBa0JBLEdBQWxCQTtRQUNJSyxNQUFNQSxDQUFDQSxJQUFJQSxDQUFDQSxJQUFJQSxDQUFDQTtJQUNyQkEsQ0FBQ0E7SUFPREwsNkNBQXFCQSxHQUFyQkE7UUFDSU0sSUFBSUEsU0FBU0EsR0FBR0EsSUFBSUEsQ0FBQ0EsVUFBVUEsQ0FBQ0E7UUFDaENBLElBQUlBLFVBQVVBLEdBQUdBLElBQUlBLENBQUNBLFdBQVdBLENBQUNBO1FBR2xDQSxJQUFJQSxNQUFNQSxHQUFHQSxTQUFTQSxDQUFDQSxVQUFVQSxDQUFDQSxDQUFDQSxLQUFLQSxDQUFDQTtRQUN6Q0EsRUFBRUEsQ0FBQ0EsQ0FBQ0EsTUFBTUEsS0FBS0EsU0FBU0EsQ0FBQ0E7WUFDckJBLE1BQU1BLENBQUNBLE1BQU1BLENBQUNBO1FBRWxCQSxNQUFNQSxHQUFHQSxDQUFDQSxDQUFDQTtRQUNYQSxPQUFPQSxVQUFVQSxHQUFHQSxDQUFDQSxFQUFFQSxDQUFDQTtZQUNwQkEsVUFBVUEsSUFBSUEsQ0FBQ0EsQ0FBQ0E7WUFDaEJBLE1BQU1BLElBQUlBLFNBQVNBLENBQUNBLFVBQVVBLENBQUNBLENBQUNBLEtBQUtBLENBQUNBLE1BQU1BLENBQUNBO1FBQ2pEQSxDQUFDQTtRQUVEQSxNQUFNQSxDQUFDQSxNQUFNQSxDQUFDQTtJQUNsQkEsQ0FBQ0E7SUFDTE4sb0JBQUNBO0FBQURBLENBQUNBLEFBckdELElBcUdDO0FBRUQsaUJBQVMsYUFBYSxDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiLyogKioqKiogQkVHSU4gTElDRU5TRSBCTE9DSyAqKioqKlxuICogRGlzdHJpYnV0ZWQgdW5kZXIgdGhlIEJTRCBsaWNlbnNlOlxuICpcbiAqIENvcHlyaWdodCAoYykgMjAxMCwgQWpheC5vcmcgQi5WLlxuICogQWxsIHJpZ2h0cyByZXNlcnZlZC5cbiAqIFxuICogUmVkaXN0cmlidXRpb24gYW5kIHVzZSBpbiBzb3VyY2UgYW5kIGJpbmFyeSBmb3Jtcywgd2l0aCBvciB3aXRob3V0XG4gKiBtb2RpZmljYXRpb24sIGFyZSBwZXJtaXR0ZWQgcHJvdmlkZWQgdGhhdCB0aGUgZm9sbG93aW5nIGNvbmRpdGlvbnMgYXJlIG1ldDpcbiAqICAgICAqIFJlZGlzdHJpYnV0aW9ucyBvZiBzb3VyY2UgY29kZSBtdXN0IHJldGFpbiB0aGUgYWJvdmUgY29weXJpZ2h0XG4gKiAgICAgICBub3RpY2UsIHRoaXMgbGlzdCBvZiBjb25kaXRpb25zIGFuZCB0aGUgZm9sbG93aW5nIGRpc2NsYWltZXIuXG4gKiAgICAgKiBSZWRpc3RyaWJ1dGlvbnMgaW4gYmluYXJ5IGZvcm0gbXVzdCByZXByb2R1Y2UgdGhlIGFib3ZlIGNvcHlyaWdodFxuICogICAgICAgbm90aWNlLCB0aGlzIGxpc3Qgb2YgY29uZGl0aW9ucyBhbmQgdGhlIGZvbGxvd2luZyBkaXNjbGFpbWVyIGluIHRoZVxuICogICAgICAgZG9jdW1lbnRhdGlvbiBhbmQvb3Igb3RoZXIgbWF0ZXJpYWxzIHByb3ZpZGVkIHdpdGggdGhlIGRpc3RyaWJ1dGlvbi5cbiAqICAgICAqIE5laXRoZXIgdGhlIG5hbWUgb2YgQWpheC5vcmcgQi5WLiBub3IgdGhlXG4gKiAgICAgICBuYW1lcyBvZiBpdHMgY29udHJpYnV0b3JzIG1heSBiZSB1c2VkIHRvIGVuZG9yc2Ugb3IgcHJvbW90ZSBwcm9kdWN0c1xuICogICAgICAgZGVyaXZlZCBmcm9tIHRoaXMgc29mdHdhcmUgd2l0aG91dCBzcGVjaWZpYyBwcmlvciB3cml0dGVuIHBlcm1pc3Npb24uXG4gKiBcbiAqIFRISVMgU09GVFdBUkUgSVMgUFJPVklERUQgQlkgVEhFIENPUFlSSUdIVCBIT0xERVJTIEFORCBDT05UUklCVVRPUlMgXCJBUyBJU1wiIEFORFxuICogQU5ZIEVYUFJFU1MgT1IgSU1QTElFRCBXQVJSQU5USUVTLCBJTkNMVURJTkcsIEJVVCBOT1QgTElNSVRFRCBUTywgVEhFIElNUExJRURcbiAqIFdBUlJBTlRJRVMgT0YgTUVSQ0hBTlRBQklMSVRZIEFORCBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRSBBUkVcbiAqIERJU0NMQUlNRUQuIElOIE5PIEVWRU5UIFNIQUxMIEFKQVguT1JHIEIuVi4gQkUgTElBQkxFIEZPUiBBTllcbiAqIERJUkVDVCwgSU5ESVJFQ1QsIElOQ0lERU5UQUwsIFNQRUNJQUwsIEVYRU1QTEFSWSwgT1IgQ09OU0VRVUVOVElBTCBEQU1BR0VTXG4gKiAoSU5DTFVESU5HLCBCVVQgTk9UIExJTUlURUQgVE8sIFBST0NVUkVNRU5UIE9GIFNVQlNUSVRVVEUgR09PRFMgT1IgU0VSVklDRVM7XG4gKiBMT1NTIE9GIFVTRSwgREFUQSwgT1IgUFJPRklUUzsgT1IgQlVTSU5FU1MgSU5URVJSVVBUSU9OKSBIT1dFVkVSIENBVVNFRCBBTkRcbiAqIE9OIEFOWSBUSEVPUlkgT0YgTElBQklMSVRZLCBXSEVUSEVSIElOIENPTlRSQUNULCBTVFJJQ1QgTElBQklMSVRZLCBPUiBUT1JUXG4gKiAoSU5DTFVESU5HIE5FR0xJR0VOQ0UgT1IgT1RIRVJXSVNFKSBBUklTSU5HIElOIEFOWSBXQVkgT1VUIE9GIFRIRSBVU0UgT0YgVEhJU1xuICogU09GVFdBUkUsIEVWRU4gSUYgQURWSVNFRCBPRiBUSEUgUE9TU0lCSUxJVFkgT0YgU1VDSCBEQU1BR0UuXG4gKlxuICogKioqKiogRU5EIExJQ0VOU0UgQkxPQ0sgKioqKiogKi9cbmltcG9ydCBlc20gPSByZXF1aXJlKCcuL2VkaXRfc2Vzc2lvbicpO1xuaW1wb3J0IFRva2VuSXRlcmF0b3JIb3N0ID0gcmVxdWlyZSgnLi9Ub2tlbkl0ZXJhdG9ySG9zdCcpO1xuXG4vKipcbiAqIFxuICpcbiAqIFRoaXMgY2xhc3MgcHJvdmlkZXMgYW4gZXNzYXkgd2F5IHRvIHRyZWF0IHRoZSBkb2N1bWVudCBhcyBhIHN0cmVhbSBvZiB0b2tlbnMsIGFuZCBwcm92aWRlcyBtZXRob2RzIHRvIGl0ZXJhdGUgb3ZlciB0aGVzZSB0b2tlbnMuXG4gKiBAY2xhc3MgVG9rZW5JdGVyYXRvclxuICoqL1xuXG4vKipcbiAqIENyZWF0ZXMgYSBuZXcgdG9rZW4gaXRlcmF0b3Igb2JqZWN0LiBUaGUgaW5pdGFsIHRva2VuIGluZGV4IGlzIHNldCB0byB0aGUgcHJvdmlkZWQgcm93IGFuZCBjb2x1bW4gY29vcmRpbmF0ZXMuXG4gKiBAcGFyYW0ge0VkaXRTZXNzaW9ufSBzZXNzaW9uIFRoZSBzZXNzaW9uIHRvIGFzc29jaWF0ZSB3aXRoXG4gKiBAcGFyYW0ge051bWJlcn0gaW5pdGlhbFJvdyBUaGUgcm93IHRvIHN0YXJ0IHRoZSB0b2tlbml6aW5nIGF0XG4gKiBAcGFyYW0ge051bWJlcn0gaW5pdGlhbENvbHVtbiBUaGUgY29sdW1uIHRvIHN0YXJ0IHRoZSB0b2tlbml6aW5nIGF0XG4gKlxuICogQGNvbnN0cnVjdG9yXG4gKiovXG5jbGFzcyBUb2tlbkl0ZXJhdG9yIHtcbiAgICBwcml2YXRlICRzZXNzaW9uOiBUb2tlbkl0ZXJhdG9ySG9zdDtcbiAgICBwcml2YXRlICRyb3c6IG51bWJlcjtcbiAgICBwcml2YXRlICRyb3dUb2tlbnM6IHsgc3RhcnQ6IG51bWJlcjsgdHlwZTogc3RyaW5nOyB2YWx1ZTogc3RyaW5nIH1bXTtcbiAgICBwcml2YXRlICR0b2tlbkluZGV4OiBudW1iZXI7XG4gICAgY29uc3RydWN0b3Ioc2Vzc2lvbjogVG9rZW5JdGVyYXRvckhvc3QsIGluaXRpYWxSb3c6IG51bWJlciwgaW5pdGlhbENvbHVtbjogbnVtYmVyKSB7XG4gICAgICAgIHRoaXMuJHNlc3Npb24gPSBzZXNzaW9uO1xuICAgICAgICB0aGlzLiRyb3cgPSBpbml0aWFsUm93O1xuICAgICAgICB0aGlzLiRyb3dUb2tlbnMgPSBzZXNzaW9uLmdldFRva2Vucyhpbml0aWFsUm93KTtcblxuICAgICAgICB2YXIgdG9rZW46IHsgaW5kZXggfSA9IHNlc3Npb24uZ2V0VG9rZW5BdChpbml0aWFsUm93LCBpbml0aWFsQ29sdW1uKTtcbiAgICAgICAgdGhpcy4kdG9rZW5JbmRleCA9IHRva2VuID8gdG9rZW4uaW5kZXggOiAtMTtcblxuICAgIH1cblxuICAgIC8qKlxuICAgICogXG4gICAgKiBUb2tlbml6ZXMgYWxsIHRoZSBpdGVtcyBmcm9tIHRoZSBjdXJyZW50IHBvaW50IHRvIHRoZSByb3cgcHJpb3IgaW4gdGhlIGRvY3VtZW50LiBcbiAgICAqIEByZXR1cm5zIHtbU3RyaW5nXX0gSWYgdGhlIGN1cnJlbnQgcG9pbnQgaXMgbm90IGF0IHRoZSB0b3Agb2YgdGhlIGZpbGUsIHRoaXMgZnVuY3Rpb24gcmV0dXJucyBgbnVsbGAuIE90aGVyd2lzZSwgaXQgcmV0dXJucyBhbiBhcnJheSBvZiB0aGUgdG9rZW5pemVkIHN0cmluZ3MuXG4gICAgKiovXG4gICAgc3RlcEJhY2t3YXJkKCkge1xuICAgICAgICB0aGlzLiR0b2tlbkluZGV4IC09IDE7XG5cbiAgICAgICAgd2hpbGUgKHRoaXMuJHRva2VuSW5kZXggPCAwKSB7XG4gICAgICAgICAgICB0aGlzLiRyb3cgLT0gMTtcbiAgICAgICAgICAgIGlmICh0aGlzLiRyb3cgPCAwKSB7XG4gICAgICAgICAgICAgICAgdGhpcy4kcm93ID0gMDtcbiAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdGhpcy4kcm93VG9rZW5zID0gdGhpcy4kc2Vzc2lvbi5nZXRUb2tlbnModGhpcy4kcm93KTtcbiAgICAgICAgICAgIHRoaXMuJHRva2VuSW5kZXggPSB0aGlzLiRyb3dUb2tlbnMubGVuZ3RoIC0gMTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiB0aGlzLiRyb3dUb2tlbnNbdGhpcy4kdG9rZW5JbmRleF07XG4gICAgfVxuXG4gICAgLyoqXG4gICAgKiBcbiAgICAqIFRva2VuaXplcyBhbGwgdGhlIGl0ZW1zIGZyb20gdGhlIGN1cnJlbnQgcG9pbnQgdW50aWwgdGhlIG5leHQgcm93IGluIHRoZSBkb2N1bWVudC4gSWYgdGhlIGN1cnJlbnQgcG9pbnQgaXMgYXQgdGhlIGVuZCBvZiB0aGUgZmlsZSwgdGhpcyBmdW5jdGlvbiByZXR1cm5zIGBudWxsYC4gT3RoZXJ3aXNlLCBpdCByZXR1cm5zIHRoZSB0b2tlbml6ZWQgc3RyaW5nLlxuICAgICogQHJldHVybnMge1N0cmluZ31cbiAgICAqKi9cbiAgICBzdGVwRm9yd2FyZCgpIHtcbiAgICAgICAgdGhpcy4kdG9rZW5JbmRleCArPSAxO1xuICAgICAgICB2YXIgcm93Q291bnQ7XG4gICAgICAgIHdoaWxlICh0aGlzLiR0b2tlbkluZGV4ID49IHRoaXMuJHJvd1Rva2Vucy5sZW5ndGgpIHtcbiAgICAgICAgICAgIHRoaXMuJHJvdyArPSAxO1xuICAgICAgICAgICAgaWYgKCFyb3dDb3VudClcbiAgICAgICAgICAgICAgICByb3dDb3VudCA9IHRoaXMuJHNlc3Npb24uZ2V0TGVuZ3RoKCk7XG4gICAgICAgICAgICBpZiAodGhpcy4kcm93ID49IHJvd0NvdW50KSB7XG4gICAgICAgICAgICAgICAgdGhpcy4kcm93ID0gcm93Q291bnQgLSAxO1xuICAgICAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB0aGlzLiRyb3dUb2tlbnMgPSB0aGlzLiRzZXNzaW9uLmdldFRva2Vucyh0aGlzLiRyb3cpO1xuICAgICAgICAgICAgdGhpcy4kdG9rZW5JbmRleCA9IDA7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gdGhpcy4kcm93VG9rZW5zW3RoaXMuJHRva2VuSW5kZXhdO1xuICAgIH1cblxuICAgIC8qKlxuICAgICogXG4gICAgKiBSZXR1cm5zIHRoZSBjdXJyZW50IHRva2VuaXplZCBzdHJpbmcuXG4gICAgKiBAcmV0dXJucyB7U3RyaW5nfVxuICAgICoqL1xuICAgIGdldEN1cnJlbnRUb2tlbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuJHJvd1Rva2Vuc1t0aGlzLiR0b2tlbkluZGV4XTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAqIFxuICAgICogUmV0dXJucyB0aGUgY3VycmVudCByb3cuXG4gICAgKiBAcmV0dXJucyB7TnVtYmVyfVxuICAgICoqL1xuICAgIGdldEN1cnJlbnRUb2tlblJvdygpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuJHJvdztcbiAgICB9XG5cbiAgICAvKipcbiAgICAqIFxuICAgICogUmV0dXJucyB0aGUgY3VycmVudCBjb2x1bW4uXG4gICAgKiBAcmV0dXJucyB7TnVtYmVyfVxuICAgICoqL1xuICAgIGdldEN1cnJlbnRUb2tlbkNvbHVtbigpIHtcbiAgICAgICAgdmFyIHJvd1Rva2VucyA9IHRoaXMuJHJvd1Rva2VucztcbiAgICAgICAgdmFyIHRva2VuSW5kZXggPSB0aGlzLiR0b2tlbkluZGV4O1xuXG4gICAgICAgIC8vIElmIGEgY29sdW1uIHdhcyBjYWNoZWQgYnkgRWRpdFNlc3Npb24uZ2V0VG9rZW5BdCwgdGhlbiB1c2UgaXRcbiAgICAgICAgdmFyIGNvbHVtbiA9IHJvd1Rva2Vuc1t0b2tlbkluZGV4XS5zdGFydDtcbiAgICAgICAgaWYgKGNvbHVtbiAhPT0gdW5kZWZpbmVkKVxuICAgICAgICAgICAgcmV0dXJuIGNvbHVtbjtcblxuICAgICAgICBjb2x1bW4gPSAwO1xuICAgICAgICB3aGlsZSAodG9rZW5JbmRleCA+IDApIHtcbiAgICAgICAgICAgIHRva2VuSW5kZXggLT0gMTtcbiAgICAgICAgICAgIGNvbHVtbiArPSByb3dUb2tlbnNbdG9rZW5JbmRleF0udmFsdWUubGVuZ3RoO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIGNvbHVtbjtcbiAgICB9XG59XG5cbmV4cG9ydCA9IFRva2VuSXRlcmF0b3I7XG4iXX0=