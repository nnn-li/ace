var __extends = (this && this.__extends) || function (d, b) {
    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];
    function __() { this.constructor = d; }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
};
var ttm = require('./tooltip');
var TypeInfoTooltip = (function (_super) {
    __extends(TypeInfoTooltip, _super);
    function TypeInfoTooltip(parentElement) {
        _super.call(this, parentElement);
    }
    return TypeInfoTooltip;
})(ttm.Tooltip);
var typeInfoTip = function (doc, editor, workspace, fileNameProvider, rootElement) {
    var _tooltip = new TypeInfoTooltip(editor.container);
    var _mouseMoveTimer;
    function _onMouseMove(event) {
        _tooltip.hide();
        clearTimeout(_mouseMoveTimer);
        var elem = event.srcElement;
        if (elem['className'] === 'ace_content') {
            _mouseMoveTimer = setTimeout(function () { showInfo(); }, 800);
        }
        function showInfo() {
            function getDocumentPositionFromScreenOffset(x, y) {
                var r = editor.renderer;
                var offset = (x - r.$padding) / r.characterWidth;
                var correction = r.scrollTop ? 7 : 0;
                var row = Math.floor((y + r.scrollTop - correction) / r.lineHeight);
                var col = Math.round(offset);
                return editor.getSession().screenToDocumentPosition(row, col);
            }
            var documentPosition = getDocumentPositionFromScreenOffset(event.offsetX, event.offsetY);
            var fileName = fileNameProvider();
            if (workspace && typeof fileName === 'string') {
                workspace.getTypeAtDocumentPosition(fileName, documentPosition, function (err, typeInfo) {
                    if (!err) {
                        if (typeInfo) {
                            _tooltip.setHtml(tipHtml());
                            _tooltip.setPosition(event.x, event.y + 10);
                            _tooltip.show();
                        }
                        else {
                        }
                    }
                    else {
                    }
                    function tipHtml() {
                        var tip = "";
                        if (tip.length > 0) {
                            tip = "<article class='ace_dts'>" + tip + "</article>";
                        }
                        return tip;
                    }
                });
            }
        }
    }
    var that = {
        startUp: function () { rootElement.addEventListener("mousemove", _onMouseMove); },
        tearDown: function () { rootElement.removeEventListener("mousemove", _onMouseMove); }
    };
    return that;
};
module.exports = typeInfoTip;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidHlwZUluZm9UaXAuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi9zcmMvdHlwZUluZm9UaXAudHMiXSwibmFtZXMiOlsiVHlwZUluZm9Ub29sdGlwIiwiVHlwZUluZm9Ub29sdGlwLmNvbnN0cnVjdG9yIiwiX29uTW91c2VNb3ZlIiwiX29uTW91c2VNb3ZlLnNob3dJbmZvIiwiX29uTW91c2VNb3ZlLnNob3dJbmZvLmdldERvY3VtZW50UG9zaXRpb25Gcm9tU2NyZWVuT2Zmc2V0IiwiX29uTW91c2VNb3ZlLnNob3dJbmZvLnRpcEh0bWwiXSwibWFwcGluZ3MiOiI7Ozs7O0FBQUEsSUFBTyxHQUFHLFdBQVcsV0FBVyxDQUFDLENBQUM7QUFNbEM7SUFBOEJBLG1DQUFXQTtJQUNyQ0EseUJBQVlBLGFBQTBCQTtRQUNsQ0Msa0JBQU1BLGFBQWFBLENBQUNBLENBQUNBO0lBQ3pCQSxDQUFDQTtJQUNMRCxzQkFBQ0E7QUFBREEsQ0FBQ0EsQUFKRCxFQUE4QixHQUFHLENBQUMsT0FBTyxFQUl4QztBQUVELElBQUksV0FBVyxHQUFHLFVBQVMsR0FBYSxFQUFFLE1BQU0sRUFBRSxTQUF3QixFQUFFLGdCQUE4QixFQUFFLFdBQXdCO0lBRWhJLElBQUksUUFBUSxHQUFHLElBQUksZUFBZSxDQUFDLE1BQU0sQ0FBQyxTQUFTLENBQUMsQ0FBQztJQUVyRCxJQUFJLGVBQXVCLENBQUM7SUFFNUIsc0JBQXNCLEtBQWlCO1FBQ25DRSxRQUFRQSxDQUFDQSxJQUFJQSxFQUFFQSxDQUFDQTtRQUNoQkEsWUFBWUEsQ0FBQ0EsZUFBZUEsQ0FBQ0EsQ0FBQ0E7UUFDOUJBLElBQUlBLElBQUlBLEdBQVlBLEtBQUtBLENBQUNBLFVBQVVBLENBQUNBO1FBQ3JDQSxFQUFFQSxDQUFDQSxDQUFDQSxJQUFJQSxDQUFDQSxXQUFXQSxDQUFDQSxLQUFLQSxhQUFhQSxDQUFDQSxDQUFDQSxDQUFDQTtZQUN0Q0EsZUFBZUEsR0FBR0EsVUFBVUEsQ0FBQ0EsY0FBUUEsUUFBUUEsRUFBRUEs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O0tBQ2pGLENBQUM7SUFDRixNQUFNLENBQUMsSUFBSSxDQUFDO0FBQ2hCLENBQUMsQ0FBQztBQUNGLGlCQUFTLFdBQVcsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB0dG0gPSByZXF1aXJlKCcuL3Rvb2x0aXAnKTtcbmltcG9ydCB3c20gPSByZXF1aXJlKCcuL3dvcmtzcGFjZS93b3Jrc3BhY2UnKTtcblxuLyoqXG4gKiBUaGUgVXNlciBJbnRlcmZhY2UgZWxlbWVudCBsZXZlcmFnZXMgdGhlIGV4aXN0aW5nIFRvb2x0aXAgZm9yIGNvbnNpc3RlbmN5LlxuICovXG5jbGFzcyBUeXBlSW5mb1Rvb2x0aXAgZXh0ZW5kcyB0dG0uVG9vbHRpcCB7XG4gICAgY29uc3RydWN0b3IocGFyZW50RWxlbWVudDogSFRNTEVsZW1lbnQpIHtcbiAgICAgICAgc3VwZXIocGFyZW50RWxlbWVudCk7XG4gICAgfVxufVxuXG52YXIgdHlwZUluZm9UaXAgPSBmdW5jdGlvbihkb2M6IERvY3VtZW50LCBlZGl0b3IsIHdvcmtzcGFjZTogd3NtLldvcmtzcGFjZSwgZmlsZU5hbWVQcm92aWRlcjogKCkgPT4gc3RyaW5nLCByb290RWxlbWVudDogSFRNTEVsZW1lbnQpIHtcblxuICAgIHZhciBfdG9vbHRpcCA9IG5ldyBUeXBlSW5mb1Rvb2x0aXAoZWRpdG9yLmNvbnRhaW5lcik7XG5cbiAgICB2YXIgX21vdXNlTW92ZVRpbWVyOiBudW1iZXI7XG5cbiAgICBmdW5jdGlvbiBfb25Nb3VzZU1vdmUoZXZlbnQ6IE1vdXNlRXZlbnQpIHtcbiAgICAgICAgX3Rvb2x0aXAuaGlkZSgpO1xuICAgICAgICBjbGVhclRpbWVvdXQoX21vdXNlTW92ZVRpbWVyKTtcbiAgICAgICAgdmFyIGVsZW06IEVsZW1lbnQgPSBldmVudC5zcmNFbGVtZW50O1xuICAgICAgICBpZiAoZWxlbVsnY2xhc3NOYW1lJ10gPT09ICdhY2VfY29udGVudCcpIHtcbiAgICAgICAgICAgIF9tb3VzZU1vdmVUaW1lciA9IHNldFRpbWVvdXQoKCkgPT4geyBzaG93SW5mbygpOyB9LCA4MDApO1xuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIHNob3dJbmZvKCkge1xuICAgICAgICAgICAgLy8gVE9ETyBpZiAobW9kZSAhPT0gXCJ0eXBlc2NyaXB0XCIpIHJldHVybjtcblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBHZXRzIHRoZSBQb3NpdGlvbiBiYXNlZCBvbiBtb3VzZSB4LHkgY29vcmRpbmF0ZXNcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgZnVuY3Rpb24gZ2V0RG9jdW1lbnRQb3NpdGlvbkZyb21TY3JlZW5PZmZzZXQoeDogbnVtYmVyLCB5OiBudW1iZXIpOiB7IHJvdzogbnVtYmVyOyBjb2x1bW46IG51bWJlciB9IHtcbiAgICAgICAgICAgICAgICB2YXIgciA9IGVkaXRvci5yZW5kZXJlcjtcbiAgICAgICAgICAgICAgICAvLyB2YXIgb2Zmc2V0ID0gKHggKyByLnNjcm9sbExlZnQgLSByLiRwYWRkaW5nKSAvIHIuY2hhcmFjdGVyV2lkdGg7XG4gICAgICAgICAgICAgICAgdmFyIG9mZnNldCA9ICh4IC0gci4kcGFkZGluZykgLyByLmNoYXJhY3RlcldpZHRoO1xuXG4gICAgICAgICAgICAgICAgLy8gQEJVRzogUXVpY2tmaXggZm9yIHN0cmFuZ2UgaXNzdWUgd2l0aCB0b3BcbiAgICAgICAgICAgICAgICB2YXIgY29ycmVjdGlvbiA9IHIuc2Nyb2xsVG9wID8gNyA6IDA7XG5cbiAgICAgICAgICAgICAgICB2YXIgcm93ID0gTWF0aC5mbG9vcigoeSArIHIuc2Nyb2xsVG9wIC0gY29ycmVjdGlvbikgLyByLmxpbmVIZWlnaHQpO1xuICAgICAgICAgICAgICAgIHZhciBjb2wgPSBNYXRoLnJvdW5kKG9mZnNldCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGVkaXRvci5nZXRTZXNzaW9uKCkuc2NyZWVuVG9Eb2N1bWVudFBvc2l0aW9uKHJvdywgY29sKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBkb2N1bWVudFBvc2l0aW9uID0gZ2V0RG9jdW1lbnRQb3NpdGlvbkZyb21TY3JlZW5PZmZzZXQoZXZlbnQub2Zmc2V0WCwgZXZlbnQub2Zmc2V0WSk7XG4gICAgICAgICAgICB2YXIgZmlsZU5hbWUgPSBmaWxlTmFtZVByb3ZpZGVyKCk7XG4gICAgICAgICAgICBpZiAod29ya3NwYWNlICYmIHR5cGVvZiBmaWxlTmFtZSA9PT0gJ3N0cmluZycpIHtcbiAgICAgICAgICAgICAgICB3b3Jrc3BhY2UuZ2V0VHlwZUF0RG9jdW1lbnRQb3NpdGlvbihmaWxlTmFtZSwgZG9jdW1lbnRQb3NpdGlvbiwgKGVycjogYW55LCB0eXBlSW5mbzogdHMuVHlwZSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICBpZiAoIWVycikge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHR5cGVJbmZvKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgX3Rvb2x0aXAuc2V0SHRtbCh0aXBIdG1sKCkpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgX3Rvb2x0aXAuc2V0UG9zaXRpb24oZXZlbnQueCwgZXZlbnQueSArIDEwKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfdG9vbHRpcC5zaG93KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBOb3RoaW5nIHRvIHNlZSBoZXJlLiBNb3ZlIGFsb25nLlxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gVE9ETzogUmVwb3J0IHRoZSBlcnJvci5cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiB0aXBIdG1sKCk6IHN0cmluZyB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgdGlwID0gXCJcIjtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFRoZSBkZXNjcmlwdGlvbiBpcyB0aGUgdHlwZSBpbmZvcm1hdGlvbiBmcm9tIHRoZSBzb3VyY2UuXG4gICAgICAgICAgICAgICAgICAgICAgICAvKiBGSVhNRTogUmVzdG9yZVxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHR5cGVJbmZvLmRlc2NyaXB0aW9uICYmIHJlc3VsdHMuZGVzY3JpcHRpb24ubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRpcCArPSBcIjxoMT5cIiArIHR5cGVJbmZvLmZ1bGxTeW1ib2xOYW1lICsgXCI8L2gxPjxzZWN0aW9uPjxoMj5UeXBlPC9oMj48cD48Y29kZT5cIiArIHJlc3VsdHMuZGVzY3JpcHRpb24gKyBcIjwvY29kZT48L3A+PC9zZWN0aW9uPlwiO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyZXN1bHRzLmRvY0NvbW1lbnQgJiYgcmVzdWx0cy5kb2NDb21tZW50Lmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gVGhlIGRvY0NvbW1lbnQgaXMgZXhwZWN0ZWQgdG8gYmUgYSBsaXN0IG9mIHNlY3Rpb24gZWxlbWVudHMuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRpcCArPSBcIjxzZWN0aW9uPjxoMj5EZXNjcmlwdGlvbjwvaDI+XCIgKyByZXN1bHRzLmRvY0NvbW1lbnQgKyBcIjwvc2VjdGlvbj5cIjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRpcC5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGlwID0gXCI8YXJ0aWNsZSBjbGFzcz0nYWNlX2R0cyc+XCIgKyB0aXAgKyBcIjwvYXJ0aWNsZT5cIlxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRpcDtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgdmFyIHRoYXQgPSB7XG4gICAgICAgIHN0YXJ0VXA6ICgpID0+IHsgcm9vdEVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlbW92ZVwiLCBfb25Nb3VzZU1vdmUpIH0sXG4gICAgICAgIHRlYXJEb3duOiAoKSA9PiB7IHJvb3RFbGVtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJtb3VzZW1vdmVcIiwgX29uTW91c2VNb3ZlKSB9XG4gICAgfTtcbiAgICByZXR1cm4gdGhhdDtcbn07XG5leHBvcnQgPSB0eXBlSW5mb1RpcDsiXX0=