"use strict";
export default class Range {
    constructor(startRow, startColumn, endRow, endColumn) {
        this.start = {
            row: startRow,
            column: startColumn
        };
        this.end = {
            row: endRow,
            column: endColumn
        };
    }
    isEqual(range) {
        return this.start.row === range.start.row &&
            this.end.row === range.end.row &&
            this.start.column === range.start.column &&
            this.end.column === range.end.column;
    }
    toString() {
        return ("Range: [" + this.start.row + "/" + this.start.column +
            "] -> [" + this.end.row + "/" + this.end.column + "]");
    }
    contains(row, column) {
        return this.compare(row, column) === 0;
    }
    compareRange(range) {
        var cmp;
        var end = range.end;
        var start = range.start;
        cmp = this.compare(end.row, end.column);
        if (cmp === 1) {
            cmp = this.compare(start.row, start.column);
            if (cmp === 1) {
                return 2;
            }
            else if (cmp === 0) {
                return 1;
            }
            else {
                return 0;
            }
        }
        else if (cmp === -1) {
            return -2;
        }
        else {
            cmp = this.compare(start.row, start.column);
            if (cmp === -1) {
                return -1;
            }
            else if (cmp === 1) {
                return 42;
            }
            else {
                return 0;
            }
        }
    }
    comparePoint(point) {
        return this.compare(point.row, point.column);
    }
    containsRange(range) {
        return this.comparePoint(range.start) === 0 && this.comparePoint(range.end) === 0;
    }
    intersects(range) {
        var cmp = this.compareRange(range);
        return (cmp === -1 || cmp === 0 || cmp === 1);
    }
    isEnd(row, column) {
        return this.end.row === row && this.end.column === column;
    }
    isStart(row, column) {
        return this.start.row === row && this.start.column === column;
    }
    setStart(row, column) {
        this.start.row = row;
        this.start.column = column;
    }
    setEnd(row, column) {
        this.end.row = row;
        this.end.column = column;
    }
    inside(row, column) {
        if (this.compare(row, column) === 0) {
            if (this.isEnd(row, column) || this.isStart(row, column)) {
                return false;
            }
            else {
                return true;
            }
        }
        return false;
    }
    insideStart(row, column) {
        if (this.compare(row, column) === 0) {
            if (this.isEnd(row, column)) {
                return false;
            }
            else {
                return true;
            }
        }
        return false;
    }
    insideEnd(row, column) {
        if (this.compare(row, column) === 0) {
            if (this.isStart(row, column)) {
                return false;
            }
            else {
                return true;
            }
        }
        return false;
    }
    compare(row, column) {
        if (!this.isMultiLine()) {
            if (row === this.start.row) {
                return column < this.start.column ? -1 : (column > this.end.column ? 1 : 0);
            }
        }
        if (row < this.start.row)
            return -1;
        if (row > this.end.row)
            return 1;
        if (this.start.row === row)
            return column >= this.start.column ? 0 : -1;
        if (this.end.row === row)
            return column <= this.end.column ? 0 : 1;
        return 0;
    }
    compareStart(row, column) {
        if (this.start.row === row && this.start.column === column) {
            return -1;
        }
        else {
            return this.compare(row, column);
        }
    }
    compareEnd(row, column) {
        if (this.end.row === row && this.end.column === column) {
            return 1;
        }
        else {
            return this.compare(row, column);
        }
    }
    compareInside(row, column) {
        if (this.end.row === row && this.end.column === column) {
            return 1;
        }
        else if (this.start.row === row && this.start.column === column) {
            return -1;
        }
        else {
            return this.compare(row, column);
        }
    }
    clipRows(firstRow, lastRow) {
        var start;
        var end;
        if (this.end.row > lastRow)
            end = { row: lastRow + 1, column: 0 };
        else if (this.end.row < firstRow)
            end = { row: firstRow, column: 0 };
        if (this.start.row > lastRow)
            start = { row: lastRow + 1, column: 0 };
        else if (this.start.row < firstRow)
            start = { row: firstRow, column: 0 };
        return Range.fromPoints(start || this.start, end || this.end);
    }
    extend(row, column) {
        var cmp = this.compare(row, column);
        if (cmp === 0) {
            return this;
        }
        else if (cmp === -1) {
            var start = { row: row, column: column };
        }
        else {
            var end = { row: row, column: column };
        }
        return Range.fromPoints(start || this.start, end || this.end);
    }
    isEmpty() {
        return (this.start.row === this.end.row && this.start.column === this.end.column);
    }
    isMultiLine() {
        return (this.start.row !== this.end.row);
    }
    clone() {
        return Range.fromPoints(this.start, this.end);
    }
    collapseRows() {
        if (this.end.column === 0)
            return new Range(this.start.row, 0, Math.max(this.start.row, this.end.row - 1), 0);
        else
            return new Range(this.start.row, 0, this.end.row, 0);
    }
    moveBy(row, column) {
        this.start.row += row;
        this.start.column += column;
        this.end.row += row;
        this.end.column += column;
    }
    static fromPoints(start, end) {
        return new Range(start.row, start.column, end.row, end.column);
    }
    static comparePoints(p1, p2) {
        return p1.row - p2.row || p1.column - p2.column;
    }
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiUmFuZ2UuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyJSYW5nZS50cyJdLCJuYW1lcyI6WyJSYW5nZSIsIlJhbmdlLmNvbnN0cnVjdG9yIiwiUmFuZ2UuaXNFcXVhbCIsIlJhbmdlLnRvU3RyaW5nIiwiUmFuZ2UuY29udGFpbnMiLCJSYW5nZS5jb21wYXJlUmFuZ2UiLCJSYW5nZS5jb21wYXJlUG9pbnQiLCJSYW5nZS5jb250YWluc1JhbmdlIiwiUmFuZ2UuaW50ZXJzZWN0cyIsIlJhbmdlLmlzRW5kIiwiUmFuZ2UuaXNTdGFydCIsIlJhbmdlLnNldFN0YXJ0IiwiUmFuZ2Uuc2V0RW5kIiwiUmFuZ2UuaW5zaWRlIiwiUmFuZ2UuaW5zaWRlU3RhcnQiLCJSYW5nZS5pbnNpZGVFbmQiLCJSYW5nZS5jb21wYXJlIiwiUmFuZ2UuY29tcGFyZVN0YXJ0IiwiUmFuZ2UuY29tcGFyZUVuZCIsIlJhbmdlLmNvbXBhcmVJbnNpZGUiLCJSYW5nZS5jbGlwUm93cyIsIlJhbmdlLmV4dGVuZCIsIlJhbmdlLmlzRW1wdHkiLCJSYW5nZS5pc011bHRpTGluZSIsIlJhbmdlLmNsb25lIiwiUmFuZ2UuY29sbGFwc2VSb3dzIiwiUmFuZ2UubW92ZUJ5IiwiUmFuZ2UuZnJvbVBvaW50cyIsIlJhbmdlLmNvbXBhcmVQb2ludHMiXSwibWFwcGluZ3MiOiJBQW9EQSxZQUFZLENBQUM7QUFVYjtJQTBDSUEsWUFBWUEsUUFBZ0JBLEVBQUVBLFdBQW1CQSxFQUFFQSxNQUFjQSxFQUFFQSxTQUFpQkE7UUFDaEZDLElBQUlBLENBQUNBLEtBQUtBLEdBQUdBO1lBQ1RBLEdBQUdBLEVBQUVBLFFBQVFBO1lBQ2JBLE1BQU1BLEVBQUVBLFdBQVdBO1NBQ3RCQSxDQUFDQTtRQUVGQSxJQUFJQSxDQUFDQSxHQUFHQSxHQUFHQTtZQUNQQSxHQUFHQSxFQUFFQSxNQUFNQTtZQUNYQSxNQUFNQSxFQUFFQSxTQUFTQTtTQUNwQkEsQ0FBQ0E7SUFDTkEsQ0FBQ0E7SUFTREQsT0FBT0EsQ0FBQ0EsS0FBeUNBO1FBQzdDRSxNQUFNQSxDQUFDQSxJQUFJQSxDQUFDQSxLQUFLQSxDQUFDQSxHQUFHQSxLQUFLQSxLQUFLQSxDQUFDQSxLQUFLQSxDQUFDQSxHQUFHQTtZQUNyQ0EsSUFBSUEsQ0FBQ0EsR0FBR0EsQ0FBQ0EsR0FBR0EsS0FBS0EsS0FBS0EsQ0FBQ0EsR0FBR0EsQ0FBQ0EsR0FBR0E7WUFDOUJBLElBQUlBLENBQUNBLEtBQUtBLENBQUNBLE1BQU1BLEtBQUtBLEtBQUtBLENBQUNBLEtBQUtBLENBQUNBLE1BQU1BO1lBQ3hDQSxJQUFJQSxDQUFDQSxHQUFHQSxDQUFDQSxNQUFNQSxLQUFLQSxLQUFLQSxDQUFDQSxHQUFHQSxDQUFDQSxNQUFNQSxDQUFDQTtJQUM3Q0EsQ0FBQ0E7SUFRREYsUUFBUUE7UUFDSkcsTUFBTUEsQ0FBQ0EsQ0FBQ0EsVUFBVUEsR0FBR0EsSUFBSUEsQ0FBQ0EsS0FBS0EsQ0FBQ0EsR0FBR0EsR0FBR0EsR0FBR0EsR0FBR0EsSUFBSUEsQ0FBQ0EsS0FBS0EsQ0FBQ0EsTUFBTUE7WUFDekRBLFFBQVFBLEdBQUdBLElBQUlBLENBQUNBLEdBQUdBLENBQUNBLEdBQUdBLEdBQUdBLEdBQUdBLEdBQUdBLElBQUlBLENBQUNBLEdBQUdBLENBQUNBLE1BQU1BLEdBQUdBLEdBQUdBLENBQUNBLENBQUNBO0lBQy9EQSxDQUFDQTtJQVVESCxRQUFRQSxDQUFDQSxHQUFXQSxFQUFFQSxNQUFjQTtRQUNoQ0ksTUFBTUEsQ0FBQ0EsSUFBSUEsQ0FBQ0EsT0FBT0EsQ0FBQ0EsR0FBR0EsRUFBRUEsTUFBTUEsQ0FBQ0EsS0FBS0EsQ0FBQ0EsQ0FBQ0E7SUFDM0NBLENBQUNBO0lBZ0JESixZQUFZQSxDQUFDQSxLQUFZQTtRQUNyQkssSUFBSUEsR0FBV0EsQ0FBQUE7UUFDZkEsSUFBSUEsR0FBR0EsR0FBR0EsS0FBS0EsQ0FBQ0EsR0FBR0EsQ0FBQ0E7UUFDcEJBLElBQUlBLEtBQUtBLEdBQUdBLEtBQUtBLENBQUNBLEtBQUtBLENBQUNBO1FBRXhCQSxHQUFHQSxHQUFHQSxJQUFJQSxDQUFDQSxPQUFPQSxDQUFDQSxHQUFHQSxDQUFDQSxHQUFHQSxFQUFFQSxHQUFHQSxDQUFDQSxNQUFNQSxDQUFDQSxDQUFDQTtRQUN4Q0EsRUFBRUEsQ0FBQ0EsQ0FBQ0EsR0FBR0EsS0FBS0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0E7WUFDWkEsR0FBR0EsR0FBR0EsSUFBSUEsQ0FBQ0EsT0FBT0EsQ0FBQ0EsS0FBS0EsQ0FBQ0EsR0FBR0EsRUFBRUEsS0FBS0EsQ0FBQ0EsTUFBTUEsQ0FBQ0EsQ0FBQ0E7WUFDNUNBLEVBQUVBLENBQUNBLENBQUNBLEdBQUdBLEtBQUtBLENBQUNBLENBQUNBLENBQUNBLENBQUNBO2dCQUNaQSxNQUFNQSxDQUFDQSxDQUFDQSxDQUFDQTtZQUNiQSxDQUFDQTtZQUNEQSxJQUFJQSxDQUFDQSxFQUFFQSxDQUFDQSxDQUFDQSxHQUFHQSxLQUFLQSxDQUFDQSxDQUFDQSxDQUFDQSxDQUFDQTtnQkFDakJBLE1BQU1BLENBQUNBLENBQUNBLENBQUNBO1lBQ2JBLENBQUNBO1lBQ0RBLElBQUlBLENBQUNBLENBQUNBO2dCQUNGQSxNQUFNQSxDQUFDQSxDQUFDQSxDQUFDQTtZQUNiQSxDQUFDQTtRQUNMQSxDQUFDQTtRQUNEQSxJQUFJQSxDQUFDQSxFQUFFQSxDQUFDQSxDQUFDQSxHQUFHQSxLQUFLQSxDQUFDQSxDQUFDQSxDQUFDQSxDQUFDQSxDQUFDQTtZQUNsQkEsTUFBTUEsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0E7UUFDZEEsQ0FBQ0E7UUFDREEsSUFBSUEsQ0FBQ0EsQ0FBQ0E7WUFDRkEsR0FBR0EsR0FBR0EsSUFBSUEsQ0FBQ0EsT0FBT0EsQ0FBQ0EsS0FBS0EsQ0FBQ0EsR0FBR0EsRUFBRUEsS0FBS0EsQ0FBQ0EsTUFBTUEsQ0FBQ0EsQ0FBQ0E7WUFDNUNBLEVBQUVBLENBQUNBLENBQUNBLEdBQUdBLEtBQUtBLENBQUNBLENBQUNBLENBQUNBLENBQUNBLENBQUNBO2dCQUNiQSxNQUFNQSxDQUFDQSxDQUFDQSxDQUFDQSxDQUFDQTtZQUNkQSxDQUFDQTtZQUNEQSxJQUFJQSxDQUFD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Q0EsV0FBV0EsRUFBRUEsQ0FBQ0EsQ0FBQ0EsQ0FBQ0E7WUFDdEJBLEVBQUVBLENBQUNBLENBQUNBLEdBQUdBLEtBQUtBLElBQUlBLENBQUNBLEtBQUtBLENBQUNBLEdBQUdBLENBQUNBLENBQUNBLENBQUNBO2dCQUN6QkEsTUFBTUEsQ0FBQ0EsTUFBTUEsR0FBR0EsSUFBSUEsQ0FBQ0EsS0FBS0EsQ0FBQ0EsTUFBTUEsR0FBR0EsQ0FBQ0EsQ0FBQ0EsR0FBR0EsQ0FBQ0EsTUFBTUEsR0FBR0EsSUFBSUEsQ0FBQ0EsR0FBR0EsQ0FBQ0EsTUFBTUEsR0FBR0EsQ0FBQ0EsR0FBR0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0E7WUFDaEZBLENBQUNBO1FBQ0xBLENBQUNBO1FBRURBLEVBQUVBLENBQUNBLENBQUNBLEdBQUdBLEdBQUdBLElBQUlBLENBQUNBLEtBQUtBLENBQUNBLEdBQUdBLENBQUNBO1lBQ3JCQSxNQUFNQSxDQUFDQSxDQUFDQSxDQUFDQSxDQUFDQTtRQUVkQSxFQUFFQSxDQUFDQSxDQUFDQSxHQUFHQSxHQUFHQSxJQUFJQSxDQUFDQSxHQUFHQSxDQUFDQSxHQUFHQSxDQUFDQTtZQUNuQkEsTUFBTUEsQ0FBQ0EsQ0FBQ0EsQ0FBQ0E7UUFFYkEsRUFBRUEsQ0FBQ0EsQ0FBQ0EsSUFBSUEsQ0FBQ0EsS0FBS0EsQ0FBQ0EsR0FBR0EsS0FBS0EsR0FBR0EsQ0FBQ0E7WUFDdkJBLE1BQU1BLENBQUNBLE1BQU1BLElBQUlBLElBQUlBLENBQUNBLEtBQUtBLENBQUNBLE1BQU1BLEdBQUdBLENBQUNBLEdBQUdBLENBQUNBLENBQUNBLENBQUNBO1FBRWhEQSxFQUFFQSxDQUFDQSxDQUFDQSxJQUFJQSxDQUFDQSxHQUFHQSxDQUFDQSxHQUFHQSxLQUFLQSxHQUFHQSxDQUFDQTtZQUNyQkEsTUFBTUEsQ0FBQ0EsTUFBTUEsSUFBSUEsSUFBSUEsQ0FBQ0EsR0FBR0EsQ0FBQ0EsTUFBTUEsR0FBR0EsQ0FBQ0EsR0FBR0EsQ0FBQ0EsQ0FBQ0E7UUFFN0NBLE1BQU1BLENBQUNBLENBQUNBLENBQUNBO0lBQ2JBLENBQUNBO0lBd0JEaEIsWUFBWUEsQ0FBQ0EsR0FBV0EsRUFBRUEsTUFBY0E7UUFDcENpQixFQUFFQSxDQUFDQSxDQUFDQSxJQUFJQSxDQUFDQSxLQUFLQSxDQUFDQSxHQUFHQSxLQUFLQSxHQUFHQSxJQUFJQSxJQUFJQSxDQUFDQSxLQUFLQSxDQUFDQSxNQUFNQSxLQUFLQSxNQUFNQSxDQUFDQSxDQUFDQSxDQUFDQTtZQUN6REEsTUFBTUEsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0E7UUFDZEEsQ0FBQ0E7UUFDREEsSUFBSUEsQ0FBQ0EsQ0FBQ0E7WUFDRkEsTUFBTUEsQ0FBQ0EsSUFBSUEsQ0FBQ0EsT0FBT0EsQ0FBQ0EsR0FBR0EsRUFBRUEsTUFBTUEsQ0FBQ0EsQ0FBQ0E7UUFDckNBLENBQUNBO0lBQ0xBLENBQUNBO0lBdUJEakIsVUFBVUEsQ0FBQ0EsR0FBV0EsRUFBRUEsTUFBY0E7UUFDbENrQixFQUFFQSxDQUFDQSxDQUFDQSxJQUFJQSxDQUFDQSxHQUFHQSxDQUFDQSxHQUFHQSxLQUFLQSxHQUFHQSxJQUFJQSxJQUFJQSxDQUFDQSxHQUFHQSxDQUFDQSxNQUFNQSxLQUFLQSxNQUFNQSxDQUFDQSxDQUFDQSxDQUFDQTtZQUNyREEsTUFBTUEsQ0FBQ0EsQ0FBQ0EsQ0FBQ0E7UUFDYkEsQ0FBQ0E7UUFDREEsSUFBSUEsQ0FBQ0EsQ0FBQ0E7WUFDRkEsTUFBTUEsQ0FBQ0EsSUFBSUEsQ0FBQ0EsT0FBT0EsQ0FBQ0EsR0FBR0EsRUFBRUEsTUFBTUEsQ0FBQ0EsQ0FBQ0E7UUFDckNBLENBQUNBO0lBQ0xBLENBQUNBO0lBaUJEbEIsYUFBYUEsQ0FBQ0EsR0FBV0EsRUFBRUEsTUFBY0E7UUFDckNtQixFQUFFQSxDQUFDQSxDQUFDQSxJQUFJQSxDQUFDQSxHQUFHQSxDQUFDQSxHQUFHQSxLQUFLQSxHQUFHQSxJQUFJQSxJQUFJQSxDQUFDQSxHQUFHQSxDQUFDQSxNQUFNQSxLQUFLQSxNQUFNQSxDQUFDQSxDQUFDQSxDQUFDQTtZQUNyREEsTUFBTUEsQ0FBQ0EsQ0FBQ0EsQ0FBQ0E7UUFDYkEsQ0FBQ0E7UUFDREEs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SUEsQ0FBQ0EsR0FBR0EsQ0FBQ0EsQ0FBQ0E7SUFDbEVBLENBQUNBO0lBTURyQixPQUFPQTtRQUNIc0IsTUFBTUEsQ0FBQ0EsQ0FBQ0EsSUFBSUEsQ0FBQ0EsS0FBS0EsQ0FBQ0EsR0FBR0EsS0FBS0EsSUFBSUEsQ0FBQ0EsR0FBR0EsQ0FBQ0EsR0FBR0EsSUFBSUEsSUFBSUEsQ0FBQ0EsS0FBS0EsQ0FBQ0EsTUFBTUEsS0FBS0EsSUFBSUEsQ0FBQ0EsR0FBR0EsQ0FBQ0EsTUFBTUEsQ0FBQ0EsQ0FBQ0E7SUFDdEZBLENBQUNBO0lBUUR0QixXQUFXQTtRQUNQdUIsTUFBTUEsQ0FBQ0EsQ0FBQ0EsSUFBSUEsQ0FBQ0EsS0FBS0EsQ0FBQ0EsR0FBR0EsS0FBS0EsSUFBSUEsQ0FBQ0EsR0FBR0EsQ0FBQ0EsR0FBR0EsQ0FBQ0EsQ0FBQ0E7SUFDN0NBLENBQUNBO0lBUUR2QixLQUFLQTtRQUNEd0IsTUFBTUEsQ0FBQ0EsS0FBS0EsQ0FBQ0EsVUFBVUEsQ0FBQ0EsSUFBSUEsQ0FBQ0EsS0FBS0EsRUFBRUEsSUFBSUEsQ0FBQ0EsR0FBR0EsQ0FBQ0EsQ0FBQ0E7SUFDbERBLENBQUNBO0lBUUR4QixZQUFZQTtRQUNSeUIsRUFBRUEsQ0FBQ0EsQ0FBQ0EsSUFBSUEsQ0FBQ0EsR0FBR0EsQ0FBQ0EsTUFBTUEsS0FBS0EsQ0FBQ0EsQ0FBQ0E7WUFDdEJBLE1BQU1BLENBQUNBLElBQUlBLEtBQUtBLENBQUNBLElBQUlBLENBQUNBLEtBQUtBLENBQUNBLEdBQUdBLEVBQUVBLENBQUNBLEVBQUVBLElBQUlBLENBQUNBLEdBQUdBLENBQUNBLElBQUlBLENBQUNBLEtBQUtBLENBQUNBLEdBQUdBLEVBQUVBLElBQUlBLENBQUNBLEdBQUdBLENBQUNBLEdBQUdBLEdBQUdBLENBQUNBLENBQUNBLEVBQUVBLENBQUNBLENBQUNBLENBQUFBO1FBQ3RGQSxJQUFJQTtZQUNBQSxNQUFNQSxDQUFDQSxJQUFJQSxLQUFLQSxDQUFDQSxJQUFJQSxDQUFDQSxLQUFLQSxDQUFDQSxHQUFHQSxFQUFFQSxDQUFDQSxFQUFFQSxJQUFJQSxDQUFDQSxHQUFHQSxDQUFDQSxHQUFHQSxFQUFFQSxDQUFDQSxDQUFDQSxDQUFBQTtJQUM1REEsQ0FBQ0E7SUFHRHpCLE1BQU1BLENBQUNBLEdBQVdBLEVBQUVBLE1BQWNBO1FBQzlCMEIsSUFBSUEsQ0FBQ0EsS0FBS0EsQ0FBQ0EsR0FBR0EsSUFBSUEsR0FBR0EsQ0FBQ0E7UUFDdEJBLElBQUlBLENBQUNBLEtBQUtBLENBQUNBLE1BQU1BLElBQUlBLE1BQU1BLENBQUNBO1FBQzVCQSxJQUFJQSxDQUFDQSxHQUFHQSxDQUFDQSxHQUFHQSxJQUFJQSxHQUFHQSxDQUFDQTtRQUNwQkEsSUFBSUEsQ0FBQ0EsR0FBR0EsQ0FBQ0EsTUFBTUEsSUFBSUEsTUFBTUEsQ0FBQ0E7SUFDOUJBLENBQUNBO0lBU0QxQixPQUFjQSxVQUFVQSxDQUFDQSxLQUFlQSxFQUFFQSxHQUFhQTtRQUNuRDJCLE1BQU1BLENBQUNBLElBQUlBLEtBQUtBLENBQUNBLEtBQUtBLENBQUNBLEdBQUdBLEVBQUVBLEtBQUtBLENBQUNBLE1BQU1BLEVBQUVBLEdBQUdBLENBQUNBLEdBQUdBLEVBQUVBLEdBQUdBLENBQUNBLE1BQU1BLENBQUNBLENBQUNBO0lBQ25FQSxDQUFDQTtJQVNEM0IsT0FBY0EsYUFBYUEsQ0FBQ0EsRUFBWUEsRUFBRUEsRUFBWUE7UUFDbEQ0QixNQUFNQSxDQUFDQSxFQUFFQSxDQUFDQSxHQUFHQSxHQUFHQSxFQUFFQSxDQUFDQSxHQUFHQSxJQUFJQSxFQUFFQSxDQUFDQSxNQUFNQSxHQUFHQSxFQUFFQSxDQUFDQSxNQUFNQSxDQUFDQTtJQUNwREEsQ0FBQ0E7QUFDTDVCLENBQUNBO0FBQUEiLCJzb3VyY2VzQ29udGVudCI6WyIvKiAqKioqKiBCRUdJTiBMSUNFTlNFIEJMT0NLICoqKioqXG4gKiBUaGUgTUlUIExpY2Vuc2UgKE1JVClcbiAqXG4gKiBDb3B5cmlnaHQgKGMpIDIwMTQtMjAxNiBEYXZpZCBHZW8gSG9sbWVzIDxkYXZpZC5nZW8uaG9sbWVzQGdtYWlsLmNvbT5cbiAqXG4gKiBQZXJtaXNzaW9uIGlzIGhlcmVieSBncmFudGVkLCBmcmVlIG9mIGNoYXJnZSwgdG8gYW55IHBlcnNvbiBvYnRhaW5pbmcgYSBjb3B5XG4gKiBvZiB0aGlzIHNvZnR3YXJlIGFuZCBhc3NvY2lhdGVkIGRvY3VtZW50YXRpb24gZmlsZXMgKHRoZSBcIlNvZnR3YXJlXCIpLCB0byBkZWFsXG4gKiBpbiB0aGUgU29mdHdhcmUgd2l0aG91dCByZXN0cmljdGlvbiwgaW5jbHVkaW5nIHdpdGhvdXQgbGltaXRhdGlvbiB0aGUgcmlnaHRzXG4gKiB0byB1c2UsIGNvcHksIG1vZGlmeSwgbWVyZ2UsIHB1Ymxpc2gsIGRpc3RyaWJ1dGUsIHN1YmxpY2Vuc2UsIGFuZC9vciBzZWxsXG4gKiBjb3BpZXMgb2YgdGhlIFNvZnR3YXJlLCBhbmQgdG8gcGVybWl0IHBlcnNvbnMgdG8gd2hvbSB0aGUgU29mdHdhcmUgaXNcbiAqIGZ1cm5pc2hlZCB0byBkbyBzbywgc3ViamVjdCB0byB0aGUgZm9sbG93aW5nIGNvbmRpdGlvbnM6XG4gKlxuICogVGhlIGFib3ZlIGNvcHlyaWdodCBub3RpY2UgYW5kIHRoaXMgcGVybWlzc2lvbiBub3RpY2Ugc2hhbGwgYmUgaW5jbHVkZWQgaW4gYWxsXG4gKiBjb3BpZXMgb3Igc3Vic3RhbnRpYWwgcG9ydGlvbnMgb2YgdGhlIFNvZnR3YXJlLlxuICpcbiAqIFRIRSBTT0ZUV0FSRSBJUyBQUk9WSURFRCBcIkFTIElTXCIsIFdJVEhPVVQgV0FSUkFOVFkgT0YgQU5ZIEtJTkQsIEVYUFJFU1MgT1JcbiAqIElNUExJRUQsIElOQ0xVRElORyBCVVQgTk9UIExJTUlURUQgVE8gVEhFIFdBUlJBTlRJRVMgT0YgTUVSQ0hBTlRBQklMSVRZLFxuICogRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UgQU5EIE5PTklORlJJTkdFTUVOVC4gSU4gTk8gRVZFTlQgU0hBTEwgVEhFXG4gKiBBVVRIT1JTIE9SIENPUFlSSUdIVCBIT0xERVJTIEJFIExJQUJMRSBGT1IgQU5ZIENMQUlNLCBEQU1BR0VTIE9SIE9USEVSXG4gKiBMSUFCSUxJVFksIFdIRVRIRVIgSU4gQU4gQUNUSU9OIE9GIENPTlRSQUNULCBUT1JUIE9SIE9USEVSV0lTRSwgQVJJU0lORyBGUk9NLFxuICogT1VUIE9GIE9SIElOIENPTk5FQ1RJT04gV0lUSCBUSEUgU09GVFdBUkUgT1IgVEhFIFVTRSBPUiBPVEhFUiBERUFMSU5HUyBJTiBUSEVcbiAqIFNPRlRXQVJFLlxuICogKioqKiogRU5EIExJQ0VOU0UgQkxPQ0sgKioqKiogKi9cbi8qICoqKioqIEJFR0lOIExJQ0VOU0UgQkxPQ0sgKioqKipcbiAqIERpc3RyaWJ1dGVkIHVuZGVyIHRoZSBCU0QgbGljZW5zZTpcbiAqXG4gKiBDb3B5cmlnaHQgKGMpIDIwMTAsIEFqYXgub3JnIEIuVi5cbiAqIEFsbCByaWdodHMgcmVzZXJ2ZWQuXG4gKlxuICogUmVkaXN0cmlidXRpb24gYW5kIHVzZSBpbiBzb3VyY2UgYW5kIGJpbmFyeSBmb3Jtcywgd2l0aCBvciB3aXRob3V0XG4gKiBtb2RpZmljYXRpb24sIGFyZSBwZXJtaXR0ZWQgcHJvdmlkZWQgdGhhdCB0aGUgZm9sbG93aW5nIGNvbmRpdGlvbnMgYXJlIG1ldDpcbiAqICAgICAqIFJlZGlzdHJpYnV0aW9ucyBvZiBzb3VyY2UgY29kZSBtdXN0IHJldGFpbiB0aGUgYWJvdmUgY29weXJpZ2h0XG4gKiAgICAgICBub3RpY2UsIHRoaXMgbGlzdCBvZiBjb25kaXRpb25zIGFuZCB0aGUgZm9sbG93aW5nIGRpc2NsYWltZXIuXG4gKiAgICAgKiBSZWRpc3RyaWJ1dGlvbnMgaW4gYmluYXJ5IGZvcm0gbXVzdCByZXByb2R1Y2UgdGhlIGFib3ZlIGNvcHlyaWdodFxuICogICAgICAgbm90aWNlLCB0aGlzIGxpc3Qgb2YgY29uZGl0aW9ucyBhbmQgdGhlIGZvbGxvd2luZyBkaXNjbGFpbWVyIGluIHRoZVxuICogICAgICAgZG9jdW1lbnRhdGlvbiBhbmQvb3Igb3RoZXIgbWF0ZXJpYWxzIHByb3ZpZGVkIHdpdGggdGhlIGRpc3RyaWJ1dGlvbi5cbiAqICAgICAqIE5laXRoZXIgdGhlIG5hbWUgb2YgQWpheC5vcmcgQi5WLiBub3IgdGhlXG4gKiAgICAgICBuYW1lcyBvZiBpdHMgY29udHJpYnV0b3JzIG1heSBiZSB1c2VkIHRvIGVuZG9yc2Ugb3IgcHJvbW90ZSBwcm9kdWN0c1xuICogICAgICAgZGVyaXZlZCBmcm9tIHRoaXMgc29mdHdhcmUgd2l0aG91dCBzcGVjaWZpYyBwcmlvciB3cml0dGVuIHBlcm1pc3Npb24uXG4gKlxuICogVEhJUyBTT0ZUV0FSRSBJUyBQUk9WSURFRCBCWSBUSEUgQ09QWVJJR0hUIEhPTERFUlMgQU5EIENPTlRSSUJVVE9SUyBcIkFTIElTXCIgQU5EXG4gKiBBTlkgRVhQUkVTUyBPUiBJTVBMSUVEIFdBUlJBTlRJRVMsIElOQ0xVRElORywgQlVUIE5PVCBMSU1JVEVEIFRPLCBUSEUgSU1QTElFRFxuICogV0FSUkFOVElFUyBPRiBNRVJDSEFOVEFCSUxJVFkgQU5EIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFIEFSRVxuICogRElTQ0xBSU1FRC4gSU4gTk8gRVZFTlQgU0hBTEwgQUpBWC5PUkcgQi5WLiBCRSBMSUFCTEUgRk9SIEFOWVxuICogRElSRUNULCBJTkRJUkVDVCwgSU5DSURFTlRBTCwgU1BFQ0lBTCwgRVhFTVBMQVJZLCBPUiBDT05TRVFVRU5USUFMIERBTUFHRVNcbiAqIChJTkNMVURJTkcsIEJVVCBOT1QgTElNSVRFRCBUTywgUFJPQ1VSRU1FTlQgT0YgU1VCU1RJVFVURSBHT09EUyBPUiBTRVJWSUNFUztcbiAqIExPU1MgT0YgVVNFLCBEQVRBLCBPUiBQUk9GSVRTOyBPUiBCVVNJTkVTUyBJTlRFUlJVUFRJT04pIEhPV0VWRVIgQ0FVU0VEIEFORFxuICogT04gQU5ZIFRIRU9SWSBPRiBMSUFCSUxJVFksIFdIRVRIRVIgSU4gQ09OVFJBQ1QsIFNUUklDVCBMSUFCSUxJVFksIE9SIFRPUlRcbiAqIChJTkNMVURJTkcgTkVHTElHRU5DRSBPUiBPVEhFUldJU0UpIEFSSVNJTkcgSU4gQU5ZIFdBWSBPVVQgT0YgVEhFIFVTRSBPRiBUSElTXG4gKiBTT0ZUV0FSRSwgRVZFTiBJRiBBRFZJU0VEIE9GIFRIRSBQT1NTSUJJTElUWSBPRiBTVUNIIERBTUFHRS5cbiAqXG4gKiAqKioqKiBFTkQgTElDRU5TRSBCTE9DSyAqKioqKiAqL1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbmltcG9ydCBQb3NpdGlvbiBmcm9tIFwiLi9Qb3NpdGlvblwiO1xuLyoqXG4gKiBUaGlzIG9iamVjdCBpcyB1c2VkIGluIHZhcmlvdXMgcGxhY2VzIHRvIGluZGljYXRlIGEgcmVnaW9uIHdpdGhpbiB0aGUgZWRpdG9yLlxuICogVG8gYmV0dGVyIHZpc3VhbGl6ZSBob3cgdGhpcyB3b3JrcywgaW1hZ2luZSBhIHJlY3RhbmdsZS5cbiAqIEVhY2ggcXVhZHJhbnQgb2YgdGhlIHJlY3RhbmdsZSBpcyBhbmFsb2d1cyB0byBhIHJhbmdlLCBhcyByYW5nZXMgY29udGFpbiBhIHN0YXJ0aW5nIHJvdyBhbmQgc3RhcnRpbmcgY29sdW1uLCBhbmQgYW4gZW5kaW5nIHJvdywgYW5kIGVuZGluZyBjb2x1bW4uXG4gKlxuICogQGNsYXNzIFJhbmdlXG4gKi9cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFJhbmdlIHtcblxuICAgIC8qKlxuICAgICAqIEBwcm9wZXJ0eSBzdGFydFxuICAgICAqIEB0eXBlIFBvc2l0aW9uXG4gICAgICovXG4gICAgcHVibGljIHN0YXJ0OiBQb3NpdGlvbjtcblxuICAgIC8qKlxuICAgICAqIEBwcm9wZXJ0eSBlbmRcbiAgICAgKiBAdHlwZSBQb3NpdGlvblxuICAgICAqL1xuICAgIHB1YmxpYyBlbmQ6IFBvc2l0aW9uO1xuXG4gICAgLyoqXG4gICAgICogQSBtYXJrZXIgaWQgdGhhdCBpcyBiZWluZyBzbmVha2VkIG9udG8gdGhlIFJhbmdlLlxuICAgICAqXG4gICAgICogQHByb3BlcnR5IG1hcmtlcklkXG4gICAgICogQHR5cGUgbnVtYmVyXG4gICAgICogQGRlcHJlY2F0ZWRcbiAgICAgKi9cbiAgICBwdWJsaWMgbWFya2VySWQ6IG51bWJlcjtcblxuICAgIC8qKlxuICAgICAqIEBwcm9wZXJ0eSBjb2xsYXBzZUNoaWxkcmVuXG4gICAgICogQHR5cGUgbnVtYmVyXG4gICAgICogQGRlcHJlY2F0ZWRcbiAgICAgKi9cbiAgICBwdWJsaWMgY29sbGFwc2VDaGlsZHJlbjogbnVtYmVyO1xuICAgIC8vICBwdWJsaWMgY3Vyc29yOiBSYW5nZTtcbiAgICAvLyAgcHVibGljIGlzQmFja3dhcmRzOiBib29sZWFuO1xuXG4gICAgLyoqXG4gICAgICogQ3JlYXRlcyBhIG5ldyBgRWRpdG9yUmFuZ2VgIG9iamVjdCB3aXRoIHRoZSBnaXZlbiBzdGFydGluZyBhbmQgZW5kaW5nIHJvdyBhbmQgY29sdW1uIHBvaW50cy5cbiAgICAgKlxuICAgICAqIEBjbGFzcyBSYW5nZVxuICAgICAqIEBjb25zdHJ1Y3RvclxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBzdGFydFJvdyBUaGUgc3RhcnRpbmcgcm93XG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IHN0YXJ0Q29sdW1uIFRoZSBzdGFydGluZyBjb2x1bW5cbiAgICAgKiBAcGFyYW0ge051bWJlcn0gZW5kUm93IFRoZSBlbmRpbmcgcm93XG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IGVuZENvbHVtbiBUaGUgZW5kaW5nIGNvbHVtblxuICAgICAqL1xuICAgIGNvbnN0cnVjdG9yKHN0YXJ0Um93OiBudW1iZXIsIHN0YXJ0Q29sdW1uOiBudW1iZXIsIGVuZFJvdzogbnVtYmVyLCBlbmRDb2x1bW46IG51bWJlcikge1xuICAgICAgICB0aGlzLnN0YXJ0ID0ge1xuICAgICAgICAgICAgcm93OiBzdGFydFJvdyxcbiAgICAgICAgICAgIGNvbHVtbjogc3RhcnRDb2x1bW5cbiAgICAgICAgfTtcblxuICAgICAgICB0aGlzLmVuZCA9IHtcbiAgICAgICAgICAgIHJvdzogZW5kUm93LFxuICAgICAgICAgICAgY29sdW1uOiBlbmRDb2x1bW5cbiAgICAgICAgfTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIGB0cnVlYCBpZiBhbmQgb25seSBpZiB0aGUgc3RhcnRpbmcgcm93IGFuZCBjb2x1bW4sIGFuZCBlbmRpbmcgcm93IGFuZCBjb2x1bW4sIGFyZSBlcXVpdmFsZW50IHRvIHRob3NlIGdpdmVuIGJ5IGByYW5nZWAuXG4gICAgICpcbiAgICAgKiBAbWV0aG9kIGlzRXF1YWxcbiAgICAgKiBAcGFyYW0gcmFuZ2Uge1JhbmdlfSBBIHJhbmdlIHRvIGNoZWNrIGFnYWluc3QuXG4gICAgICogQHJldHVybiB7Ym9vbGVhbn1cbiAgICAgKi9cbiAgICBpc0VxdWFsKHJhbmdlOiB7IHN0YXJ0OiBQb3NpdGlvbjsgZW5kOiBQb3NpdGlvbiB9KTogYm9vbGVhbiB7XG4gICAgICAgIHJldHVybiB0aGlzLnN0YXJ0LnJvdyA9PT0gcmFuZ2Uuc3RhcnQucm93ICYmXG4gICAgICAgICAgICB0aGlzLmVuZC5yb3cgPT09IHJhbmdlLmVuZC5yb3cgJiZcbiAgICAgICAgICAgIHRoaXMuc3RhcnQuY29sdW1uID09PSByYW5nZS5zdGFydC5jb2x1bW4gJiZcbiAgICAgICAgICAgIHRoaXMuZW5kLmNvbHVtbiA9PT0gcmFuZ2UuZW5kLmNvbHVtbjtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIGEgc3RyaW5nIGNvbnRhaW5pbmcgdGhlIHJhbmdlJ3Mgcm93IGFuZCBjb2x1bW4gaW5mb3JtYXRpb24uXG4gICAgICpcbiAgICAgKiBAbWV0aG9kIHRvU3RyaW5nXG4gICAgICogQHJldHVybiB7c3RyaW5nfVxuICAgICAqL1xuICAgIHRvU3RyaW5nKCk6IHN0cmluZyB7XG4gICAgICAgIHJldHVybiAoXCJSYW5nZTogW1wiICsgdGhpcy5zdGFydC5yb3cgKyBcIi9cIiArIHRoaXMuc3RhcnQuY29sdW1uICtcbiAgICAgICAgICAgIFwiXSAtPiBbXCIgKyB0aGlzLmVuZC5yb3cgKyBcIi9cIiArIHRoaXMuZW5kLmNvbHVtbiArIFwiXVwiKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIGB0cnVlYCBpZiB0aGUgYHJvd2AgYW5kIGBjb2x1bW5gIHByb3ZpZGVkIGFyZSB3aXRoaW4gdGhlIGdpdmVuIHJhbmdlLlxuICAgICAqXG4gICAgICogQG1ldGhvZCBjb250YWluc1xuICAgICAqIEBwYXJhbSByb3cge251bWJlcn0gQSByb3cgdG8gY2hlY2sgZm9yXG4gICAgICogQHBhcmFtIGNvbHVtbiB7bnVtYmVyfSBBIGNvbHVtbiB0byBjaGVjayBmb3JcbiAgICAgKiBAcmV0dXJuIHtib29sZWFufVxuICAgICAqL1xuICAgIGNvbnRhaW5zKHJvdzogbnVtYmVyLCBjb2x1bW46IG51bWJlcik6IGJvb2xlYW4ge1xuICAgICAgICByZXR1cm4gdGhpcy5jb21wYXJlKHJvdywgY29sdW1uKSA9PT0gMDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDb21wYXJlcyBgdGhpc2AgcmFuZ2UgKEEpIHdpdGggYW5vdGhlciByYW5nZSAoQikuXG4gICAgICpcbiAgICAgKiBAbWV0aG9kIGNvbXBhcmVSYW5nZVxuICAgICAqIEBwYXJhbSB7UmFuZ2V9IHJhbmdlIEEgcmFuZ2UgdG8gY29tcGFyZSB3aXRoXG4gICAgICogQHJldHVybiB7bnVtYmVyfSBUaGlzIG1ldGhvZCByZXR1cm5zIG9uZSBvZiB0aGUgZm9sbG93aW5nIG51bWJlcnM6PGJyLz5cbiAgICAgKiA8YnIvPlxuICAgICAqICogYC0yYDogKEIpIGlzIGluIGZyb250IG9mIChBKSwgYW5kIGRvZXNuJ3QgaW50ZXJzZWN0IHdpdGggKEEpPGJyLz5cbiAgICAgKiAqIGAtMWA6IChCKSBiZWdpbnMgYmVmb3JlIChBKSBidXQgZW5kcyBpbnNpZGUgb2YgKEEpPGJyLz5cbiAgICAgKiAqIGAwYDogKEIpIGlzIGNvbXBsZXRlbHkgaW5zaWRlIG9mIChBKSBPUiAoQSkgaXMgY29tcGxldGVseSBpbnNpZGUgb2YgKEIpPGJyLz5cbiAgICAgKiAqIGArMWA6IChCKSBiZWdpbnMgaW5zaWRlIG9mIChBKSBidXQgZW5kcyBvdXRzaWRlIG9mIChBKTxici8+XG4gICAgICogKiBgKzJgOiAoQikgaXMgYWZ0ZXIgKEEpIGFuZCBkb2Vzbid0IGludGVyc2VjdCB3aXRoIChBKTxici8+XG4gICAgICogKiBgNDJgOiBGVFcgc3RhdGU6IChCKSBlbmRzIGluIChBKSBidXQgc3RhcnRzIG91dHNpZGUgb2YgKEEpXG4gICAgICoqL1xuICAgIGNvbXBhcmVSYW5nZShyYW5nZTogUmFuZ2UpOiBudW1iZXIge1xuICAgICAgICB2YXIgY21wOiBudW1iZXJcbiAgICAgICAgdmFyIGVuZCA9IHJhbmdlLmVuZDtcbiAgICAgICAgdmFyIHN0YXJ0ID0gcmFuZ2Uuc3RhcnQ7XG5cbiAgICAgICAgY21wID0gdGhpcy5jb21wYXJlKGVuZC5yb3csIGVuZC5jb2x1bW4pO1xuICAgICAgICBpZiAoY21wID09PSAxKSB7XG4gICAgICAgICAgICBjbXAgPSB0aGlzLmNvbXBhcmUoc3RhcnQucm93LCBzdGFydC5jb2x1bW4pO1xuICAgICAgICAgICAgaWYgKGNtcCA9PT0gMSkge1xuICAgICAgICAgICAgICAgIHJldHVybiAyO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAoY21wID09PSAwKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIDE7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gMDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChjbXAgPT09IC0xKSB7XG4gICAgICAgICAgICByZXR1cm4gLTI7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBjbXAgPSB0aGlzLmNvbXBhcmUoc3RhcnQucm93LCBzdGFydC5jb2x1bW4pO1xuICAgICAgICAgICAgaWYgKGNtcCA9PT0gLTEpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gLTE7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChjbXAgPT09IDEpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gNDI7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gMDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENoZWNrcyB0aGUgcm93IGFuZCBjb2x1bW4gcG9pbnRzIG9mIGBwYCB3aXRoIHRoZSByb3cgYW5kIGNvbHVtbiBwb2ludHMgb2YgdGhlIGNhbGxpbmcgcmFuZ2UuXG4gICAgICpcbiAgICAgKiBAbWV0aG9kIGNvbXBhcmVQb2ludFxuICAgICAqIEBwYXJhbSBwIHtQb3NpdGlvbn0gQSBwb2ludCB0byBjb21wYXJlIHdpdGhcbiAgICAgKiBAcmV0dXJuIHtudW1iZXJ9IFRoaXMgbWV0aG9kIHJldHVybnMgb25lIG9mIHRoZSBmb2xsb3dpbmcgbnVtYmVyczo8YnIvPlxuICAgICAqICogYDBgIGlmIHRoZSB0d28gcG9pbnRzIGFyZSBleGFjdGx5IGVxdWFsPGJyLz5cbiAgICAgKiAqIGAtMWAgaWYgYHAucm93YCBpcyBsZXNzIHRoZW4gdGhlIGNhbGxpbmcgcmFuZ2U8YnIvPlxuICAgICAqICogYDFgIGlmIGBwLnJvd2AgaXMgZ3JlYXRlciB0aGFuIHRoZSBjYWxsaW5nIHJhbmdlPGJyLz5cbiAgICAgKiA8YnIvPlxuICAgICAqIElmIHRoZSBzdGFydGluZyByb3cgb2YgdGhlIGNhbGxpbmcgcmFuZ2UgaXMgZXF1YWwgdG8gYHAucm93YCwgYW5kOjxici8+XG4gICAgICogKiBgcC5jb2x1bW5gIGlzIGdyZWF0ZXIgdGhhbiBvciBlcXVhbCB0byB0aGUgY2FsbGluZyByYW5nZSdzIHN0YXJ0aW5nIGNvbHVtbiwgdGhpcyByZXR1cm5zIGAwYDxici8+XG4gICAgICogKiBPdGhlcndpc2UsIGl0IHJldHVybnMgLTE8YnIvPlxuICAgICAqPGJyLz5cbiAgICAgKiBJZiB0aGUgZW5kaW5nIHJvdyBvZiB0aGUgY2FsbGluZyByYW5nZSBpcyBlcXVhbCB0byBgcC5yb3dgLCBhbmQ6PGJyLz5cbiAgICAgKiAqIGBwLmNvbHVtbmAgaXMgbGVzcyB0aGFuIG9yIGVxdWFsIHRvIHRoZSBjYWxsaW5nIHJhbmdlJ3MgZW5kaW5nIGNvbHVtbiwgdGhpcyByZXR1cm5zIGAwYDxici8+XG4gICAgICogKiBPdGhlcndpc2UsIGl0IHJldHVybnMgMTxici8+XG4gICAgICoqL1xuICAgIGNvbXBhcmVQb2ludChwb2ludDogUG9zaXRpb24pOiBudW1iZXIge1xuICAgICAgICByZXR1cm4gdGhpcy5jb21wYXJlKHBvaW50LnJvdywgcG9pbnQuY29sdW1uKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDaGVja3MgdGhlIHN0YXJ0IGFuZCBlbmQgcG9pbnRzIG9mIGByYW5nZWAgYW5kIGNvbXBhcmVzIHRoZW0gdG8gdGhlIGNhbGxpbmcgcmFuZ2UuXG4gICAgICpcbiAgICAgKiBAbWV0aG9kIGNvbnRhaW5zUmFuZ2VcbiAgICAgKiBAcGFyYW0gcmFuZ2Uge1JhbmdlfSBBIHJhbmdlIHRvIGNvbXBhcmUgd2l0aFxuICAgICAqIEByZXR1cm4ge2Jvb2xlYW59IFJldHVybnMgYHRydWVgIGlmIHRoZSBgcmFuZ2VgIGlzIGNvbnRhaW5lZCB3aXRoaW4gdGhlIGNhbGxlcidzIHJhbmdlLlxuICAgICAqL1xuICAgIGNvbnRhaW5zUmFuZ2UocmFuZ2U6IHsgc3RhcnQ6IFBvc2l0aW9uOyBlbmQ6IFBvc2l0aW9uIH0pIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuY29tcGFyZVBvaW50KHJhbmdlLnN0YXJ0KSA9PT0gMCAmJiB0aGlzLmNvbXBhcmVQb2ludChyYW5nZS5lbmQpID09PSAwO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFJldHVybnMgYHRydWVgIGlmIHBhc3NlZCBpbiBgcmFuZ2VgIGludGVyc2VjdHMgd2l0aCB0aGUgb25lIGNhbGxpbmcgdGhpcyBtZXRob2QuXG4gICAgICpcbiAgICAgKiBAbWV0aG9kIGludGVyc2VjdHNcbiAgICAgKiBAcGFyYW0gcmFuZ2Uge1JhbmdlfSBBIHJhbmdlIHRvIGNvbXBhcmUgd2l0aC5cbiAgICAgKiBAcmV0dXJuIHtib29sZWFufVxuICAgICAqL1xuICAgIGludGVyc2VjdHMocmFuZ2U6IFJhbmdlKTogYm9vbGVhbiB7XG4gICAgICAgIHZhciBjbXAgPSB0aGlzLmNvbXBhcmVSYW5nZShyYW5nZSk7XG4gICAgICAgIHJldHVybiAoY21wID09PSAtMSB8fCBjbXAgPT09IDAgfHwgY21wID09PSAxKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIGB0cnVlYCBpZiB0aGUgY2FsbGVyJ3MgZW5kaW5nIHJvdyBwb2ludCBpcyB0aGUgc2FtZSBhcyBgcm93YCwgYW5kIGlmIHRoZSBjYWxsZXIncyBlbmRpbmcgY29sdW1uIGlzIHRoZSBzYW1lIGFzIGBjb2x1bW5gLlxuICAgICAqXG4gICAgICogQG1ldGhvZCBpc0VuZFxuICAgICAqIEBwYXJhbSByb3cge251bWJlcn0gQSByb3cgcG9pbnQgdG8gY29tcGFyZSB3aXRoLlxuICAgICAqIEBwYXJhbSBjb2x1bW4ge251bWJlcn0gQSBjb2x1bW4gcG9pbnQgdG8gY29tcGFyZSB3aXRoLlxuICAgICAqIEByZXR1cm4ge2Jvb2xlYW59XG4gICAgICovXG4gICAgaXNFbmQocm93OiBudW1iZXIsIGNvbHVtbjogbnVtYmVyKTogYm9vbGVhbiB7XG4gICAgICAgIHJldHVybiB0aGlzLmVuZC5yb3cgPT09IHJvdyAmJiB0aGlzLmVuZC5jb2x1bW4gPT09IGNvbHVtbjtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIGB0cnVlYCBpZiB0aGUgY2FsbGVyJ3Mgc3RhcnRpbmcgcm93IHBvaW50IGlzIHRoZSBzYW1lIGFzIGByb3dgLCBhbmQgaWYgdGhlIGNhbGxlcidzIHN0YXJ0aW5nIGNvbHVtbiBpcyB0aGUgc2FtZSBhcyBgY29sdW1uYC5cbiAgICAgKlxuICAgICAqIEBtZXRob2QgaXNTdGFydFxuICAgICAqIEBwYXJhbSByb3cge251bWJlcn0gQSByb3cgcG9pbnQgdG8gY29tcGFyZSB3aXRoLlxuICAgICAqIEBwYXJhbSBjb2x1bW4ge251bWJlcn0gQSBjb2x1bW4gcG9pbnQgdG8gY29tcGFyZSB3aXRoLlxuICAgICAqIEByZXR1cm4ge2Jvb2xlYW59XG4gICAgICovXG4gICAgaXNTdGFydChyb3c6IG51bWJlciwgY29sdW1uOiBudW1iZXIpOiBib29sZWFuIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuc3RhcnQucm93ID09PSByb3cgJiYgdGhpcy5zdGFydC5jb2x1bW4gPT09IGNvbHVtbjtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBTZXRzIHRoZSBzdGFydGluZyByb3cgYW5kIGNvbHVtbiBmb3IgdGhlIHJhbmdlLlxuICAgICAqXG4gICAgICogQG1ldGhvZCBzZXRTdGFydFxuICAgICAqIEBwYXJhbSByb3cge251bWJlcn0gQSByb3cgcG9pbnQgdG8gc2V0LlxuICAgICAqIEBwYXJhbSBjb2x1bW4ge251bWJlcn0gQSBjb2x1bW4gcG9pbnQgdG8gc2V0LlxuICAgICAqIEByZXR1cm4ge3ZvaWR9XG4gICAgICovXG4gICAgc2V0U3RhcnQocm93OiBudW1iZXIsIGNvbHVtbjogbnVtYmVyKTogdm9pZCB7XG4gICAgICAgIHRoaXMuc3RhcnQucm93ID0gcm93O1xuICAgICAgICB0aGlzLnN0YXJ0LmNvbHVtbiA9IGNvbHVtbjtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBTZXRzIHRoZSBzdGFydGluZyByb3cgYW5kIGNvbHVtbiBmb3IgdGhlIHJhbmdlLlxuICAgICAqXG4gICAgICogQG1ldGhvZCBzZXRFbmRcbiAgICAgKiBAcGFyYW0gcm93IHtudW1iZXJ9IEEgcm93IHBvaW50IHRvIHNldC5cbiAgICAgKiBAcGFyYW0gY29sdW1uIHtudW1iZXJ9IEEgY29sdW1uIHBvaW50IHRvIHNldC5cbiAgICAgKiBAcmV0dXJuIHt2b2lkfVxuICAgICAqL1xuICAgIHNldEVuZChyb3c6IG51bWJlciwgY29sdW1uOiBudW1iZXIpOiB2b2lkIHtcbiAgICAgICAgdGhpcy5lbmQucm93ID0gcm93O1xuICAgICAgICB0aGlzLmVuZC5jb2x1bW4gPSBjb2x1bW47XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogUmV0dXJucyBgdHJ1ZWAgaWYgdGhlIGByb3dgIGFuZCBgY29sdW1uYCBhcmUgd2l0aGluIHRoZSBnaXZlbiByYW5nZS5cbiAgICAgKlxuICAgICAqIEBtZXRob2QgaW5zaWRlXG4gICAgICogQHBhcmFtIHJvdyB7bnVtYmVyfSBBIHJvdyBwb2ludCB0byBjb21wYXJlIHdpdGguXG4gICAgICogQHBhcmFtIGNvbHVtbiB7bnVtYmVyfSBBIGNvbHVtbiBwb2ludCB0byBjb21wYXJlIHdpdGguXG4gICAgICogQHJldHVybiB7Ym9vbGVhbn1cbiAgICAgKi9cbiAgICBpbnNpZGUocm93OiBudW1iZXIsIGNvbHVtbjogbnVtYmVyKTogYm9vbGVhbiB7XG4gICAgICAgIGlmICh0aGlzLmNvbXBhcmUocm93LCBjb2x1bW4pID09PSAwKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5pc0VuZChyb3csIGNvbHVtbikgfHwgdGhpcy5pc1N0YXJ0KHJvdywgY29sdW1uKSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIGB0cnVlYCBpZiB0aGUgYHJvd2AgYW5kIGBjb2x1bW5gIGFyZSB3aXRoaW4gdGhlIGdpdmVuIHJhbmdlJ3Mgc3RhcnRpbmcgcG9pbnRzLlxuICAgICAqXG4gICAgICogQG1ldGhvZCBpbnNpZGVTdGFydFxuICAgICAqIEBwYXJhbSByb3cge251bWJlcn0gQSByb3cgcG9pbnQgdG8gY29tcGFyZSB3aXRoLlxuICAgICAqIEBwYXJhbSBjb2x1bW4ge251bWJlcn0gQSBjb2x1bW4gcG9pbnQgdG8gY29tcGFyZSB3aXRoLlxuICAgICAqIEByZXR1cm4ge2Jvb2xlYW59XG4gICAgICovXG4gICAgaW5zaWRlU3RhcnQocm93OiBudW1iZXIsIGNvbHVtbjogbnVtYmVyKTogYm9vbGVhbiB7XG4gICAgICAgIGlmICh0aGlzLmNvbXBhcmUocm93LCBjb2x1bW4pID09PSAwKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5pc0VuZChyb3csIGNvbHVtbikpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogUmV0dXJucyBgdHJ1ZWAgaWYgdGhlIGByb3dgIGFuZCBgY29sdW1uYCBhcmUgd2l0aGluIHRoZSBnaXZlbiByYW5nZSdzIGVuZGluZyBwb2ludHMuXG4gICAgICpcbiAgICAgKiBAbWV0aG9kIGluc2lkZUVuZFxuICAgICAqIEBwYXJhbSByb3cge251bWJlcn0gQSByb3cgcG9pbnQgdG8gY29tcGFyZSB3aXRoLlxuICAgICAqIEBwYXJhbSBjb2x1bW4ge251bWJlcn0gQSBjb2x1bW4gcG9pbnQgdG8gY29tcGFyZSB3aXRoLlxuICAgICAqIEByZXR1cm4ge2Jvb2xlYW59XG4gICAgICovXG4gICAgaW5zaWRlRW5kKHJvdzogbnVtYmVyLCBjb2x1bW46IG51bWJlcik6IGJvb2xlYW4ge1xuICAgICAgICBpZiAodGhpcy5jb21wYXJlKHJvdywgY29sdW1uKSA9PT0gMCkge1xuICAgICAgICAgICAgaWYgKHRoaXMuaXNTdGFydChyb3csIGNvbHVtbikpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ2hlY2tzIHRoZSByb3cgYW5kIGNvbHVtbiBwb2ludHMgd2l0aCB0aGUgcm93IGFuZCBjb2x1bW4gcG9pbnRzIG9mIHRoZSBjYWxsaW5nIHJhbmdlLlxuICAgICAqXG4gICAgICogQG1ldGhvZCBjb21wYXJlXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IHJvdyBBIHJvdyBwb2ludCB0byBjb21wYXJlIHdpdGhcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gY29sdW1uIEEgY29sdW1uIHBvaW50IHRvIGNvbXBhcmUgd2l0aFxuICAgICAqXG4gICAgICpcbiAgICAgKiBAcmV0dXJuIHtOdW1iZXJ9IFRoaXMgbWV0aG9kIHJldHVybnMgb25lIG9mIHRoZSBmb2xsb3dpbmcgbnVtYmVyczo8YnIvPlxuICAgICAqIGAwYCBpZiB0aGUgdHdvIHBvaW50cyBhcmUgZXhhY3RseSBlcXVhbCA8YnIvPlxuICAgICAqIGAtMWAgaWYgYHAucm93YCBpcyBsZXNzIHRoZW4gdGhlIGNhbGxpbmcgcmFuZ2UgPGJyLz5cbiAgICAgKiBgMWAgaWYgYHAucm93YCBpcyBncmVhdGVyIHRoYW4gdGhlIGNhbGxpbmcgcmFuZ2UgPGJyLz5cbiAgICAgKiAgPGJyLz5cbiAgICAgKiBJZiB0aGUgc3RhcnRpbmcgcm93IG9mIHRoZSBjYWxsaW5nIHJhbmdlIGlzIGVxdWFsIHRvIGBwLnJvd2AsIGFuZDogPGJyLz5cbiAgICAgKiBgcC5jb2x1bW5gIGlzIGdyZWF0ZXIgdGhhbiBvciBlcXVhbCB0byB0aGUgY2FsbGluZyByYW5nZSdzIHN0YXJ0aW5nIGNvbHVtbiwgdGhpcyByZXR1cm5zIGAwYDxici8+XG4gICAgICogT3RoZXJ3aXNlLCBpdCByZXR1cm5zIC0xPGJyLz5cbiAgICAgKiA8YnIvPlxuICAgICAqIElmIHRoZSBlbmRpbmcgcm93IG9mIHRoZSBjYWxsaW5nIHJhbmdlIGlzIGVxdWFsIHRvIGBwLnJvd2AsIGFuZDogPGJyLz5cbiAgICAgKiBgcC5jb2x1bW5gIGlzIGxlc3MgdGhhbiBvciBlcXVhbCB0byB0aGUgY2FsbGluZyByYW5nZSdzIGVuZGluZyBjb2x1bW4sIHRoaXMgcmV0dXJucyBgMGAgPGJyLz5cbiAgICAgKiBPdGhlcndpc2UsIGl0IHJldHVybnMgMVxuICAgICAqKi9cbiAgICBjb21wYXJlKHJvdzogbnVtYmVyLCBjb2x1bW46IG51bWJlcik6IG51bWJlciB7XG4gICAgICAgIGlmICghdGhpcy5pc011bHRpTGluZSgpKSB7XG4gICAgICAgICAgICBpZiAocm93ID09PSB0aGlzLnN0YXJ0LnJvdykge1xuICAgICAgICAgICAgICAgIHJldHVybiBjb2x1bW4gPCB0aGlzLnN0YXJ0LmNvbHVtbiA/IC0xIDogKGNvbHVtbiA+IHRoaXMuZW5kLmNvbHVtbiA/IDEgOiAwKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChyb3cgPCB0aGlzLnN0YXJ0LnJvdylcbiAgICAgICAgICAgIHJldHVybiAtMTtcblxuICAgICAgICBpZiAocm93ID4gdGhpcy5lbmQucm93KVxuICAgICAgICAgICAgcmV0dXJuIDE7XG5cbiAgICAgICAgaWYgKHRoaXMuc3RhcnQucm93ID09PSByb3cpXG4gICAgICAgICAgICByZXR1cm4gY29sdW1uID49IHRoaXMuc3RhcnQuY29sdW1uID8gMCA6IC0xO1xuXG4gICAgICAgIGlmICh0aGlzLmVuZC5yb3cgPT09IHJvdylcbiAgICAgICAgICAgIHJldHVybiBjb2x1bW4gPD0gdGhpcy5lbmQuY29sdW1uID8gMCA6IDE7XG5cbiAgICAgICAgcmV0dXJuIDA7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ2hlY2tzIHRoZSByb3cgYW5kIGNvbHVtbiBwb2ludHMgd2l0aCB0aGUgcm93IGFuZCBjb2x1bW4gcG9pbnRzIG9mIHRoZSBjYWxsaW5nIHJhbmdlLlxuICAgICAqXG4gICAgICogQG1ldGhvZCBjb21wYXJlU3RhcnRcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gcm93IEEgcm93IHBvaW50IHRvIGNvbXBhcmUgd2l0aFxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBjb2x1bW4gQSBjb2x1bW4gcG9pbnQgdG8gY29tcGFyZSB3aXRoXG4gICAgICpcbiAgICAgKiBAcmV0dXJuIHtOdW1iZXJ9IFRoaXMgbWV0aG9kIHJldHVybnMgb25lIG9mIHRoZSBmb2xsb3dpbmcgbnVtYmVyczo8YnIvPlxuICAgICAqIDxici8+XG4gICAgICogYDBgIGlmIHRoZSB0d28gcG9pbnRzIGFyZSBleGFjdGx5IGVxdWFsPGJyLz5cbiAgICAgKiBgLTFgIGlmIGBwLnJvd2AgaXMgbGVzcyB0aGVuIHRoZSBjYWxsaW5nIHJhbmdlPGJyLz5cbiAgICAgKiBgMWAgaWYgYHAucm93YCBpcyBncmVhdGVyIHRoYW4gdGhlIGNhbGxpbmcgcmFuZ2UsIG9yIGlmIGBpc1N0YXJ0YCBpcyBgdHJ1ZWAuPGJyLz5cbiAgICAgKiA8YnIvPlxuICAgICAqIElmIHRoZSBzdGFydGluZyByb3cgb2YgdGhlIGNhbGxpbmcgcmFuZ2UgaXMgZXF1YWwgdG8gYHAucm93YCwgYW5kOjxici8+XG4gICAgICogYHAuY29sdW1uYCBpcyBncmVhdGVyIHRoYW4gb3IgZXF1YWwgdG8gdGhlIGNhbGxpbmcgcmFuZ2UncyBzdGFydGluZyBjb2x1bW4sIHRoaXMgcmV0dXJucyBgMGA8YnIvPlxuICAgICAqIE90aGVyd2lzZSwgaXQgcmV0dXJucyAtMTxici8+XG4gICAgICogPGJyLz5cbiAgICAgKiBJZiB0aGUgZW5kaW5nIHJvdyBvZiB0aGUgY2FsbGluZyByYW5nZSBpcyBlcXVhbCB0byBgcC5yb3dgLCBhbmQ6PGJyLz5cbiAgICAgKiBgcC5jb2x1bW5gIGlzIGxlc3MgdGhhbiBvciBlcXVhbCB0byB0aGUgY2FsbGluZyByYW5nZSdzIGVuZGluZyBjb2x1bW4sIHRoaXMgcmV0dXJucyBgMGA8YnIvPlxuICAgICAqIE90aGVyd2lzZSwgaXQgcmV0dXJucyAxXG4gICAgICpcbiAgICAgKiovXG4gICAgY29tcGFyZVN0YXJ0KHJvdzogbnVtYmVyLCBjb2x1bW46IG51bWJlcik6IG51bWJlciB7XG4gICAgICAgIGlmICh0aGlzLnN0YXJ0LnJvdyA9PT0gcm93ICYmIHRoaXMuc3RhcnQuY29sdW1uID09PSBjb2x1bW4pIHtcbiAgICAgICAgICAgIHJldHVybiAtMTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmNvbXBhcmUocm93LCBjb2x1bW4pO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ2hlY2tzIHRoZSByb3cgYW5kIGNvbHVtbiBwb2ludHMgd2l0aCB0aGUgcm93IGFuZCBjb2x1bW4gcG9pbnRzIG9mIHRoZSBjYWxsaW5nIHJhbmdlLlxuICAgICAqXG4gICAgICogQG1ldGhvZCBjb21wYXJlRW5kXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IHJvdyBBIHJvdyBwb2ludCB0byBjb21wYXJlIHdpdGhcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gY29sdW1uIEEgY29sdW1uIHBvaW50IHRvIGNvbXBhcmUgd2l0aFxuICAgICAqXG4gICAgICpcbiAgICAgKiBAcmV0dXJuIHtOdW1iZXJ9IFRoaXMgbWV0aG9kIHJldHVybnMgb25lIG9mIHRoZSBmb2xsb3dpbmcgbnVtYmVyczo8YnIvPlxuICAgICAqIGAwYCBpZiB0aGUgdHdvIHBvaW50cyBhcmUgZXhhY3RseSBlcXVhbDxici8+XG4gICAgICogYC0xYCBpZiBgcC5yb3dgIGlzIGxlc3MgdGhlbiB0aGUgY2FsbGluZyByYW5nZTxici8+XG4gICAgICogYDFgIGlmIGBwLnJvd2AgaXMgZ3JlYXRlciB0aGFuIHRoZSBjYWxsaW5nIHJhbmdlLCBvciBpZiBgaXNFbmRgIGlzIGB0cnVlLjxici8+XG4gICAgICogPGJyLz5cbiAgICAgKiBJZiB0aGUgc3RhcnRpbmcgcm93IG9mIHRoZSBjYWxsaW5nIHJhbmdlIGlzIGVxdWFsIHRvIGBwLnJvd2AsIGFuZDo8YnIvPlxuICAgICAqIGBwLmNvbHVtbmAgaXMgZ3JlYXRlciB0aGFuIG9yIGVxdWFsIHRvIHRoZSBjYWxsaW5nIHJhbmdlJ3Mgc3RhcnRpbmcgY29sdW1uLCB0aGlzIHJldHVybnMgYDBgPGJyLz5cbiAgICAgKiBPdGhlcndpc2UsIGl0IHJldHVybnMgLTE8YnIvPlxuICAgICAqPGJyLz5cbiAgICAgKiBJZiB0aGUgZW5kaW5nIHJvdyBvZiB0aGUgY2FsbGluZyByYW5nZSBpcyBlcXVhbCB0byBgcC5yb3dgLCBhbmQ6PGJyLz5cbiAgICAgKiBgcC5jb2x1bW5gIGlzIGxlc3MgdGhhbiBvciBlcXVhbCB0byB0aGUgY2FsbGluZyByYW5nZSdzIGVuZGluZyBjb2x1bW4sIHRoaXMgcmV0dXJucyBgMGA8YnIvPlxuICAgICAqIE90aGVyd2lzZSwgaXQgcmV0dXJucyAxXG4gICAgICovXG4gICAgY29tcGFyZUVuZChyb3c6IG51bWJlciwgY29sdW1uOiBudW1iZXIpOiBudW1iZXIge1xuICAgICAgICBpZiAodGhpcy5lbmQucm93ID09PSByb3cgJiYgdGhpcy5lbmQuY29sdW1uID09PSBjb2x1bW4pIHtcbiAgICAgICAgICAgIHJldHVybiAxO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuY29tcGFyZShyb3csIGNvbHVtbik7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDaGVja3MgdGhlIHJvdyBhbmQgY29sdW1uIHBvaW50cyB3aXRoIHRoZSByb3cgYW5kIGNvbHVtbiBwb2ludHMgb2YgdGhlIGNhbGxpbmcgcmFuZ2UuXG4gICAgICpcbiAgICAgKiBAbWV0aG9kIGNvbXBhcmVJbnNpZGVcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gcm93IEEgcm93IHBvaW50IHRvIGNvbXBhcmUgd2l0aFxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBjb2x1bW4gQSBjb2x1bW4gcG9pbnQgdG8gY29tcGFyZSB3aXRoXG4gICAgICpcbiAgICAgKlxuICAgICAqIEByZXR1cm4ge051bWJlcn0gVGhpcyBtZXRob2QgcmV0dXJucyBvbmUgb2YgdGhlIGZvbGxvd2luZyBudW1iZXJzOjxici8+XG4gICAgICogKiBgMWAgaWYgdGhlIGVuZGluZyByb3cgb2YgdGhlIGNhbGxpbmcgcmFuZ2UgaXMgZXF1YWwgdG8gYHJvd2AsIGFuZCB0aGUgZW5kaW5nIGNvbHVtbiBvZiB0aGUgY2FsbGluZyByYW5nZSBpcyBlcXVhbCB0byBgY29sdW1uYDxici8+XG4gICAgICogKiBgLTFgIGlmIHRoZSBzdGFydGluZyByb3cgb2YgdGhlIGNhbGxpbmcgcmFuZ2UgaXMgZXF1YWwgdG8gYHJvd2AsIGFuZCB0aGUgc3RhcnRpbmcgY29sdW1uIG9mIHRoZSBjYWxsaW5nIHJhbmdlIGlzIGVxdWFsIHRvIGBjb2x1bW5gPGJyLz5cbiAgICAgKiA8YnIvPlxuICAgICAqIE90aGVyd2lzZSwgaXQgcmV0dXJucyB0aGUgdmFsdWUgYWZ0ZXIgY2FsbGluZyBbW0VkaXRvclJhbmdlLmNvbXBhcmUgYGNvbXBhcmUoKWBdXS5cbiAgICAgKlxuICAgICAqKi9cbiAgICBjb21wYXJlSW5zaWRlKHJvdzogbnVtYmVyLCBjb2x1bW46IG51bWJlcik6IG51bWJlciB7XG4gICAgICAgIGlmICh0aGlzLmVuZC5yb3cgPT09IHJvdyAmJiB0aGlzLmVuZC5jb2x1bW4gPT09IGNvbHVtbikge1xuICAgICAgICAgICAgcmV0dXJuIDE7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAodGhpcy5zdGFydC5yb3cgPT09IHJvdyAmJiB0aGlzLnN0YXJ0LmNvbHVtbiA9PT0gY29sdW1uKSB7XG4gICAgICAgICAgICByZXR1cm4gLTE7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5jb21wYXJlKHJvdywgY29sdW1uKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFJldHVybnMgdGhlIHBhcnQgb2YgdGhlIGN1cnJlbnQgYEVkaXRvclJhbmdlYCB0aGF0IG9jY3VycyB3aXRoaW4gdGhlIGJvdW5kYXJpZXMgb2YgYGZpcnN0Um93YCBhbmQgYGxhc3RSb3dgIGFzIGEgbmV3IGBFZGl0b3JSYW5nZWAgb2JqZWN0LlxuICAgICAqXG4gICAgICogQG1ldGhvZCBjbGlwUm93c1xuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBmaXJzdFJvdyBUaGUgc3RhcnRpbmcgcm93XG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IGxhc3RSb3cgVGhlIGVuZGluZyByb3dcbiAgICAgKiBAcmV0dXJuIHtSYW5nZX1cbiAgICAqKi9cbiAgICBjbGlwUm93cyhmaXJzdFJvdzogbnVtYmVyLCBsYXN0Um93OiBudW1iZXIpOiBSYW5nZSB7XG4gICAgICAgIHZhciBzdGFydDogeyByb3c6IG51bWJlcjsgY29sdW1uOiBudW1iZXIgfTtcbiAgICAgICAgdmFyIGVuZDogeyByb3c6IG51bWJlcjsgY29sdW1uOiBudW1iZXIgfTtcbiAgICAgICAgaWYgKHRoaXMuZW5kLnJvdyA+IGxhc3RSb3cpXG4gICAgICAgICAgICBlbmQgPSB7IHJvdzogbGFzdFJvdyArIDEsIGNvbHVtbjogMCB9O1xuICAgICAgICBlbHNlIGlmICh0aGlzLmVuZC5yb3cgPCBmaXJzdFJvdylcbiAgICAgICAgICAgIGVuZCA9IHsgcm93OiBmaXJzdFJvdywgY29sdW1uOiAwIH07XG5cbiAgICAgICAgaWYgKHRoaXMuc3RhcnQucm93ID4gbGFzdFJvdylcbiAgICAgICAgICAgIHN0YXJ0ID0geyByb3c6IGxhc3RSb3cgKyAxLCBjb2x1bW46IDAgfTtcbiAgICAgICAgZWxzZSBpZiAodGhpcy5zdGFydC5yb3cgPCBmaXJzdFJvdylcbiAgICAgICAgICAgIHN0YXJ0ID0geyByb3c6IGZpcnN0Um93LCBjb2x1bW46IDAgfTtcblxuICAgICAgICByZXR1cm4gUmFuZ2UuZnJvbVBvaW50cyhzdGFydCB8fCB0aGlzLnN0YXJ0LCBlbmQgfHwgdGhpcy5lbmQpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENoYW5nZXMgdGhlIHJvdyBhbmQgY29sdW1uIHBvaW50cyBmb3IgdGhlIGNhbGxpbmcgcmFuZ2UgZm9yIGJvdGggdGhlIHN0YXJ0aW5nIGFuZCBlbmRpbmcgcG9pbnRzLlxuICAgICAqXG4gICAgICogQG1ldGhvZCBleHRlbmRcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gcm93IEEgbmV3IHJvdyB0byBleHRlbmQgdG9cbiAgICAgKiBAcGFyYW0ge051bWJlcn0gY29sdW1uIEEgbmV3IGNvbHVtbiB0byBleHRlbmQgdG9cbiAgICAgKiBAcmV0dXJuIHtSYW5nZX0gVGhlIG9yaWdpbmFsIHJhbmdlIHdpdGggdGhlIG5ldyByb3dcbiAgICAqKi9cbiAgICBleHRlbmQocm93OiBudW1iZXIsIGNvbHVtbjogbnVtYmVyKTogUmFuZ2Uge1xuICAgICAgICB2YXIgY21wID0gdGhpcy5jb21wYXJlKHJvdywgY29sdW1uKTtcblxuICAgICAgICBpZiAoY21wID09PSAwKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChjbXAgPT09IC0xKSB7XG4gICAgICAgICAgICB2YXIgc3RhcnQgPSB7IHJvdzogcm93LCBjb2x1bW46IGNvbHVtbiB9O1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdmFyIGVuZCA9IHsgcm93OiByb3csIGNvbHVtbjogY29sdW1uIH07XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIFJhbmdlLmZyb21Qb2ludHMoc3RhcnQgfHwgdGhpcy5zdGFydCwgZW5kIHx8IHRoaXMuZW5kKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBAbWV0aG9kIGlzRW1wdHlcbiAgICAgKiBAcmV0dXJuIHtib29sZWFufVxuICAgICAqL1xuICAgIGlzRW1wdHkoKTogYm9vbGVhbiB7XG4gICAgICAgIHJldHVybiAodGhpcy5zdGFydC5yb3cgPT09IHRoaXMuZW5kLnJvdyAmJiB0aGlzLnN0YXJ0LmNvbHVtbiA9PT0gdGhpcy5lbmQuY29sdW1uKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIGB0cnVlYCBpZiB0aGUgcmFuZ2Ugc3BhbnMgYWNyb3NzIG11bHRpcGxlIGxpbmVzLlxuICAgICAqXG4gICAgICogQG1ldGhvZCBpc011bHRpTGluZVxuICAgICAqIEByZXR1cm4ge0Jvb2xlYW59XG4gICAgICovXG4gICAgaXNNdWx0aUxpbmUoKTogYm9vbGVhbiB7XG4gICAgICAgIHJldHVybiAodGhpcy5zdGFydC5yb3cgIT09IHRoaXMuZW5kLnJvdyk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogUmV0dXJucyBhIGR1cGxpY2F0ZSBvZiB0aGUgY2FsbGluZyByYW5nZS5cbiAgICAgKlxuICAgICAqIEBtZXRob2QgY2xvbmVcbiAgICAgKiBAcmV0dXJuIHtSYW5nZX1cbiAgICAgKi9cbiAgICBjbG9uZSgpIHtcbiAgICAgICAgcmV0dXJuIFJhbmdlLmZyb21Qb2ludHModGhpcy5zdGFydCwgdGhpcy5lbmQpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFJldHVybnMgYSByYW5nZSBjb250YWluaW5nIHRoZSBzdGFydGluZyBhbmQgZW5kaW5nIHJvd3Mgb2YgdGhlIG9yaWdpbmFsIHJhbmdlLCBidXQgd2l0aCBhIGNvbHVtbiB2YWx1ZSBvZiBgMGAuXG4gICAgICpcbiAgICAgKiBAbWV0aG9kIGNvbGxhcHNlUm93c1xuICAgICAqIEByZXR1cm4ge1JhbmdlfVxuICAgICAqL1xuICAgIGNvbGxhcHNlUm93cygpOiBSYW5nZSB7XG4gICAgICAgIGlmICh0aGlzLmVuZC5jb2x1bW4gPT09IDApXG4gICAgICAgICAgICByZXR1cm4gbmV3IFJhbmdlKHRoaXMuc3RhcnQucm93LCAwLCBNYXRoLm1heCh0aGlzLnN0YXJ0LnJvdywgdGhpcy5lbmQucm93IC0gMSksIDApXG4gICAgICAgIGVsc2VcbiAgICAgICAgICAgIHJldHVybiBuZXcgUmFuZ2UodGhpcy5zdGFydC5yb3csIDAsIHRoaXMuZW5kLnJvdywgMClcbiAgICB9XG5cbiAgICAvKiBleHBlcmltZW50YWwgKi9cbiAgICBtb3ZlQnkocm93OiBudW1iZXIsIGNvbHVtbjogbnVtYmVyKTogdm9pZCB7XG4gICAgICAgIHRoaXMuc3RhcnQucm93ICs9IHJvdztcbiAgICAgICAgdGhpcy5zdGFydC5jb2x1bW4gKz0gY29sdW1uO1xuICAgICAgICB0aGlzLmVuZC5yb3cgKz0gcm93O1xuICAgICAgICB0aGlzLmVuZC5jb2x1bW4gKz0gY29sdW1uO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENyZWF0ZXMgYW5kIHJldHVybnMgYSBuZXcgYEVkaXRvclJhbmdlYCBiYXNlZCBvbiB0aGUgcm93IGFuZCBjb2x1bW4gb2YgdGhlIGdpdmVuIHBhcmFtZXRlcnMuXG4gICAgICogQHBhcmFtIHN0YXJ0IHtQb3NpdGlvbn0gQSBzdGFydGluZyBwb2ludCB0byB1c2VcbiAgICAgKiBAcGFyYW0gZW5kIHtQb3NpdGlvbn0gQW4gZW5kaW5nIHBvaW50IHRvIHVzZVxuICAgICAqIEByZXR1cm4ge1JhbmdlfVxuICAgICAqIEBzdGF0aWNcbiAgICAgKi9cbiAgICBwdWJsaWMgc3RhdGljIGZyb21Qb2ludHMoc3RhcnQ6IFBvc2l0aW9uLCBlbmQ6IFBvc2l0aW9uKTogUmFuZ2Uge1xuICAgICAgICByZXR1cm4gbmV3IFJhbmdlKHN0YXJ0LnJvdywgc3RhcnQuY29sdW1uLCBlbmQucm93LCBlbmQuY29sdW1uKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBAbWV0aG9kIGNvbXBhcmVQb2ludHNcbiAgICAgKiBAcGFyYW0gcDEge1Bvc2l0aW9ufVxuICAgICAqIEBwYXJhbSBwMiB7UG9zaXRpb259XG4gICAgICogQHJldHVybiB7bnVtYmVyfVxuICAgICAqIEBzdGF0aWNcbiAgICAgKi9cbiAgICBwdWJsaWMgc3RhdGljIGNvbXBhcmVQb2ludHMocDE6IFBvc2l0aW9uLCBwMjogUG9zaXRpb24pOiBudW1iZXIge1xuICAgICAgICByZXR1cm4gcDEucm93IC0gcDIucm93IHx8IHAxLmNvbHVtbiAtIHAyLmNvbHVtbjtcbiAgICB9XG59XG4iXX0=