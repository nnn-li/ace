"use strict";
import { ContinuousRecognizer } from './attribute';
import { DIRECTION_ALL, DIRECTION_DOWN, DIRECTION_HORIZONTAL, DIRECTION_LEFT, DIRECTION_RIGHT, DIRECTION_UNDEFINED, DIRECTION_UP, DIRECTION_VERTICAL, STATE_BEGAN, TOUCH_ACTION_PAN_X, TOUCH_ACTION_PAN_Y } from '../hammer';
export class PanRecognizer extends ContinuousRecognizer {
    constructor(eventName, enabled) {
        super(eventName, enabled, 1);
        this.direction = DIRECTION_ALL;
        this.threshold = 10;
    }
    setDirection(direction) {
        this.direction = direction;
        return this;
    }
    setThreshold(threshold) {
        this.threshold = threshold;
        return this;
    }
    getTouchAction() {
        var actions = [];
        if (this.direction & DIRECTION_HORIZONTAL) {
            actions.push(TOUCH_ACTION_PAN_Y);
        }
        if (this.direction & DIRECTION_VERTICAL) {
            actions.push(TOUCH_ACTION_PAN_X);
        }
        return actions;
    }
    directionTest(input) {
        var hasMoved = true;
        var distance = input.distance;
        var direction = input.direction;
        var x = input.movement.x;
        var y = input.movement.y;
        if (!(direction & this.direction)) {
            if (this.direction & DIRECTION_HORIZONTAL) {
                direction = (x === 0) ? DIRECTION_UNDEFINED : (x < 0) ? DIRECTION_LEFT : DIRECTION_RIGHT;
                hasMoved = x != this.pX;
                distance = Math.abs(input.movement.x);
            }
            else {
                direction = (y === 0) ? DIRECTION_UNDEFINED : (y < 0) ? DIRECTION_UP : DIRECTION_DOWN;
                hasMoved = y != this.pY;
                distance = Math.abs(input.movement.y);
            }
        }
        var directionAllowed = (direction & this.direction) > 0;
        return hasMoved && distance > this.threshold && directionAllowed;
    }
    attributeTest(input) {
        this.movement = input.movement;
        if (input.movement) {
            var directionOK = this.directionTest(input);
            var began = (this.state & STATE_BEGAN) > 0;
            return super.attributeTest(input) && (began || (!began && directionOK));
        }
        else {
            return true;
        }
    }
    emit() {
        if (this.movement) {
            this.manager.emit(this.eventName, this.movement);
        }
    }
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicGFuLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsicGFuLnRzIl0sIm5hbWVzIjpbIlBhblJlY29nbml6ZXIiLCJQYW5SZWNvZ25pemVyLmNvbnN0cnVjdG9yIiwiUGFuUmVjb2duaXplci5zZXREaXJlY3Rpb24iLCJQYW5SZWNvZ25pemVyLnNldFRocmVzaG9sZCIsIlBhblJlY29nbml6ZXIuZ2V0VG91Y2hBY3Rpb24iLCJQYW5SZWNvZ25pemVyLmRpcmVjdGlvblRlc3QiLCJQYW5SZWNvZ25pemVyLmF0dHJpYnV0ZVRlc3QiLCJQYW5SZWNvZ25pemVyLmVtaXQiXSwibWFwcGluZ3MiOiJBQUFBLFlBQVksQ0FBQztPQUVOLEVBQUUsb0JBQW9CLEVBQUUsTUFBTSxhQUFhO09BQzNDLEVBQ1AsYUFBYSxFQUNiLGNBQWMsRUFDZCxvQkFBb0IsRUFDcEIsY0FBYyxFQUNkLGVBQWUsRUFDZixtQkFBbUIsRUFDbkIsWUFBWSxFQUNaLGtCQUFrQixFQUVsQixXQUFXLEVBQ1gsa0JBQWtCLEVBQ2xCLGtCQUFrQixFQUVqQixNQUFNLFdBQVc7QUFLbEIsbUNBQW1DLG9CQUFvQjtJQU1uREEsWUFBWUEsU0FBaUJBLEVBQUVBLE9BQWdCQTtRQUMzQ0MsTUFBTUEsU0FBU0EsRUFBRUEsT0FBT0EsRUFBRUEsQ0FBQ0EsQ0FBQ0EsQ0FBQ0E7UUFKekJBLGNBQVNBLEdBQVdBLGFBQWFBLENBQUNBO1FBQ2xDQSxjQUFTQSxHQUFHQSxFQUFFQSxDQUFDQTtJQUl2QkEsQ0FBQ0E7SUFDREQsWUFBWUEsQ0FBQ0EsU0FBaUJBO1FBQzFCRSxJQUFJQSxDQUFDQSxTQUFTQSxHQUFHQSxTQUFTQSxDQUFDQTtRQUMzQkEsTUFBTUEsQ0FBQ0EsSUFBSUEsQ0FBQ0E7SUFDaEJBLENBQUNBO0lBQ0RGLFlBQVlBLENBQUNBLFNBQWlCQTtRQUMxQkcsSUFBSUEsQ0FBQ0EsU0FBU0EsR0FBR0EsU0FBU0EsQ0FBQ0E7UUFDM0JBLE1BQU1BLENBQUNBLElBQUlBLENBQUNBO0lBQ2hCQSxDQUFD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QUFDQSxDQUFDQTtZQUNyREEsSUFBSUEsS0FBS0EsR0FBWUEsQ0FBQ0EsSUFBSUEsQ0FBQ0EsS0FBS0EsR0FBR0EsV0FBV0EsQ0FBQ0EsR0FBR0EsQ0FBQ0EsQ0FBQ0E7WUFDcERBLE1BQU1BLENBQUNBLEtBQUtBLENBQUNBLGFBQWFBLENBQUNBLEtBQUtBLENBQUNBLElBQUlBLENBQUNBLEtBQUtBLElBQUlBLENBQUNBLENBQUNBLEtBQUtBLElBQUlBLFdBQVdBLENBQUNBLENBQUNBLENBQUNBO1FBQzVFQSxDQUFDQTtRQUNEQSxJQUFJQSxDQUFDQSxDQUFDQTtZQUNGQSxNQUFNQSxDQUFDQSxJQUFJQSxDQUFDQTtRQUNoQkEsQ0FBQ0E7SUFDTEEsQ0FBQ0E7SUFFRE4sSUFBSUE7UUFDQU8sRUFBRUEsQ0FBQ0EsQ0FBQ0EsSUFBSUEsQ0FBQ0EsUUFBUUEsQ0FBQ0EsQ0FBQ0EsQ0FBQ0E7WUFDaEJBLElBQUlBLENBQUNBLE9BQU9BLENBQUNBLElBQUlBLENBQUNBLElBQUlBLENBQUNBLFNBQVNBLEVBQUVBLElBQUlBLENBQUNBLFFBQVFBLENBQUNBLENBQUNBO1FBQ3JEQSxDQUFDQTtJQUNMQSxDQUFDQTtBQUNMUCxDQUFDQTtBQUFBIiwic291cmNlc0NvbnRlbnQiOlsiXCJ1c2Ugc3RyaWN0XCI7XG5cbmltcG9ydCB7IENvbnRpbnVvdXNSZWNvZ25pemVyIH0gZnJvbSAnLi9hdHRyaWJ1dGUnO1xuaW1wb3J0IHtcbkRJUkVDVElPTl9BTEwsXG5ESVJFQ1RJT05fRE9XTixcbkRJUkVDVElPTl9IT1JJWk9OVEFMLFxuRElSRUNUSU9OX0xFRlQsXG5ESVJFQ1RJT05fUklHSFQsXG5ESVJFQ1RJT05fVU5ERUZJTkVELFxuRElSRUNUSU9OX1VQLFxuRElSRUNUSU9OX1ZFUlRJQ0FMLFxuSUNvbXB1dGVkRXZlbnQsXG5TVEFURV9CRUdBTixcblRPVUNIX0FDVElPTl9QQU5fWCxcblRPVUNIX0FDVElPTl9QQU5fWSxcblZlY3RvckUyXG59IGZyb20gJy4uL2hhbW1lcic7XG5cbi8qKlxuICpcbiAqL1xuZXhwb3J0IGNsYXNzIFBhblJlY29nbml6ZXIgZXh0ZW5kcyBDb250aW51b3VzUmVjb2duaXplciB7XG4gICAgcHJpdmF0ZSBwWDogbnVtYmVyO1xuICAgIHByaXZhdGUgcFk6IG51bWJlcjtcbiAgICBwcml2YXRlIGRpcmVjdGlvbjogbnVtYmVyID0gRElSRUNUSU9OX0FMTDtcbiAgICBwcml2YXRlIHRocmVzaG9sZCA9IDEwO1xuICAgIHByaXZhdGUgbW92ZW1lbnQ6IFZlY3RvckUyO1xuICAgIGNvbnN0cnVjdG9yKGV2ZW50TmFtZTogc3RyaW5nLCBlbmFibGVkOiBib29sZWFuKSB7XG4gICAgICAgIHN1cGVyKGV2ZW50TmFtZSwgZW5hYmxlZCwgMSk7XG4gICAgfVxuICAgIHNldERpcmVjdGlvbihkaXJlY3Rpb246IG51bWJlcik6IFBhblJlY29nbml6ZXIge1xuICAgICAgICB0aGlzLmRpcmVjdGlvbiA9IGRpcmVjdGlvbjtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuICAgIHNldFRocmVzaG9sZCh0aHJlc2hvbGQ6IG51bWJlcik6IFBhblJlY29nbml6ZXIge1xuICAgICAgICB0aGlzLnRocmVzaG9sZCA9IHRocmVzaG9sZDtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuICAgIGdldFRvdWNoQWN0aW9uKCk6IHN0cmluZ1tdIHtcbiAgICAgICAgdmFyIGFjdGlvbnM6IHN0cmluZ1tdID0gW107XG4gICAgICAgIGlmICh0aGlzLmRpcmVjdGlvbiAmIERJUkVDVElPTl9IT1JJWk9OVEFMKSB7XG4gICAgICAgICAgICBhY3Rpb25zLnB1c2goVE9VQ0hfQUNUSU9OX1BBTl9ZKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5kaXJlY3Rpb24gJiBESVJFQ1RJT05fVkVSVElDQUwpIHtcbiAgICAgICAgICAgIGFjdGlvbnMucHVzaChUT1VDSF9BQ1RJT05fUEFOX1gpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBhY3Rpb25zO1xuICAgIH1cblxuICAgIGRpcmVjdGlvblRlc3QoaW5wdXQ6IElDb21wdXRlZEV2ZW50KTogYm9vbGVhbiB7XG4gICAgICAgIHZhciBoYXNNb3ZlZCA9IHRydWU7XG4gICAgICAgIHZhciBkaXN0YW5jZSA9IGlucHV0LmRpc3RhbmNlO1xuICAgICAgICB2YXIgZGlyZWN0aW9uID0gaW5wdXQuZGlyZWN0aW9uO1xuICAgICAgICB2YXIgeCA9IGlucHV0Lm1vdmVtZW50Lng7XG4gICAgICAgIHZhciB5ID0gaW5wdXQubW92ZW1lbnQueTtcblxuICAgICAgICAvLyBsb2NrIHRvIGF4aXM/XG4gICAgICAgIGlmICghKGRpcmVjdGlvbiAmIHRoaXMuZGlyZWN0aW9uKSkge1xuICAgICAgICAgICAgaWYgKHRoaXMuZGlyZWN0aW9uICYgRElSRUNUSU9OX0hPUklaT05UQUwpIHtcbiAgICAgICAgICAgICAgICBkaXJlY3Rpb24gPSAoeCA9PT0gMCkgPyBESVJFQ1RJT05fVU5ERUZJTkVEIDogKHggPCAwKSA/IERJUkVDVElPTl9MRUZUIDogRElSRUNUSU9OX1JJR0hUO1xuICAgICAgICAgICAgICAgIGhhc01vdmVkID0geCAhPSB0aGlzLnBYO1xuICAgICAgICAgICAgICAgIGRpc3RhbmNlID0gTWF0aC5hYnMoaW5wdXQubW92ZW1lbnQueCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBkaXJlY3Rpb24gPSAoeSA9PT0gMCkgPyBESVJFQ1RJT05fVU5ERUZJTkVEIDogKHkgPCAwKSA/IERJUkVDVElPTl9VUCA6IERJUkVDVElPTl9ET1dOO1xuICAgICAgICAgICAgICAgIGhhc01vdmVkID0geSAhPSB0aGlzLnBZO1xuICAgICAgICAgICAgICAgIGRpc3RhbmNlID0gTWF0aC5hYnMoaW5wdXQubW92ZW1lbnQueSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGRpcmVjdGlvbkFsbG93ZWQ6IGJvb2xlYW4gPSAoZGlyZWN0aW9uICYgdGhpcy5kaXJlY3Rpb24pID4gMDtcbiAgICAgICAgcmV0dXJuIGhhc01vdmVkICYmIGRpc3RhbmNlID4gdGhpcy50aHJlc2hvbGQgJiYgZGlyZWN0aW9uQWxsb3dlZDtcbiAgICB9XG5cbiAgICBhdHRyaWJ1dGVUZXN0KGlucHV0OiBJQ29tcHV0ZWRFdmVudCk6IGJvb2xlYW4ge1xuICAgICAgICB0aGlzLm1vdmVtZW50ID0gaW5wdXQubW92ZW1lbnQ7XG4gICAgICAgIC8vIFRoZSBmaXJzdCBhbmQgbGFzdCBldmVudHMgd2lsbCBub3QgaGF2ZSBtb3ZlbWVudCBkZWZpbmVkLlxuICAgICAgICAvLyBUaGUgZGlyZWN0aW9uIHRlc3QgcmVxdWlyZXMgbW92ZW1lbnQhXG4gICAgICAgIGlmIChpbnB1dC5tb3ZlbWVudCkge1xuICAgICAgICAgICAgdmFyIGRpcmVjdGlvbk9LOiBib29sZWFuID0gdGhpcy5kaXJlY3Rpb25UZXN0KGlucHV0KTtcbiAgICAgICAgICAgIHZhciBiZWdhbjogYm9vbGVhbiA9ICh0aGlzLnN0YXRlICYgU1RBVEVfQkVHQU4pID4gMDtcbiAgICAgICAgICAgIHJldHVybiBzdXBlci5hdHRyaWJ1dGVUZXN0KGlucHV0KSAmJiAoYmVnYW4gfHwgKCFiZWdhbiAmJiBkaXJlY3Rpb25PSykpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBlbWl0KCk6IHZvaWQge1xuICAgICAgICBpZiAodGhpcy5tb3ZlbWVudCkge1xuICAgICAgICAgICAgdGhpcy5tYW5hZ2VyLmVtaXQodGhpcy5ldmVudE5hbWUsIHRoaXMubW92ZW1lbnQpO1xuICAgICAgICB9XG4gICAgfVxufVxuIl19